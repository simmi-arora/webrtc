"";var rtcConn,containerDiv,tempuserid,detectRTC,webrtcdevIceServers,localStream,localStreamId,remoteStream,remoteStreamId,screen,extensioninstalled,screen_roomid,screen_userid,t="",e=null,n="",selfuserid=null,remoteUserId=null,webcallpeers=[],sessions={},repeatFlagShowButton=null,repeatFlagHideButton=null,repeatFlagRemoveButton=null,localVideo=null,selfVideo=null,remoteVideos=[],RTCPeerConnection=null,webrtcDetectedBrowser=null,webrtcDetectedVersion=null,selfusername=(sessions={},""),selfemail="",selfcolor="",remoteusername="",remoteemail="",remotecolor="",latitude="",longitude="",operatingsystem="",autoload=!0,sessionid=null,socketAddr="/",incomingAudio=!0,incomingVideo=!0,incomingData=!0,outgoingAudio=!0,outgoingVideo=!0,outgoingData=!0,debug=!1,timerobj=!1,chatobj=!1,chatContainer=null,fileshareobj=!1,screenrecordobj=!1,snapshotobj=!1,videoRecordobj=!1,videoRecordContainer=null,drawCanvasobj=!1,texteditorobj=!1,codeeditorobj=!1,editor=null,reconnectobj=!1,cursorobj=!1,muteobj=!1,minmaxobj=!1,listeninobj=!1,screenshareobj=!1,helpobj=!1,statisticsobj=!1,isScreenOn=0,chromeMediaSourceId=null,role="participant";function init(e,t){e&&!location.hash.replace("#","").length?(location.href=location.href.split("#")[0]+"#"+(100*Math.random()).toString().replace(".",""),location.reload()):e&&location.href.replace("#","").length?t(sessionid=-1<location.href.indexOf("?")?location.hash.substring(0,location.hash.indexOf("?")).replace(/\/|:|#|\?|\$|\^|%|\.|`|~|!|\+|@|\[|\||]|\|*. /g,"").split("\n").join("").split("\r").join(""):location.hash.replace(/\/|:|#|\?|\$|\^|%|\.|`|~|!|\+|@|\[|\||]|\|*. /g,"").split("\n").join("").split("\r").join("")):t(sessionid=prompt("Enter session ",""))}function loadjscssfile(e,t){if("js"==t)(r=document.createElement("script")).setAttribute("type","text/javascript"),r.setAttribute("src",e);else if("css"==t){var r;(r=document.createElement("link")).setAttribute("rel","stylesheet"),r.setAttribute("type","text/css"),r.setAttribute("href",e)}void 0!==r&&document.getElementsByTagName("head")[0].appendChild(r)}function loadScript(e,t){var r=document.createElement("script");r.src=e,r.async=!0,document.documentElement.appendChild(r)}function isData(e){return!e.audio&&!e.video&&!e.screen&&e.data}function isNull(e){return void 0===e}function isString(e){return"string"==typeof e}function isEmpty(e){var t=0;for(var r in e)t++;return 0==t}function ab2str(e){var t="";try{t=String.fromCharCode.apply(null,new Uint16Array(e))}catch(e){}return t}function str2ab(e){isString(e)||(e=JSON.stringify(e));for(var t=new ArrayBuffer(2*e.length),r=new Uint16Array(t),n=0,o=e.length;n<o;n++)r[n]=e.charCodeAt(n);return t}function toStr(t){try{return JSON.stringify(t,function(e,t){return t&&t.sdp?(log(t.sdp.type,"\t",t.sdp.sdp),""):t},"\t")}catch(e){return t}}function getLength(e){var t=0;for(var r in e)r&&t++;return t}function getArgsJson(e){var t="";for(i=0;i<e.length;i++)e[i]&&(t+=toStr(e[i]));return t}function isJSON(e){if("string"!=typeof e)return!1;try{return JSON.parse(e),!0}catch(e){return!1}}function getElement(e){return document.querySelector(e)}function getRandomColor(){for(var e="0123456789ABCDEF".split(""),t="#",r=0;r<6;r++)t+=e[Math.round(15*Math.random())];return t}function guid(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}function getUserinfo(e,t){return e?'<video src="'+e+'" autoplay></vide>':'<img src="'+t+'">'}function fireClickEvent(e){var t=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});e.dispatchEvent(t)}function bytesToSize(e){if(0==e)return"0 Bytes";var t=parseInt(Math.floor(Math.log(e)/Math.log(1024)));return Math.round(e/Math.pow(1024,t),2)+" "+["Bytes","KB","MB","GB","TB"][t]}var webrtcdev={},webrtcdevlogs=[];webrtcdev.log=function(){if(isJSON(arguments)){var e=JSON.stringify(arguments,void 0,2);webrtcdevlogs.push("<pre style='color:grey'>[-]"+e+"</pre>")}else{var t=getArgsJson(arguments);webrtcdevlogs.push("<p style='color:grey'>[-]"+t+"</p>")}console.log(arguments)},webrtcdev.info=function(){var e=getArgsJson(arguments);webrtcdevlogs.push("<p style='color:blue'>[INFO]"+e+"</p>"),console.info(arguments)},webrtcdev.debug=function(){if(isJSON(arguments)){var e=JSON.stringify(arguments,void 0,2);webrtcdevlogs.push("<pre style='color:green'>[DEBUG]"+e+"</pre>")}else{var t=getArgsJson(arguments);webrtcdevlogs.push("<p style='color:green'>[DEBUG]"+t+"</p>")}console.debug(arguments)},webrtcdev.warn=function(){var e=getArgsJson(arguments);webrtcdevlogs.push("<p style='color:yellow'>[WARN]"+e+"</p>"),console.warn(arguments)},webrtcdev.error=function(){var e=getArgsJson(arguments);webrtcdevlogs.push("<p style='color:red'>[ERROR]"+e+"</p>"),console.error(arguments)};
"";function shownotification(e,t){if(document.getElementById("alertBox")){var i=document.createElement("div");i.className="warning"==t?"alert alert-warning fade in":"crtical"==t?"alert alert-crtical":"alert alert-success fade in",i.innerHTML='<a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>'+e,document.getElementById("alertBox").hidden=!1,document.getElementById("alertBox").appendChild(i),setTimeout(function(){document.getElementById("alertBox").hidden=!0},3e3)}else alert(e)}function shownotificationWarning(e){if(document.getElementById("alertBox")){var t=document.createElement("div");t.className="alert alert-warning fade in",t.innerHTML='<a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>'+e,document.getElementById("alertBox").hidden=!1,document.getElementById("alertBox").innerHTML="",document.getElementById("alertBox").appendChild(t),setTimeout(function(){document.getElementById("alertBox").hidden=!0},3e3)}else alert(e)}function showdesktopnotification(){if("Notification"in window)if("granted"===Notification.permission)new Notification("Vilageexperts",{body:"The remote has joined the session"});else"denied"!==Notification.permission&&Notification.requestPermission(function(e){if("granted"===e)new Notification("villageexpsrts")});else alert("This browser does not support desktop notification")}function spawnNotification(e,t,i){new Notification(i,{body:e,icon:t})}Notification.requestPermission().then(function(e){webrtcdev.log(e)});
"";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function d(r,e){var n="";n+="?userid="+r.userid,n+="&msgEvent="+r.socketMessageEvent,n+="&socketCustomEvent="+r.socketCustomEvent,r.enableScalableBroadcast&&(n+="&enableScalableBroadcast=true",n+="&maxRelayLimitPerUser="+(r.maxRelayLimitPerUser||2)),r.socketCustomParameters&&(n+=r.socketCustomParameters);try{io.sockets={}}catch(e){}try{r.socket=io((r.socketURL||"/")+n)}catch(e){r.socket=io.connect((r.socketURL||"/")+n,r.socketOptions)}var a=r.multiPeersHandler;r.socket.on("extra-data-updated",function(e,n){r.peers[e]&&(r.peers[e].extra=n,r.onExtraDataUpdated({userid:e,extra:n}))}),r.socket.on(r.socketMessageEvent,function(e){if(e.remoteUserId==r.userid){if(r.peers[e.sender]&&r.peers[e.sender].extra!=e.message.extra&&(r.peers[e.sender].extra=e.extra,r.onExtraDataUpdated({userid:e.sender,extra:e.extra})),e.message.streamSyncNeeded&&r.peers[e.sender]){var n=r.streamEvents[e.message.streamid];if(!n||!n.stream)return;var t=e.message.action;if("ended"===t||"stream-removed"===t)return void r.onstreamended(n);var i="both"!=e.message.type?e.message.type:null;return void n.stream[t](i)}if("connectWithAllParticipants"===e.message)return-1===r.broadcasters.indexOf(e.sender)&&r.broadcasters.push(e.sender),void a.onNegotiationNeeded({allParticipants:r.getAllParticipants(e.sender)},e.sender);if("removeFromBroadcastersList"===e.message)return void(-1!==r.broadcasters.indexOf(e.sender)&&(delete r.broadcasters[r.broadcasters.indexOf(e.sender)],r.broadcasters=s(r.broadcasters)));if("dropPeerConnection"===e.message)return void r.deletePeer(e.sender);if(e.message.allParticipants)return-1===e.message.allParticipants.indexOf(e.sender)&&e.message.allParticipants.push(e.sender),void e.message.allParticipants.forEach(function(e){a[r.peers[e]?"renegotiatePeer":"createNewPeer"](e,{localPeerSdpConstraints:{OfferToReceiveAudio:r.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:r.sdpConstraints.mandatory.OfferToReceiveVideo},remotePeerSdpConstraints:{OfferToReceiveAudio:r.session.oneway?!!r.session.audio:r.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:r.session.oneway?!!r.session.video||!!r.session.screen:r.sdpConstraints.mandatory.OfferToReceiveVideo},isOneWay:!!r.session.oneway||"one-way"===r.direction,isDataOnly:h(r.session)})});if(e.message.newParticipant){if(e.message.newParticipant==r.userid)return;if(r.peers[e.message.newParticipant])return;return void a.createNewPeer(e.message.newParticipant,e.message.userPreferences||{localPeerSdpConstraints:{OfferToReceiveAudio:r.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:r.sdpConstraints.mandatory.OfferToReceiveVideo},remotePeerSdpConstraints:{OfferToReceiveAudio:r.session.oneway?!!r.session.audio:r.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:r.session.oneway?!!r.session.video||!!r.session.screen:r.sdpConstraints.mandatory.OfferToReceiveVideo},isOneWay:!!r.session.oneway||"one-way"===r.direction,isDataOnly:h(r.session)})}if((e.message.readyForOffer||e.message.addMeAsBroadcaster)&&r.addNewBroadcaster(e.sender),e.message.newParticipationRequest&&e.sender!==r.userid){r.peers[e.sender]&&r.deletePeer(e.sender);var o={extra:e.extra||{},localPeerSdpConstraints:e.message.remotePeerSdpConstraints||{OfferToReceiveAudio:r.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:r.sdpConstraints.mandatory.OfferToReceiveVideo},remotePeerSdpConstraints:e.message.localPeerSdpConstraints||{OfferToReceiveAudio:r.session.oneway?!!r.session.audio:r.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:r.session.oneway?!!r.session.video||!!r.session.screen:r.sdpConstraints.mandatory.OfferToReceiveVideo},isOneWay:void 0!==e.message.isOneWay?e.message.isOneWay:!!r.session.oneway||"one-way"===r.direction,isDataOnly:void 0!==e.message.isDataOnly?e.message.isDataOnly:h(r.session),dontGetRemoteStream:void 0!==e.message.isOneWay?e.message.isOneWay:!!r.session.oneway||"one-way"===r.direction,dontAttachLocalStream:!!e.message.dontGetRemoteStream,connectionDescription:e,successCallback:function(){(void 0!==e.message.isOneWay?e.message.isOneWay:!!r.session.oneway||"one-way"===r.direction)&&r.addNewBroadcaster(e.sender,o),(r.session.oneway||"one-way"===r.direction||h(r.session))&&r.addNewBroadcaster(e.sender,o)}};return void r.onNewParticipant(e.sender,o)}return e.message.shiftedModerationControl?void r.onShiftedModerationControl(e.sender,e.message.broadcasters):(e.message.changedUUID&&r.peers[e.message.oldUUID]&&(r.peers[e.message.newUUID]=r.peers[e.message.oldUUID],delete r.peers[e.message.oldUUID]),e.message.userLeft?(a.onUserLeft(e.sender),void(e.message.autoCloseEntireSession&&r.leave())):void a.addNegotiatedMessage(e.message,e.sender))}}),r.socket.on("user-left",function(e){onUserLeft(e),r.onUserStatusChanged({userid:e,status:"offline",extra:r.peers[e]&&r.peers[e].extra||{}}),r.onleave({userid:e,extra:{}})}),r.socket.on("connect",function(){return r.socketAutoReConnect?(r.enableLogs&&webrtcdev.info("socket.io connection is opened."),r.socket.emit("extra-data-updated",r.extra),void(e&&e(r.socket))):void(r.socket=null)}),r.socket.on("disconnect",function(){return r.socketAutoReConnect?void(r.enableLogs&&(webrtcdev.info("socket.io connection is closed"),webrtcdev.warn("socket.io reconnecting"))):void(r.socket=null)}),r.socket.on("join-with-password",function(e){r.onJoinWithPassword(e)}),r.socket.on("invalid-password",function(e,n){r.onInvalidPassword(e,n)}),r.socket.on("password-max-tries-over",function(e){r.onPasswordMaxTriesOver(e)}),r.socket.on("user-disconnected",function(e){e!==r.userid&&(r.onUserStatusChanged({userid:e,status:"offline",extra:r.peers[e]&&r.peers[e].extra||{}}),r.deletePeer(e))}),r.socket.on("user-connected",function(e){e!==r.userid&&r.onUserStatusChanged({userid:e,status:"online",extra:r.peers[e]&&r.peers[e].extra||{}})}),r.socket.on("closed-entire-session",function(e,n){r.leave(),r.onEntireSessionClosed({sessionid:e,userid:e,extra:n})}),r.socket.on("userid-already-taken",function(e,n){r.isInitiator=!1,r.userid=n,r.onUserIdAlreadyTaken(e,n)}),r.socket.on("logs",function(e){r.enableLogs&&webrtcdev.debug("server-logs",e)}),r.socket.on("number-of-broadcast-viewers-updated",function(e){r.onNumberOfBroadcastViewersUpdated(e)})}function f(s){function o(){s.fbr=new FileBufferReader,s.fbr.onProgress=function(e){s.onFileProgress(e)},s.fbr.onBegin=function(e){s.onFileStart(e)},s.fbr.onEnd=function(e){s.onFileEnd(e)}}var r,d=this,i=["getAllParticipants","getLength","selectFirst","streams","send","forEach"];function o(){(r=new FileBufferReader).onProgress=function(e){s.onFileProgress(e)},r.onBegin=function(e){s.onFileStart(e)},r.onEnd=function(e){s.onFileEnd(e)}}s.peers={getLength:function(){var e=0;for(var n in this)-1==i.indexOf(n)&&e++;return e},selectFirst:function(){var e;for(var n in this)-1==i.indexOf(n)&&(e=this[n]);return e},getAllParticipants:function(e){var n=[];for(var t in this)-1==i.indexOf(t)&&t!=e&&n.push(t);return n},forEach:function(n){this.getAllParticipants().forEach(function(e){n(s.peers[e])})},send:function(n,e){var t=this;if(c(n.size)||c(n.type))if("text"===n.type||n instanceof ArrayBuffer||n instanceof DataView){if("text"===n.type&&(n=JSON.stringify(n)),e){var i=s.peers[e];if(i)return i.channels.length?void i.channels.forEach(function(e){e.send(n)}):(s.peers[e].createDataChannel(),s.renegotiate(e),void setTimeout(function(){t.send(n,e)},3e3))}this.getAllParticipants().forEach(function(e){if(!t[e].channels.length)return s.peers[e].createDataChannel(),s.renegotiate(e),void setTimeout(function(){t[e].channels.forEach(function(e){e.send(n)})},3e3);t[e].channels.forEach(function(e){e.send(n)})})}else X.send({text:n,channel:this,connection:s,remoteUserId:e});else d.shareFile(n,e)}},this.uuid=s.userid,this.getLocalConfig=function(e,i,n){return n||(n={}),{streamsToShare:n.streamsToShare||{},rtcMultiConnection:s,connectionDescription:n.connectionDescription,userid:i,localPeerSdpConstraints:n.localPeerSdpConstraints,remotePeerSdpConstraints:n.remotePeerSdpConstraints,dontGetRemoteStream:!!n.dontGetRemoteStream,dontAttachLocalStream:!!n.dontAttachLocalStream,renegotiatingPeer:!!n.renegotiatingPeer,peerRef:n.peerRef,channels:n.channels||[],onLocalSdp:function(e){d.onNegotiationNeeded(e,i)},onLocalCandidate:function(e){(e=F.processCandidates(s,e))&&d.onNegotiationNeeded(e,i)},remoteSdp:e,onDataChannelMessage:function(e){if(!r&&s.enableFileSharing&&o(),"string"!=typeof e&&s.enableFileSharing){var n=this;e instanceof ArrayBuffer||e instanceof DataView?r.convertToObject(e,function(e){n.onDataChannelMessage(e)}):e.readyForNextChunk?r.getNextChunk(e.uuid,function(n,e){s.peers[i].channels.forEach(function(e){e.send(n)})},i):r.addChunk(e,function(e){s.peers[i].peer.channel.send(e)})}else d.onDataChannelMessage(e,i)},onDataChannelError:function(e){d.onDataChannelError(e,i)},onDataChannelOpened:function(e){d.onDataChannelOpened(e,i)},onDataChannelClosed:function(e){d.onDataChannelClosed(e,i)},onRemoteStream:function(e){if(s.peers[i].streams.push(e),x&&window.PluginRTC){var n=document.createElement("video"),t=s.videosContainer;return t.insertBefore(n,t.firstChild),void setTimeout(function(){window.PluginRTC.attachMediaStream(n,e)},3e3)}d.onGettingRemoteMedia(e,i)},onRemoteStreamRemoved:function(e){d.onRemovingRemoteMedia(e,i)},onPeerStateChanged:function(e){d.onPeerStateChanged(e),"new"===e.iceConnectionState&&d.onNegotiationStarted(i,e),"connected"===e.iceConnectionState&&d.onNegotiationCompleted(i,e),-1!==e.iceConnectionState.search(/closed|failed/gi)&&(d.onUserLeft(i),d.disconnectWith(i))}}},this.createNewPeer=function(e,n){if(!(s.maxParticipantsAllowed<=s.getAllParticipants().length)){if(n=n||{},s.isInitiator&&s.session.audio&&"two-way"===s.session.audio&&!n.streamsToShare&&(n.isOneWay=!1,n.isDataOnly=!1,n.session=s.session),!n.isOneWay&&!n.isDataOnly)return n.isOneWay=!0,void this.onNegotiationNeeded({enableMedia:!0,userPreferences:n},e);n=s.setUserPreferences(n,e);var t=this.getLocalConfig(null,e,n);s.peers[e]=new a(t)}},this.createAnsweringPeer=function(e,n,t){t=s.setUserPreferences(t||{},n);var i=this.getLocalConfig(e,n,t);s.peers[n]=new a(i)},this.renegotiatePeer=function(e,n,t){if(s.peers[e]){n||(n={}),n.renegotiatingPeer=!0,n.peerRef=s.peers[e].peer,n.channels=s.peers[e].channels;var i=this.getLocalConfig(t,e,n);s.peers[e]=new a(i)}else s.enableLogs&&webrtcdev.error("This peer ("+e+") does not exists. Renegotiation skipped.")},this.replaceTrack=function(n,t,i){if(!s.peers[t])throw"This peer ("+t+") does not exists.";var e=s.peers[t].peer;e.getSenders&&"function"==typeof e.getSenders&&e.getSenders().length?e.getSenders().forEach(function(e){i&&e.track instanceof VideoStreamTrack&&(s.peers[t].peer.lastVideoTrack=e.track,e.replaceTrack(n)),!i&&e.track instanceof AudioStreamTrack&&(s.peers[t].peer.lastAudioTrack=e.track,e.replaceTrack(n))}):(webrtcdev.warn("RTPSender.replaceTrack is NOT supported."),this.renegotiatePeer(t))},this.onNegotiationNeeded=function(e,n){},this.addNegotiatedMessage=function(o,r){if(o.type&&o.sdp)return"answer"==o.type&&s.peers[r]&&s.peers[r].addRemoteSdp(o),"offer"==o.type&&(o.renegotiatingPeer?this.renegotiatePeer(r,null,o):this.createAnsweringPeer(o,r)),void(s.enableLogs&&webrtcdev.log("Remote peer's sdp:",o.sdp));if(o.candidate)return s.peers[r]&&s.peers[r].addRemoteCandidate(o),void(s.enableLogs&&webrtcdev.log("Remote peer's candidate pairs:",o.candidate));if(o.enableMedia){if(s.attachStreams.length||s.dontCaptureUserMedia){var n={};return s.attachStreams.forEach(function(e){n[e.streamid]={isAudio:!!e.isAudio,isVideo:!!e.isVideo,isScreen:!!e.isScreen}}),o.userPreferences.streamsToShare=n,void d.onNegotiationNeeded({readyForOffer:!0,userPreferences:o.userPreferences},r)}var e={},t=o.userPreferences;t.localPeerSdpConstraints.OfferToReceiveAudio&&(e.audio=s.mediaConstraints.audio),t.localPeerSdpConstraints.OfferToReceiveVideo&&(e.video=s.mediaConstraints.video);var i=t.session||s.session;i.oneway&&i.audio&&"two-way"===i.audio&&(i={audio:!0}),(i.audio||i.video||i.screen)&&(i.screen?s.getScreenConstraints(function(e,n){s.invokeGetUserMedia({audio:!!S(s)&&C(n),video:n,isScreen:!0},!i.audio&&!i.video||S(s)?a:s.invokeGetUserMedia(null,a))}):(i.audio||i.video)&&s.invokeGetUserMedia(null,a,i))}function a(e){var n,t,i;n=o,t=r,i={},s.attachStreams.forEach(function(e){i[e.streamid]={isAudio:!!e.isAudio,isVideo:!!e.isVideo,isScreen:!!e.isScreen}}),n.userPreferences.streamsToShare=i,d.onNegotiationNeeded({readyForOffer:!0,userPreferences:n.userPreferences},t)}o.readyForOffer&&s.onReadyForOffer(r,o.userPreferences)},this.connectNewParticipantWithAllBroadcasters=function(e,n,t){if((t=t.split("|-,-|")).length){var i=t[0];d.onNegotiationNeeded({newParticipant:e,userPreferences:n||!1},i),delete t[0];var o=[];t.forEach(function(e){e&&o.push(e)}),setTimeout(function(){d.connectNewParticipantWithAllBroadcasters(e,n,o.join("|-,-|"))},1e4)}},this.onGettingRemoteMedia=function(e,n){},this.onRemovingRemoteMedia=function(e,n){},this.onGettingLocalMedia=function(e){},this.onLocalMediaError=function(e,n){s.onMediaError(e,n)},this.shareFile=function(e,t){if(!s.enableFileSharing)throw'"connection.enableFileSharing" is false.';o(),r.readAsArrayBuffer(e,function(n){var e=s.getAllParticipants();t&&(e=[t]),e.forEach(function(e){r.getNextChunk(n,function(n){s.peers[e].channels.forEach(function(e){e.send(n)})},e)})},{userid:s.userid,chunkSize:R?15e3:s.chunkSize||0})};var t=new n(s);this.onDataChannelMessage=function(e,n){t.receive(JSON.parse(e),n,s.peers[n]?s.peers[n].extra:{})},this.onDataChannelClosed=function(e,n){e.userid=n,e.extra=s.peers[n]?s.peers[n].extra:{},s.onclose(e)},this.onDataChannelError=function(e,n){e.userid=n,event.extra=s.peers[n]?s.peers[n].extra:{},s.onerror(e)},this.onDataChannelOpened=function(e,n){s.peers[n].channels.length?s.peers[n].channels=[e]:(s.peers[n].channels.push(e),s.onopen({userid:n,extra:s.peers[n]?s.peers[n].extra:{},channel:e}))},this.onPeerStateChanged=function(e){s.onPeerStateChanged(e)},this.onNegotiationStarted=function(e,n){},this.onNegotiationCompleted=function(e,n){},this.getRemoteStreams=function(e){return e=e||s.peers.getAllParticipants()[0],s.peers[e]?s.peers[e].streams:[]},this.isPluginRTC=s.isPluginRTC=x}function v(e,n,t){if("undefined"!=typeof CustomEvent){var i=new CustomEvent(n,{arguments:t,__exposedProps__:t});e.dispatchEvent(i)}}function m(n,t){t.stream&&t.stream&&t.stream.addEventListener&&(t.stream.addEventListener("mute",function(e){(e=n.streamEvents[t.streamid]).session={audio:"audio"===e.muteType,video:"video"===e.muteType},n.onmute(e)},!1),t.stream.addEventListener("unmute",function(e){(e=n.streamEvents[t.streamid]).session={audio:"audio"===e.unmuteType,video:"video"===e.unmuteType},n.onunmute(e)},!1))}function p(){if(window.crypto&&window.crypto.getRandomValues&&-1===navigator.userAgent.indexOf("Safari")){for(var e=window.crypto.getRandomValues(new Uint32Array(3)),n="",t=0,i=e.length;t<i;t++)n+=e[t].toString(36);return n}return(Math.random()*(new Date).getTime()).toString(36).replace(/\./g,"")}function g(t,e,i){var n=!1;t.getVideoTracks&&!t.getVideoTracks().length&&(n=!0);var o=document.createElement(n?"audio":"video");return x&&window.PluginRTC?(i.videosContainer.insertBefore(o,i.videosContainer.firstChild),void setTimeout(function(){window.PluginRTC.attachMediaStream(o,t),e(o)},1e3)):(o[R?"mozSrcObject":"src"]=R?t:window.URL.createObjectURL(t),o.controls=!0,R&&o.addEventListener("ended",function(){if(q.remove(t.idInstance),"local"===t.type){z.onSyncNeeded(t.streamid,"ended"),i.attachStreams.forEach(function(e,n){t.streamid===e.streamid&&delete i.attachStreams[n]});var n=[];i.attachStreams.forEach(function(e){e&&n.push(e)}),i.attachStreams=n;var e=i.streamEvents[t.streamid];if(e)return void i.onstreamended(e);this.parentNode&&this.parentNode.removeChild(this)}},!1),void e(o))}function w(e,n){window.removeEventListener(e,n),window.addEventListener(e,n,!1)}function s(e){var n=[];return e.forEach(function(e){e&&n.push(e)}),n}function h(e){return!e.audio&&!e.video&&!e.screen&&e.data}function c(e){return void 0===e}function S(e,n){return(!e.session.audio||"two-way"!==e.session.audio)&&(!(!R||!1===n)||!(!l||M<50)&&(!0===(void 0===n?"undefined":_typeof(n))||!(void 0!==n||!e.session.audio||!e.session.screen||e.session.video)&&(n=!0)))}function C(e){return!!R||!!l&&{mandatory:{chromeMediaSource:e.mandatory.chromeMediaSource,chromeMediaSourceId:e.mandatory.chromeMediaSourceId}}}function e(){if("iOS"===DetectRTC.osName&&"undefined"!=typeof cordova&&void 0!==cordova.plugins&&void 0!==cordova.plugins.iosrtc){var e=cordova.plugins.iosrtc;window.webkitRTCPeerConnection=e.RTCPeerConnection,window.RTCSessionDescription=e.RTCSessionDescription,window.RTCIceCandidate=e.RTCIceCandidate,window.MediaStream=e.MediaStream,window.MediaStreamTrack=e.MediaStreamTrack,navigator.getUserMedia=navigator.webkitGetUserMedia=e.getUserMedia,e.debug.enable("iosrtc*"),e.registerGlobals()}}function b(e){var n;return n={mandatory:{OfferToReceiveAudio:!!e.OfferToReceiveAudio,OfferToReceiveVideo:!!e.OfferToReceiveVideo},optional:[{VoiceActivityDetection:!1}]},navigator.mozGetUserMedia&&34<I&&(n={OfferToReceiveAudio:!!e.OfferToReceiveAudio,OfferToReceiveVideo:!!e.OfferToReceiveVideo}),n}function a(i){if(!L)throw"WebRTC 1.0 (RTCPeerConnection) API are NOT available in this browser.";var o=i.rtcMultiConnection;this.extra=i.remoteSdp?i.remoteSdp.extra:o.extra,this.userid=i.userid,this.streams=[],this.channels=i.channels||[],this.connectionDescription=i.connectionDescription;var t=this;i.remoteSdp&&(this.connectionDescription=i.remoteSdp.connectionDescription);var r,a={};U.sdpConstraints=b({OfferToReceiveAudio:!0,OfferToReceiveVideo:!0});var e=!!i.renegotiatingPeer;i.remoteSdp&&(e=!!i.remoteSdp.renegotiatingPeer);var n=[];if(o.attachStreams.forEach(function(e){e&&n.push(e)}),e)r=i.peerRef;else{var s="all";(o.candidates.turn||o.candidates.relay)&&(o.candidates.stun||o.candidates.reflexive||o.candidates.host||(s="relay")),r=new L(navigator.onLine?{iceServers:o.iceServers,iceTransportPolicy:o.iceTransportPolicy||s}:null,window.PluginRTC?null:o.optionalArgument),o.iceServers.length||(r=new L(null,null))}function d(){return r.getLocalStreams()}r.onicecandidate=function(e){if(e.candidate)o.trickleIce&&i.onLocalCandidate({candidate:e.candidate.candidate,sdpMid:e.candidate.sdpMid,sdpMLineIndex:e.candidate.sdpMLineIndex});else if(!o.trickleIce){var n=r.localDescription;i.onLocalSdp({type:n.type,sdp:n.sdp,remotePeerSdpConstraints:i.remotePeerSdpConstraints||!1,renegotiatingPeer:!!i.renegotiatingPeer||!1,connectionDescription:t.connectionDescription,dontGetRemoteStream:!!i.dontGetRemoteStream,extra:o?o.extra:{},streamsToShare:m,isFirefoxOffered:R})}};i.remoteSdp&&i.remoteSdp.remotePeerSdpConstraints&&i.remoteSdp.remotePeerSdpConstraints.isFirefoxOffered,n.forEach(function(n){i.remoteSdp&&i.remoteSdp.remotePeerSdpConstraints&&i.remoteSdp.remotePeerSdpConstraints.dontGetRemoteStream||i.dontAttachLocalStream||(n=o.beforeAddingStream(n))&&(d().forEach&&d().forEach(function(e){n&&e.id==n.id&&(n=null)}),n&&r.addStream(n))}),r.oniceconnectionstatechange=r.onsignalingstatechange=function(){var e=t.extra;o.peers[t.userid]&&(e=o.peers[t.userid].extra||e),r&&i.onPeerStateChanged({iceConnectionState:r.iceConnectionState,iceGatheringState:r.iceGatheringState,signalingState:r.signalingState,extra:e,userid:t.userid})};var c={OfferToReceiveAudio:!!n.length,OfferToReceiveVideo:!!n.length};i.localPeerSdpConstraints&&(c=i.localPeerSdpConstraints),U.sdpConstraints=b(c);var u;r.addEventListener("addstream",function(n){if(n){if(n.streams&&n.streams.length&&!n.stream){if(!u)return void(u=new D);if(n.streams.forEach(function(e){e.getVideoTracks().length&&u.addTrack(e.getVideoTracks()[0]),e.getAudioTracks().length&&u.addTrack(e.getAudioTracks()[0])}),n.stream=u,o.session.audio&&o.session.video&&(!u.getVideoTracks().length||!u.getAudioTracks().length))return;u=null}var e={};i.remoteSdp&&i.remoteSdp.streamsToShare?e=i.remoteSdp.streamsToShare:i.streamsToShare&&(e=i.streamsToShare);var t=e[n.stream.id];t&&(n.stream.isAudio=t.isAudio,n.stream.isVideo=t.isVideo,n.stream.isScreen=t.isScreen),n.stream.streamid=n.stream.id,n.stream.stop||(n.stream.stop=function(){if(R){var e="ended";"oninactive"in n.stream&&(e="inactive"),v(n.stream,e)}}),a[n.stream.id]=n.stream,i.onRemoteStream(n.stream)}},!1),r.onremovestream=function(e){e.stream.streamid=e.stream.id,a[e.stream.id]&&delete a[e.stream.id],i.onRemoteStreamRemoved(e.stream)},this.addRemoteCandidate=function(e){r.addIceCandidate(new V(e))},this.addRemoteSdp=function(n,e){n.sdp=o.processSdp(n.sdp),r.setRemoteDescription(new N(n),e||function(){},function(e){o.enableLogs&&webrtcdev.error(JSON.stringify(e,null,"\t"),"\n",n.type,n.sdp)})};var l=!0;function f(n){n.binaryType="arraybuffer",n.onmessage=function(e){i.onDataChannelMessage(e.data)},n.onopen=function(){i.onDataChannelOpened(n)},n.onerror=function(e){i.onDataChannelError(e)},n.onclose=function(e){i.onDataChannelClosed(e)},n.internalSend=n.send,n.send=function(e){"open"===n.readyState&&n.internalSend(e)},r.channel=n}i.remoteSdp&&(l=!1),this.createDataChannel=function(){f(r.createDataChannel("sctp",{}))},!0!==o.session.data||e||(l?this.createDataChannel():r.ondatachannel=function(e){f(e.channel)}),i.remoteSdp&&(i.remoteSdp.remotePeerSdpConstraints&&(c=i.remoteSdp.remotePeerSdpConstraints),U.sdpConstraints=b(c),this.addRemoteSdp(i.remoteSdp,function(){p("createAnswer")})),"two-way"!=o.session.audio&&"two-way"!=o.session.video&&"two-way"!=o.session.screen||(U.sdpConstraints=b({OfferToReceiveAudio:"two-way"==o.session.audio||i.remoteSdp&&i.remoteSdp.remotePeerSdpConstraints&&i.remoteSdp.remotePeerSdpConstraints.OfferToReceiveAudio,OfferToReceiveVideo:"two-way"==o.session.video||"two-way"==o.session.screen||i.remoteSdp&&i.remoteSdp.remotePeerSdpConstraints&&i.remoteSdp.remotePeerSdpConstraints.OfferToReceiveAudio}));var m={};function p(e){r[e](function(e){e.sdp=o.processSdp(e.sdp),r.setLocalDescription(e,function(){o.trickleIce&&(i.onLocalSdp({type:e.type,sdp:e.sdp,remotePeerSdpConstraints:i.remotePeerSdpConstraints||!1,renegotiatingPeer:!!i.renegotiatingPeer||!1,connectionDescription:t.connectionDescription,dontGetRemoteStream:!!i.dontGetRemoteStream,extra:o?o.extra:{},streamsToShare:m,isFirefoxOffered:R}),o.onSettingLocalDescription(t))},function(e){o.enableLogs&&webrtcdev.error("setLocalDescription error",e)})},function(e){o.enableLogs&&webrtcdev.error("sdp-error",e)},U.sdpConstraints)}d().forEach&&d().forEach(function(e){m[e.streamid]={isAudio:!!e.isAudio,isVideo:!!e.isVideo,isScreen:!!e.isScreen}}),l&&p("createOffer"),r.nativeClose=r.close,r.close=function(){if(r){try{-1===r.iceConnectionState.search(/closed|failed/gi)&&r.getRemoteStreams().forEach(function(e){e.stop()}),r.nativeClose()}catch(e){}r=null,t.peer=null}},this.peer=r}function t(e){var n="urls";x&&(n="url");var t={};return t[n]=e,t}function i(e,n,t){var i="urls";x&&(i="url");var o={username:n,credential:t};return o[i]=e,o}function o(){var n=[];return window.RMCExternalIceServers.forEach(function(e){e.urls||(e.urls=e.url),-1!==e.urls.search("stun|stuns")&&n.push(t(e.urls)),-1!==e.urls.search("turn|turns")&&n.push(i(e.urls,e.username,e.credential))}),n}function y(o){function n(e,n){var t,i;t=o.localMediaConstraints,i=e,t.mandatory&&t.mandatory.chromeMediaSource?i.isScreen=!0:t.mozMediaSource||t.mediaSource?i.isScreen=!0:t.video?i.isVideo=!0:t.audio&&(i.isAudio=!0),o.onGettingLocalMedia(e,n),e.addEventListener("ended",function(){delete q.streams[r],q.mutex=!1,q.queueRequests.indexOf(o)&&(delete q.queueRequests[q.queueRequests.indexOf(o)],q.queueRequests=s(q.queueRequests))},!1),q.streams[r]={stream:e},q.mutex=!1,q.queueRequests.length&&y(q.queueRequests.shift())}if(!0!==q.mutex){q.mutex=!0;var r=JSON.stringify(o.localMediaConstraints);if(q.streams[r])n(q.streams[r].stream,!0);else{if(x&&window.PluginRTC)return document.createElement("video"),void window.PluginRTC.getUserMedia({audio:!0,video:!0},function(e){e.streamid=e.id||p(),n(e)},function(e){});if(!!/BB10|BlackBerry/i.test(navigator.userAgent||"")||void 0===navigator.mediaDevices||"function"!=typeof navigator.mediaDevices.getUserMedia)return navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia,void navigator.getUserMedia(o.localMediaConstraints,function(e){e.streamid=e.streamid||e.id||p(),e.idInstance=r,n(e)},function(e){o.onLocalMediaError(e,o.localMediaConstraints)});navigator.mediaDevices.getUserMedia(o.localMediaConstraints).then(function(e){e.streamid=e.streamid||e.id||p(),e.idInstance=r,n(e)}).catch(function(e){o.onLocalMediaError(e,o.localMediaConstraints)})}}else q.queueRequests.push(o)}function k(e){if(e){if(R)return T(e);if("desktop"==_)return e(!0);window.postMessage("webrtcdev-extension-presence","*"),setTimeout(function(){e("screen"!=_)},2e3)}}function T(i){if(i){if(!R)return k(i);var o=!1;window.addEventListener("message",function e(n){var t=n.data;t&&void 0!==t.isScreenCapturingEnabled&&(i((o=!0)===t.isScreenCapturingEnabled),window.removeEventListener("message",e,!1))},!1),window.postMessage({checkIfScreenCapturingEnabled:!0,domains:[document.domain]},"*"),setTimeout(function(){o||i(!0)},2e3)}}function P(e,n){if(2!=arguments.length&&(n=e,e=window.RMCExtensionID||"ajhifddimkapgcifgcodmmfdlknahffk"),R)return n("not-chrome");var t=document.createElement("img");t.src="chrome-extension://"+e+"/icon.png",t.onload=function(){_="screen",window.postMessage("are-you-there","*"),setTimeout(function(){n("screen"==_?e==e?"installed-enabled":"installed-disabled":"installed-enabled")},2e3)},t.onerror=function(){n("not-installed")}}function n(a){var s={};return{receive:function(e,n,t){var i=e.uuid;if(s[i]||(s[i]=[]),s[i].push(e.message),e.last){var o=s[i].join("");e.isobject&&(o=JSON.parse(o));var r={data:o,userid:n,extra:t,latency:(new Date).getTime()-e.sendingTime};a.autoTranslateText?(r.original=r.data,a.Translator.TranslateText(r.data,function(e){r.data=e,a.onmessage(r)})):a.onmessage(r),delete s[i]}}}}var r=!!window.opera||0<=navigator.userAgent.indexOf(" OPR/"),R=void 0!==window.InstallTrigger,u=0<Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor"),l=!!window.chrome&&!r,E=!!document.documentMode,O=!!navigator.userAgent.match(/Android|iPhone|iPad|iPod|BlackBerry|IEMobile/i);"undefined"!=typeof cordova&&(l=O=!0),navigator&&navigator.userAgent&&-1!==navigator.userAgent.indexOf("Crosswalk")&&(l=O=!0);var x=!O&&(u||E);x&&"undefined"!=typeof URL&&(URL.createObjectURL=function(){});var M=(window.process&&"object"==_typeof(window.process)&&window.process.versions&&window.process.versions["node-webkit"],50),A=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);l&&A&&A[2]&&(M=parseInt(A[2],10));var I=50;A=navigator.userAgent.match(/Firefox\/(.*)/),R&&A&&A[1]&&(I=parseInt(A[1],10)),window.addEventListener||(window.addEventListener=function(e,n,t){e.attachEvent&&e.attachEvent("on"+n,t)}),window.attachEventListener=function(e,n,t,i){e.addEventListener(n,t,i)};var D=window.MediaStream;void 0===D&&"undefined"!=typeof webkitMediaStream&&(D=webkitMediaStream),void 0!==D&&("getVideoTracks"in D.prototype||(D.prototype.getVideoTracks=function(){if(!this.getTracks)return[];var n=[];return this.getTracks.forEach(function(e){-1!==e.kind.toString().indexOf("video")&&n.push(e)}),n},D.prototype.getAudioTracks=function(){if(!this.getTracks)return[];var n=[];return this.getTracks.forEach(function(e){-1!==e.kind.toString().indexOf("audio")&&n.push(e)}),n}),"stop"in D.prototype||(D.prototype.stop=function(){this.getAudioTracks().forEach(function(e){e.stop&&e.stop()}),this.getVideoTracks().forEach(function(e){e.stop&&e.stop()})})),function(){function e(e,n){var t=0,i=!1,o=window.setInterval(function(){e()&&(window.clearInterval(o),n(i)),50<t++&&(window.clearInterval(o),n(i=!0))},10)}function n(n){return y?(!s.enumerateDevices&&window.MediaStreamTrack&&window.MediaStreamTrack.getSources&&(s.enumerateDevices=window.MediaStreamTrack.getSources.bind(window.MediaStreamTrack)),!s.enumerateDevices&&s.enumerateDevices&&(s.enumerateDevices=s.enumerateDevices.bind(s)),s.enumerateDevices?(h=[],S=[],C=[],b=[],void s.enumerateDevices(function(e){e.forEach(function(e){var n,t={};for(var i in e)t[i]=e[i];"audio"===t.kind&&(t.kind="audioinput"),"video"===t.kind&&(t.kind="videoinput"),h.forEach(function(e){e.id===t.id&&e.kind===t.kind&&(n=!0)}),n||(t.deviceId||(t.deviceId=t.id),t.id||(t.id=t.deviceId),t.label?("videoinput"!==t.kind||E||(E=!0),"audioinput"!==t.kind||R||(R=!0)):(t.label="Please invoke getUserMedia once.","https:"!==location.protocol&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(t.label="HTTPs is required to get label of this "+t.kind+" device.")),"audioinput"===t.kind&&(k=!0,-1===S.indexOf(t)&&S.push(t)),"audiooutput"===t.kind&&(T=!0,-1===C.indexOf(t)&&C.push(t)),"videoinput"===t.kind&&(P=!0,-1===b.indexOf(t)&&b.push(t)),-1===h.indexOf(t)&&h.push(t))}),void 0!==O&&(O.MediaDevices=h,O.hasMicrophone=k,O.hasSpeakers=T,O.hasWebcam=P,O.isWebsiteHasWebcamPermissions=E,O.isWebsiteHasMicrophonePermissions=R,O.audioInputDevices=S,O.audioOutputDevices=C,O.videoInputDevices=b),n&&n()})):void(n&&n())):void(n&&n())}var t,i="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";t="undefined"!=typeof global?global:window,"undefined"==typeof window&&("undefined"==typeof window&&"undefined"!=typeof global&&(global.navigator={userAgent:i,getUserMedia:function(){}},t.window=global),"undefined"==typeof document&&(t.document={},document.createElement=document.captureStream=document.mozCaptureStream=function(){return{}}),"undefined"==typeof location&&(t.location={protocol:"file:",href:"",hash:""}),"undefined"==typeof screen&&(t.screen={width:0,height:0}));var s=window.navigator;void 0!==s?(void 0!==s.webkitGetUserMedia&&(s.getUserMedia=s.webkitGetUserMedia),void 0!==s.mozGetUserMedia&&(s.getUserMedia=s.mozGetUserMedia)):s={getUserMedia:function(){},userAgent:i};var o=!!/Android|webOS|iPhone|iPad|iPod|BB10|BlackBerry|IEMobile|Opera Mini|Mobile|mobile/i.test(s.userAgent||""),d=!(-1===s.userAgent.indexOf("Edge")||!s.msSaveOrOpenBlob&&!s.msSaveBlob),c=!!window.opera||0<=s.userAgent.indexOf(" OPR/"),u=void 0!==window.InstallTrigger,l=0<Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor"),f=!!window.chrome&&!c,m=!!document.documentMode&&!d,r={Android:function(){return s.userAgent.match(/Android/i)},BlackBerry:function(){return s.userAgent.match(/BlackBerry|BB10/i)},iOS:function(){return s.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return s.userAgent.match(/Opera Mini/i)},Windows:function(){return s.userAgent.match(/IEMobile/i)},any:function(){return r.Android()||r.BlackBerry()||r.iOS()||r.Opera()||r.Windows()},getOsName:function(){var e="Unknown OS";return r.Android()&&(e="Android"),r.BlackBerry()&&(e="BlackBerry"),r.iOS()&&(e="iOS"),r.Opera()&&(e="Opera Mini"),r.Windows()&&(e="Windows"),e}},a="Unknown OS",p="Unknown OS Version";if(r.any())a=r.getOsName();else{var v=function(){var e=s.appVersion,n=s.userAgent,t="-",i=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 3.11",r:/Win16/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}];for(var o in i){var r=i[o];if(r.r.test(n)){t=r.s;break}}var a="-";switch(/Windows/.test(t)&&(/Windows (.*)/.test(t)&&(a=/Windows (.*)/.exec(t)[1]),t="Windows"),t){case"Mac OS X":/Mac OS X (10[\.\_\d]+)/.test(n)&&(a=/Mac OS X (10[\.\_\d]+)/.exec(n)[1]);break;case"Android":/Android ([\.\_\d]+)/.test(n)&&(a=/Android ([\.\_\d]+)/.exec(n)[1]);break;case"iOS":/OS (\d+)_(\d+)_?(\d+)?/.test(n)&&(a=(a=/OS (\d+)_(\d+)_?(\d+)?/.exec(e))[1]+"."+a[2]+"."+(0|a[3]))}return{osName:t,osVersion:a}}();a=v.osName,p=v.osVersion}var g=!1,w=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach(function(e){!g&&e in document.createElement("canvas")&&(g=!0),!w&&e in document.createElement("video")&&(w=!0)});var h=[],S=[],C=[],b=[];s.mediaDevices&&s.mediaDevices.enumerateDevices&&(s.enumerateDevices=function(e){s.mediaDevices.enumerateDevices().then(e).catch(function(){e([])})});var y=!1;void 0!==j&&"getSources"in j?y=!0:s.mediaDevices&&s.mediaDevices.enumerateDevices&&(y=!0);var k=!1,T=!1,P=!1,R=!1,E=!1;n();var O=window.DetectRTC||{};O.browser=function(){var e,n,t,i=(s.appVersion,s.userAgent),o=s.appName,r=""+parseFloat(s.appVersion),a=parseInt(s.appVersion,10);if(c){o="Opera";try{a=(r=s.userAgent.split("OPR/")[1].split(" ")[0]).split(".")[0]}catch(e){r="0.0.0.0",a=0}}else m?(n=i.indexOf("MSIE"),o="IE",r=i.substring(n+5)):f?(n=i.indexOf("Chrome"),o="Chrome",r=i.substring(n+7)):l?(n=i.indexOf("Safari"),o="Safari",r=i.substring(n+7),-1!==(n=i.indexOf("Version"))&&(r=i.substring(n+8))):u?(n=i.indexOf("Firefox"),o="Firefox",r=i.substring(n+8)):(e=i.lastIndexOf(" ")+1)<(n=i.lastIndexOf("/"))&&(o=i.substring(e,n),r=i.substring(n+1),o.toLowerCase()===o.toUpperCase()&&(o=s.appName));return d&&(o="Edge",r=parseInt(s.userAgent.match(/Edge\/(\d+).(\d+)$/)[2],10).toString()),-1!==(t=r.indexOf(";"))&&(r=r.substring(0,t)),-1!==(t=r.indexOf(" "))&&(r=r.substring(0,t)),a=parseInt(""+r,10),isNaN(a)&&(r=""+parseFloat(s.appVersion),a=parseInt(s.appVersion,10)),{fullVersion:r,version:a,name:o,isPrivateBrowsing:!1}}(),function(n){var t;if(window.webkitRequestFileSystem)window.webkitRequestFileSystem(window.TEMPORARY,1,function(){t=!1},function(e){webrtcdev.log(e),t=!0});else if(window.indexedDB&&/Firefox/.test(window.navigator.userAgent)){var i;try{i=window.indexedDB.open("test")}catch(e){t=!0}void 0===t&&e(function(){return"done"===i.readyState},function(e){e||(t=!i.result)})}else if(function(e){var n=e.toLowerCase();if(0===n.indexOf("msie")&&0===n.indexOf("trident"))return!1;var t=/(?:msie|rv:)\s?([\d\.]+)/.exec(n);return!!(t&&10<=parseInt(t[1],10))}(window.navigator.userAgent)){t=!1;try{window.indexedDB||(t=!0)}catch(e){t=!0}}else if(window.localStorage&&/Safari/.test(window.navigator.userAgent)){try{window.localStorage.setItem("test",1)}catch(e){t=!0}void 0===t&&(t=!1,window.localStorage.removeItem("test"))}e(function(){return void 0!==t},function(e){n(t)})}(function(e){O.browser.isPrivateBrowsing=!!e}),O.browser["is"+O.browser.name]=!0;var x=(window.process&&"object"==_typeof(window.process)&&window.process.versions&&window.process.versions["node-webkit"],!1);["RTCPeerConnection","webkitRTCPeerConnection","mozRTCPeerConnection","RTCIceGatherer"].forEach(function(e){x||e in window&&(x=!0)}),O.isWebRTCSupported=x,O.isORTCSupported="undefined"!=typeof RTCIceGatherer;var M=!1;O.browser.isChrome&&35<=O.browser.version?M=!0:O.browser.isFirefox&&34<=O.browser.version&&(M=!0),"https:"!==location.protocol&&(M=!1),O.isScreenCapturingSupported=M;var A={isSupported:!1,isCreateMediaStreamSourceSupported:!1};["AudioContext","webkitAudioContext","mozAudioContext","msAudioContext"].forEach(function(e){A.isSupported||e in window&&(A.isSupported=!0,"createMediaStreamSource"in window[e].prototype&&(A.isCreateMediaStreamSourceSupported=!0))}),O.isAudioContextSupported=A.isSupported,O.isCreateMediaStreamSourceSupported=A.isCreateMediaStreamSourceSupported;var I=!1;O.browser.isChrome&&31<O.browser.version&&(I=!0),O.isRtpDataChannelsSupported=I;var D=!1;O.browser.isFirefox&&28<O.browser.version?D=!0:O.browser.isChrome&&25<O.browser.version?D=!0:O.browser.isOpera&&11<=O.browser.version&&(D=!0),O.isSctpDataChannelsSupported=D,O.isMobileDevice=o;var L=!1;s.getUserMedia?L=!0:s.mediaDevices&&s.mediaDevices.getUserMedia&&(L=!0),O.browser.isChrome&&46<=O.browser.version&&"https:"!==location.protocol&&(O.isGetUserMediaSupported="Requires HTTPs"),O.isGetUserMediaSupported=L,O.osName=a,O.osVersion=p;var U="";screen.width&&(U+=(screen.width?screen.width:"")+" x "+(screen.height?screen.height:""));O.displayResolution=U,O.isCanvasSupportsStreamCapturing=g,O.isVideoSupportsStreamCapturing=w,O.DetectLocalIPAddress=function(n){O.isWebRTCSupported&&(O.isORTCSupported||function(i){function n(e){var n=/([0-9]{1,3}(\.[0-9]{1,3}){3})/.exec(e);if(n){var t=n[1];void 0===o[t]&&i(t),o[t]=!0}else webrtcdev.warn("Could not match IP address in",e)}var o={},e=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,t=!!window.webkitRTCPeerConnection;if(!e){var r=document.getElementById("iframe");if(!r)throw"NOTE: you need to have an iframe in the page right above the script tag.";var a=r.contentWindow;e=a.RTCPeerConnection||a.mozRTCPeerConnection||a.webkitRTCPeerConnection,t=!!a.webkitRTCPeerConnection}if(e){var s;t&&(s={iceServers:[{urls:"stun:stun.services.mozilla.com"}]},void 0!==O&&O.browser.isFirefox&&O.browser.version<=38&&(s[0]={url:s[0].urls}));var d=new e(s,{optional:[{RtpDataChannels:!0}]});d.onicecandidate=function(e){e.candidate&&n(e.candidate.candidate)},d.createDataChannel(""),d.createOffer(function(e){d.setLocalDescription(e,function(){},function(){})},function(){}),setTimeout(function(){var e=d.localDescription.sdp.split("\n");e.forEach(function(e){0===e.indexOf("a=candidate:")&&n(e)})},1e3)}}(function(e){n(e.match(/^(192\.168\.|169\.254\.|10\.|172\.(1[6-9]|2\d|3[01]))/)?"Local: "+e:"Public: "+e)}))},O.isWebSocketsSupported="WebSocket"in window&&2===window.WebSocket.CLOSING,O.isWebSocketsBlocked=!O.isWebSocketsSupported,O.checkWebSocketsSupport=function(n){n=n||function(){};try{var e=new WebSocket("wss://echo.websocket.org:443/");e.onopen=function(){O.isWebSocketsBlocked=!1,n(),e.close(),e=null},e.onerror=function(){O.isWebSocketsBlocked=!0,n()}}catch(e){O.isWebSocketsBlocked=!0,n()}},O.load=function(e){n(e=e||function(){})},O.MediaDevices=h,O.hasMicrophone=k,O.hasSpeakers=T,O.hasWebcam=P,O.isWebsiteHasWebcamPermissions=E,O.isWebsiteHasMicrophonePermissions=R,O.audioInputDevices=S,O.audioOutputDevices=C,O.videoInputDevices=b;var N=!1;"setSinkId"in document.createElement("video")&&(N=!0),O.isSetSinkIdSupported=N;var V=!1;O.browser.isFirefox&&"undefined"!=typeof mozRTCPeerConnection?"getSenders"in mozRTCPeerConnection.prototype&&(V=!0):O.browser.isChrome&&"undefined"!=typeof webkitRTCPeerConnection&&"getSenders"in webkitRTCPeerConnection.prototype&&(V=!0),O.isRTPSenderReplaceTracksSupported=V;var W=!1;O.browser.isFirefox&&38<O.browser.version&&(W=!0),O.isRemoteStreamProcessingSupported=W;var B=!1;void 0!==j&&"applyConstraints"in j.prototype&&(B=!0),O.isApplyConstraintsSupported=B;var F=!1;O.browser.isFirefox&&43<=O.browser.version&&(F=!0),O.isMultiMonitorScreenCapturingSupported=F,O.isPromisesSupported=!!("Promise"in window),void 0===O&&(window.DetectRTC={});var G=window.MediaStream;void 0===G&&"undefined"!=typeof webkitMediaStream&&(G=webkitMediaStream),O.MediaStream=void 0!==G&&Object.keys(G.prototype),O.MediaStreamTrack=void 0!==j&&Object.keys(j.prototype);var q=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;O.RTCPeerConnection=void 0!==q&&Object.keys(q.prototype),window.DetectRTC=O,"undefined"!=typeof module&&(module.exports=O),"function"==typeof define&&define.amd&&define("DetectRTC",[],function(){return O})}(),document.addEventListener("deviceready",e,!1),e();var L,U={};"undefined"!=typeof mozRTCPeerConnection?L=mozRTCPeerConnection:"undefined"!=typeof webkitRTCPeerConnection?L=webkitRTCPeerConnection:void 0!==window.RTCPeerConnection&&(L=window.RTCPeerConnection);var N=window.RTCSessionDescription||window.mozRTCSessionDescription,V=window.RTCIceCandidate||window.mozRTCIceCandidate,j=window.MediaStreamTrack;window.onPluginRTCInitialized=function(){j=window.PluginRTC.MediaStreamTrack,L=window.PluginRTC.RTCPeerConnection,V=window.PluginRTC.RTCIceCandidate,N=window.PluginRTC.RTCSessionDescription},void 0!==window.PluginRTC&&window.onPluginRTCInitialized();var W=function(){function l(e,n,t){return function(e,n,t,i,o){for(var r=-1!==t?t:e.length,a=n;a<r;++a)if(0===e[a].indexOf(i)&&(!o||-1!==e[a].toLowerCase().indexOf(o.toLowerCase())))return a;return null}(e,0,-1,n,t)}function f(e){var n=new RegExp("a=rtpmap:(\\d+) \\w+\\/\\d+"),t=e.match(n);return t&&2===t.length?t[1]:null}var m=!!navigator.userAgent.match(/Android|iPhone|iPad|iPod|BlackBerry|IEMobile/i);return"undefined"!=typeof cordova&&(m=!0),navigator&&navigator.userAgent&&-1!==navigator.userAgent.indexOf("Crosswalk")&&(m=!0),{removeVPX:function(e){if(!e||"string"!=typeof e)throw"Invalid arguments.";return(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace("a=rtpmap:100 VP8/90000\r\n","")).replace("a=rtpmap:101 VP9/90000\r\n","")).replace(/m=video ([0-9]+) RTP\/SAVPF ([0-9 ]*) 100/g,"m=video $1 RTP/SAVPF $2")).replace(/m=video ([0-9]+) RTP\/SAVPF ([0-9 ]*) 101/g,"m=video $1 RTP/SAVPF $2")).replace(/m=video ([0-9]+) RTP\/SAVPF 100([0-9 ]*)/g,"m=video $1 RTP/SAVPF$2")).replace(/m=video ([0-9]+) RTP\/SAVPF 101([0-9 ]*)/g,"m=video $1 RTP/SAVPF$2")).replace("a=rtcp-fb:120 nack\r\n","")).replace("a=rtcp-fb:120 nack pli\r\n","")).replace("a=rtcp-fb:120 ccm fir\r\n","")).replace("a=rtcp-fb:101 nack\r\n","")).replace("a=rtcp-fb:101 nack pli\r\n","")).replace("a=rtcp-fb:101 ccm fir\r\n","")},disableNACK:function(e){if(!e||"string"!=typeof e)throw"Invalid arguments.";return(e=(e=(e=e.replace("a=rtcp-fb:126 nack\r\n","")).replace("a=rtcp-fb:126 nack pli\r\n","a=rtcp-fb:126 pli\r\n")).replace("a=rtcp-fb:97 nack\r\n","")).replace("a=rtcp-fb:97 nack pli\r\n","a=rtcp-fb:97 pli\r\n")},prioritize:function(i,e){if(e&&e.getSenders&&e.getSenders().length){if(!i||"string"!=typeof i)throw"Invalid arguments.";e.getSenders().forEach(function(e){for(var n=e.getParameters(),t=0;t<n.codecs.length;t++)if(n.codecs[t].mimeType==i){n.codecs.unshift(n.codecs.splice(t,1));break}e.setParameters(n)})}},removeNonG722:function(e){return e.replace(/m=audio ([0-9]+) RTP\/SAVPF ([0-9 ]*)/g,"m=audio $1 RTP/SAVPF 9")},setApplicationSpecificBandwidth:function(e,n,t){return i=e,r=t,(o=n)&&(void 0!==R&&R||m||(r&&(o.screen?o.screen<300&&webrtcdev.warn("It seems that you are using wrong bandwidth value for screen. Screen sharing is expected to fail."):webrtcdev.warn("It seems that you are not using bandwidth for screen. Screen sharing is expected to fail.")),o.screen&&r&&(i=(i=i.replace(/b=AS([^\r\n]+\r\n)/g,"")).replace(/a=mid:video\r\n/g,"a=mid:video\r\nb=AS:"+o.screen+"\r\n")),(o.audio||o.video||o.data)&&(i=i.replace(/b=AS([^\r\n]+\r\n)/g,"")),o.audio&&(i=i.replace(/a=mid:audio\r\n/g,"a=mid:audio\r\nb=AS:"+o.audio+"\r\n")),o.video&&(i=i.replace(/a=mid:video\r\n/g,"a=mid:video\r\nb=AS:"+(r?o.screen:o.video)+"\r\n")))),i;var i,o,r},setVideoBitrates:function(e,n){return function(e,n){if(m)return e;var t,i=(n=n||{}).min,o=n.max,r=e.split("\r\n"),a=l(r,"a=rtpmap","VP8/90000");if(a&&(t=f(r[a])),!t)return e;var s,d=l(r,"a=rtpmap","rtx/90000");if(d&&(s=f(r[d])),!d)return e;var c=l(r,"a=fmtp:"+s.toString());if(null!==c){var u="\r\n";u+="a=fmtp:"+t+" x-google-min-bitrate="+(i||"228")+"; x-google-max-bitrate="+(o||"228"),r[c]=r[c].concat(u),e=r.join("\r\n")}return e}(e,n)},setOpusAttributes:function(e,n){return function(e,n){if(m)return e;n=n||{};var t,i=e.split("\r\n"),o=l(i,"a=rtpmap","opus/48000");if(o&&(t=f(i[o])),!t)return e;var r=l(i,"a=fmtp:"+t.toString());if(null===r)return e;var a="";return a+="; stereo="+(void 0!==n.stereo?n.stereo:"1"),a+="; sprop-stereo="+(void 0!==n["sprop-stereo"]?n["sprop-stereo"]:"1"),void 0!==n.maxaveragebitrate&&(a+="; maxaveragebitrate="+(n.maxaveragebitrate||1048576)),void 0!==n.maxplaybackrate&&(a+="; maxplaybackrate="+(n.maxplaybackrate||1048576)),void 0!==n.cbr&&(a+="; cbr="+(void 0!==n.cbr?n.cbr:"1")),void 0!==n.useinbandfec&&(a+="; useinbandfec="+n.useinbandfec),void 0!==n.usedtx&&(a+="; usedtx="+n.usedtx),void 0!==n.maxptime&&(a+="\r\na=maxptime:"+n.maxptime),i[r]=i[r].concat(a),i.join("\r\n")}(e,n)},preferVP9:function(e){return-1===e.indexOf("SAVPF 100 101")||-1===e.indexOf("VP9/90000")?e:e.replace("SAVPF 100 101","SAVPF 101 100")},forceStereoAudio:function(e){for(var n=e.split("\r\n"),t=null,i=0;i<n.length;i++)if(-1!==n[i].search("opus/48000")){var o=extractSdp(n[i],/:(\d+) opus\/48000/i);break}for(i=0;i<n.length;i++)if(-1!==n[i].search("a=fmtp")&&extractSdp(n[i],/a=fmtp:(\d+)/)===o){t=i;break}return null===t?e:(n[t]=n[t].concat("; stereo=1; sprop-stereo=1"),e=n.join("\r\n"))}}}();window.BandwidthHandler=W;var B,F={processCandidates:function(e,n){var t=n.candidate,i=e.candidates,o=i.stun,r=i.turn;if(c(i.reflexive)||(o=i.reflexive),c(i.relay)||(r=i.relay),(i.host||!t.match(/typ host/g))&&(r||!t.match(/typ relay/g))&&(o||!t.match(/typ srflx/g))){var a=e.iceProtocols;if((a.udp||!t.match(/ udp /g))&&(a.tcp||!t.match(/ tcp /g)))return e.enableLogs&&webrtcdev.debug("Your candidate pairs:",t),{candidate:t,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex}}}};void 0!==window.getExternalIceServers&&1==window.getExternalIceServers&&function e(t,n){if(!B){if(!n)return e(t,!0);B=!0;var i=document.createElement("iframe");i.onload=function(){i.isLoaded=!0,w("message",function e(n){n.data&&n.data.iceServers&&(t(n.data.iceServers),window.removeEventListener("message",e))}),i.contentWindow.postMessage("get-ice-servers","*")},i.src="https://cdn.webrtc-experiment.com/getIceServers/",i.style.display="none",(document.body||document.documentElement).appendChild(i)}}(function(e){e&&e.length&&(window.RMCExternalIceServers=e,window.iceServersLoadCallback&&"function"==typeof window.iceServersLoadCallback&&window.iceServersLoadCallback(e))});var G={getIceServers:function(e){var n=[];return n.push(t("stun:stun.l.google.com:19302")),n.push(i("turn:webrtcweb.com:80","muazkh","muazkh")),n.push(i("turn:webrtcweb.com:443","muazkh","muazkh")),window.RMCExternalIceServers?n=n.concat(o()):void 0!==window.getExternalIceServers&&1==window.getExternalIceServers&&(e.iceServers=n,window.iceServersLoadCallback=function(){e.iceServers=e.iceServers.concat(o())}),n}},q={streams:[],mutex:!1,queueRequests:[],remove:function(e){this.mutex=!1;var n=this.streams[e];if(n){var t=(n=n.stream).currentUserMediaRequestOptions;this.queueRequests.indexOf(t)&&(delete this.queueRequests[this.queueRequests.indexOf(t)],this.queueRequests=s(this.queueRequests)),this.streams[e].stream=null,delete this.streams[e]}}},z=function(){function a(e){return e?"string"==typeof e||void 0===e?e:e.audio&&e.video?null:e.audio?"audio":e.video?"video":void 0:void 0}return{setHandlers:function(t,i,o){function r(){if(o.streamEvents[t.streamid].mediaElement){var e=o.streamEvents[t.streamid].mediaElement;e.volume=0,function e(n,t,i,o){t<=(o=(o||0)+1)||setTimeout(function(){i(),e(n,t,i,o)},n)}(200,5,function(){e.volume+=.2})}}t&&t.addEventListener&&((void 0===i||1==i)&&t.addEventListener("ended",function(){z.onSyncNeeded(this.streamid,"ended")},!1),t.mute=function(e,n){e=a(e),void 0!==n&&(i=n),(void 0===e||"audio"==e)&&t.getAudioTracks().forEach(function(e){e.enabled=!1,o.streamEvents[t.streamid].isAudioMuted=!0}),(void 0===e||"video"==e)&&t.getVideoTracks().forEach(function(e){e.enabled=!1}),(void 0===i||1==i)&&z.onSyncNeeded(t.streamid,"mute",e),o.streamEvents[t.streamid].muteType=e||"both",v(t,"mute",e)},t.unmute=function(e,n){e=a(e),void 0!==n&&(i=n),r(),(void 0===e||"audio"==e)&&t.getAudioTracks().forEach(function(e){e.enabled=!0,o.streamEvents[t.streamid].isAudioMuted=!1}),(void 0===e||"video"==e)&&(t.getVideoTracks().forEach(function(e){e.enabled=!0}),void 0!==e&&"video"==e&&o.streamEvents[t.streamid].isAudioMuted&&function e(n){n||(n=0),++n<100&&o.streamEvents[t.streamid].isAudioMuted&&(t.mute("audio"),setTimeout(function(){e(n)},50))}()),(void 0===i||1==i)&&z.onSyncNeeded(t.streamid,"unmute",e),o.streamEvents[t.streamid].unmuteType=e||"both",v(t,"unmute",e)})},onSyncNeeded:function(e,n,t){}}}();window.addEventListener("message",function(e){e.origin==window.location.origin&&function(e){if("PermissionDeniedError"==e)throw _="PermissionDeniedError",new Error("PermissionDeniedError");"rtcmulticonnection-extension-loaded"==e&&(_="desktop"),e.sourceId}(e.data)});var H,_="screen",X={send:function(e){var o=e.connection,r=e.channel,a=e.remoteUserId,n=e.text,s=o.chunkSize||1e3,d="",c=!1;"string"!=typeof n&&(c=!0,n=JSON.stringify(n));var u=p(),l=(new Date).getTime();!function e(n,t){var i={type:"text",uuid:u,sendingTime:l};n&&(t=n,i.packets=parseInt(t.length/s));t.length>s?i.message=t.slice(0,s):(i.message=t,i.last=!0,i.isobject=c);r.send(i,a);d=t.slice(i.message.length);d.length&&setTimeout(function(){e(null,d)},o.chunkInterval||100)}(n)}},J={handle:function(t){var i={};t.onFileStart=function(e){var n=document.createElement("div");return n.title=e.name,n.innerHTML="<label>0%</label> <progress></progress>",e.remoteUserId&&(n.innerHTML+=" (Sharing with:"+e.remoteUserId+")"),t.filesContainer||(t.filesContainer=document.body||document.documentElement),t.filesContainer.insertBefore(n,t.filesContainer.firstChild),e.remoteUserId?(i[e.uuid]||(i[e.uuid]={}),i[e.uuid][e.remoteUserId]={div:n,progress:n.querySelector("progress"),label:n.querySelector("label")},void(i[e.uuid][e.remoteUserId].progress.max=e.maxChunks)):(i[e.uuid]={div:n,progress:n.querySelector("progress"),label:n.querySelector("label")},void(i[e.uuid].progress.max=e.maxChunks))},t.onFileProgress=function(e){var n=i[e.uuid];n&&(!e.remoteUserId||(n=i[e.uuid][e.remoteUserId]))&&(n.progress.value=e.currentPosition||e.maxChunks||n.progress.max,function(e,n){if(-1!==e.position){var t=+e.position.toFixed(2).split(".")[1]||100;n.innerHTML=t+"%"}}(n.progress,n.label))},t.onFileEnd=function(e){var n=i[e.uuid];if(n){if(!e.remoteUserId||(n=i[e.uuid][e.remoteUserId])){var t=n.div;-1!=e.type.indexOf("image")?t.innerHTML='<a href="'+e.url+'" download="'+e.name+'">Download <strong style="color:red;">'+e.name+'</strong> </a><br /><img src="'+e.url+'" title="'+e.name+'" style="max-width: 80%;">':t.innerHTML='<a href="'+e.url+'" download="'+e.name+'">Download <strong style="color:red;">'+e.name+'</strong> </a><br /><iframe src="'+e.url+'" title="'+e.name+'" style="width: 80%;border: 0;height: inherit;margin-top:1em;"></iframe>'}}else webrtcdev.error("No such progress-helper element exists.",e)}}},$={handle:function(a){a.autoTranslateText=!1,a.language="en",a.googKey="AIzaSyCgB5hmFY74WYB-EoWkhr9cAGr6TiTHrEE",a.Translator={TranslateText:function(n,t){var e=document.createElement("script");e.type="text/javascript";var i=encodeURIComponent(n),o="method"+a.token();window[o]=function(e){e.data&&e.data.translations[0]&&t&&t(e.data.translations[0].translatedText),e.error&&"Daily Limit Exceeded"===e.error.message&&(warn('Text translation failed. Error message: "Daily Limit Exceeded."'),t(n))};var r="https://www.googleapis.com/language/translate/v2?key="+a.googKey+"&target="+(a.language||"en-US")+"&callback=window."+o+"&q="+i;e.src=r,document.getElementsByTagName("head")[0].appendChild(e)}}}};window.RTCMultiConnection=function(e,n){function c(n){if(u.socketAutoReConnect=!0,u.socket)n&&n(u.socket);else{if(void 0===d)if("undefined"!=typeof FirebaseConnection)window.SocketConnection=FirebaseConnection;else{if("undefined"==typeof PubNubConnection)throw"SocketConnection.js seems missed.";window.SocketConnection=PubNubConnection}new d(u,function(e){n&&n(u.socket)})}}function t(e,n){u.closeBeforeUnload&&(!0===u.isInitiator&&u.dontMakeMeModerator(),u.peers.getAllParticipants().forEach(function(e){l.onNegotiationNeeded({userLeft:!0},e),u.peers[e]&&u.peers[e].peer&&u.peers[e].peer.close(),delete u.peers[e]}),n||u.closeSocket(),u.broadcasters=[],u.isInitiator=!1)}function i(e,n){return e?(n.audio&&e.getAudioTracks().forEach(function(e){e.applyConstraints(n.audio)}),void(n.video&&e.getVideoTracks().forEach(function(e){e.applyConstraints(n.video)}))):void(u.enableLogs&&webrtcdev.error("No stream to applyConstraints."))}function r(n,e,t){return e?void l.replaceTrack(n,e,t):void u.peers.getAllParticipants().forEach(function(e){l.replaceTrack(n,e,t)})}function o(){if(u.isInitiator&&!u.session.oneway&&!u.session.broadcast&&"many-to-many"===u.direction){var n=u.broadcasters[0],t=[];u.broadcasters.forEach(function(e){e!==n&&t.push(e)}),u.autoCloseEntireSession||u.shiftModerationControl(n,t,!0)}}n=n||{useDefaultDevices:!0};var u=this;u.channel=u.sessionid=(e||location.href.replace(/\/|:|#|\?|\$|\^|%|\.|`|~|!|\+|@|\[|\||]|\|*. /g,"").split("\n").join("").split("\r").join(""))+"";var l=new f(u);l.onGettingLocalMedia=function(n){n.type="local",u.setStreamEndHandler(n),g(n,function(e){e.id=n.streamid,e.muted=!0,e.volume=0,-1===u.attachStreams.indexOf(n)&&u.attachStreams.push(n),void 0!==z&&z.setHandlers(n,!0,u),u.streamEvents[n.streamid]={stream:n,type:"local",mediaElement:e,userid:u.userid,extra:u.extra,streamid:n.streamid,blobURL:e.src||URL.createObjectURL(n),isAudioMuted:!0},function(t,i){if(!t||!i)throw"Both arguments are required.";if(t.onspeaking&&t.onsilence){if("undefined"==typeof hark)throw"hark.js not found.";hark(i.stream,{onspeaking:function(){t.onspeaking(i)},onsilence:function(){t.onsilence(i)},onvolumechange:function(e,n){t.onvolumechange&&t.onvolumechange(merge({volume:e,threshold:n},i))}})}}(u,u.streamEvents[n.streamid]),m(u,u.streamEvents[n.streamid]),u.onstream(u.streamEvents[n.streamid])},u)},l.onGettingRemoteMedia=function(n,t){n.type="remote",u.setStreamEndHandler(n,"remote-stream"),g(n,function(e){e.id=n.streamid,void 0!==z&&z.setHandlers(n,!1,u),u.streamEvents[n.streamid]={stream:n,type:"remote",userid:t,extra:u.peers[t]?u.peers[t].extra:{},mediaElement:e,streamid:n.streamid,blobURL:e.src||URL.createObjectURL(n)},m(u,u.streamEvents[n.streamid]),u.onstream(u.streamEvents[n.streamid])},u)},l.onRemovingRemoteMedia=function(e,n){var t=u.streamEvents[e.streamid];t||(t={stream:e,type:"remote",userid:n,extra:u.peers[n]?u.peers[n].extra:{},streamid:e.streamid,mediaElement:u.streamEvents[e.streamid]?u.streamEvents[e.streamid].mediaElement:null}),u.onstreamended(t),delete u.streamEvents[e.streamid]},l.onNegotiationNeeded=function(e,n,t){c(function(){u.socket.emit(u.socketMessageEvent,"password"in e?e:{remoteUserId:e.remoteUserId||n,message:e,sender:u.userid},t||function(){})})},l.onUserLeft=function(e){u.deletePeer(e)},l.disconnectWith=function(e,n){u.socket&&u.socket.emit("disconnect-with",e,n||function(){}),u.deletePeer(e)},u.broadcasters=[],u.socketOptions={transport:"polling"},u.openOrJoin=function(s,d){u.checkPresence(s,function(e,n){if("function"==typeof d&&(d(e,n),d=null),e){u.sessionid=n;var t,i,o=!!u.session.oneway,r=h(u.session);i={OfferToReceiveAudio:u.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:u.sdpConstraints.mandatory.OfferToReceiveVideo},t={OfferToReceiveAudio:o?!!u.session.audio:u.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:o?!!u.session.video||!!u.session.screen:u.sdpConstraints.mandatory.OfferToReceiveVideo};var a={remoteUserId:u.sessionid,message:{newParticipationRequest:!0,isOneWay:o,isDataOnly:r,localPeerSdpConstraints:t,remotePeerSdpConstraints:i},sender:u.userid,password:d||!1};l.onNegotiationNeeded(a)}else u.userid,u.userid=u.sessionid=s||u.sessionid,u.userid+="",u.socket.emit("changed-uuid",u.userid),d&&u.socket.emit("set-password",d),u.isInitiator=!0,h(u.session)||u.captureUserMedia()})},u.open=function(e,n){return u.userid,u.userid=u.sessionid=e||u.sessionid,u.userid+="",u.isInitiator=!0,c(function(){u.socket.emit("changed-uuid",u.userid),1==n&&u.becomePublicModerator()}),h(u.session)?void("function"==typeof n&&n()):void u.captureUserMedia("function"==typeof n?n:null)},u.becomePublicModerator=function(){u.isInitiator&&u.socket.emit("become-a-public-moderator")},u.dontMakeMeModerator=function(){u.socket.emit("dont-make-me-moderator")},u.deletePeer=function(n){if(n){if(u.onleave({userid:n,extra:u.peers[n]?u.peers[n].extra:{}}),u.peers[n]){u.peers[n].streams.forEach(function(e){e.stop()});var e=u.peers[n].peer;if(e&&"closed"!==e.iceConnectionState)try{e.close()}catch(e){}u.peers[n]&&(u.peers[n].peer=null,delete u.peers[n])}if(-1!==u.broadcasters.indexOf(n)){var t=[];u.broadcasters.forEach(function(e){e!==n&&t.push(e)}),u.broadcasters=t,o()}}},u.rejoin=function(e){if(!u.isInitiator&&e&&Object.keys(e).length){var n={};u.peers[e.remoteUserId]&&(n=u.peers[e.remoteUserId].extra,u.deletePeer(e.remoteUserId)),e&&e.remoteUserId&&(u.join(e.remoteUserId),u.onReConnecting({userid:e.remoteUserId,extra:n}))}},u.join=u.connect=function(e,n){u.sessionid=!!e&&(e.sessionid||e.remoteUserId||e)||u.sessionid,u.sessionid+="";var t=!1,i=!1,o=!1,r=!1;if(e&&e.session||!e||"string"==typeof e){var a=e&&e.session||u.session;o=!!a.oneway,r=h(a),i={OfferToReceiveAudio:u.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:u.sdpConstraints.mandatory.OfferToReceiveVideo},t={OfferToReceiveAudio:o?!!u.session.audio:u.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:o?!!u.session.video||!!u.session.screen:u.sdpConstraints.mandatory.OfferToReceiveVideo}}var s=function(){};"function"==typeof(n=n||{})&&(s=n,n={}),void 0!==n.localPeerSdpConstraints&&(t=n.localPeerSdpConstraints),void 0!==n.remotePeerSdpConstraints&&(i=n.remotePeerSdpConstraints),void 0!==n.isOneWay&&(o=n.isOneWay),void 0!==n.isDataOnly&&(r=n.isDataOnly);var d={remoteUserId:u.sessionid,message:{newParticipationRequest:!0,isOneWay:o,isDataOnly:r,localPeerSdpConstraints:t,remotePeerSdpConstraints:i},sender:u.userid,password:!1};return c(function(){u.peers[u.sessionid]||(l.onNegotiationNeeded(d),s())}),d},u.connectWithAllParticipants=function(e){l.onNegotiationNeeded("connectWithAllParticipants",e||u.sessionid)},u.removeFromBroadcastersList=function(e){l.onNegotiationNeeded("removeFromBroadcastersList",e||u.sessionid),u.peers.getAllParticipants(e||u.sessionid).forEach(function(e){l.onNegotiationNeeded("dropPeerConnection",e),u.deletePeer(e)}),u.attachStreams.forEach(function(e){e.stop()})},u.getUserMedia=u.captureUserMedia=function(i,o){i=i||function(){};var r=o||u.session;return u.dontCaptureUserMedia||h(r)?void i():void((r.audio||r.video||r.screen)&&(r.screen?u.getScreenConstraints(function(e,n){if(e)throw e;u.invokeGetUserMedia({audio:!!S(u)&&C(n),video:n,isScreen:!0},function(e){if(!r.audio&&!r.video||S(u))i(e);else{var n={};for(var t in r)"screen"!==t&&(n[t]=r[t]);u.invokeGetUserMedia(o,i,n)}})}):(r.audio||r.video)&&u.invokeGetUserMedia(o,i,r)))},u.closeBeforeUnload=!0,window.addEventListener("beforeunload",t,!1),u.userid=p(),u.changeUserId=function(e,n){u.userid=e||p(),u.socket.emit("changed-uuid",u.userid,n||function(){})},u.extra={},u.attachStreams=[],u.session={audio:!0,video:!0},u.enableFileSharing=!1,u.bandwidth={screen:512,audio:128,video:512},u.codecs={audio:"opus",video:"VP9"},u.processSdp=function(e){return O||R||(e=W.setApplicationSpecificBandwidth(e,u.bandwidth,!!u.session.screen),e=W.setVideoBitrates(e,{min:8*u.bandwidth.video*1024,max:8*u.bandwidth.video*1024}),e=W.setOpusAttributes(e,{maxaveragebitrate:8*u.bandwidth.audio*1024,maxplaybackrate:8*u.bandwidth.audio*1024,stereo:1,maxptime:3}),"VP9"===u.codecs.video&&(e=W.preferVP9(e)),"H264"===u.codecs.video&&(e=W.removeVPX(e)),"G722"===u.codecs.audio&&(e=W.removeNonG722(e))),e},void 0!==W&&(u.BandwidthHandler=u.CodecsHandler=W),u.mediaConstraints={audio:{mandatory:{},optional:[{bandwidth:8*u.bandwidth.audio*1024||1048576}]},video:{mandatory:{},optional:[{bandwidth:8*u.bandwidth.video*1024||1048576},{facingMode:"user"}]}},R&&(u.mediaConstraints={audio:!0,video:!0}),n.useDefaultDevices||O||DetectRTC.load(function(){var n,t;if(DetectRTC.MediaDevices.forEach(function(e){"audioinput"===e.kind&&!1!==u.mediaConstraints.audio&&(n=e),"videoinput"===e.kind&&!1!==u.mediaConstraints.video&&(t=e)}),n){if(R)return void(!0!==u.mediaConstraints.audio?u.mediaConstraints.audio.deviceId=n.id:u.mediaConstraints.audio={deviceId:n.id});1==u.mediaConstraints.audio&&(u.mediaConstraints.audio={mandatory:{},optional:[]}),u.mediaConstraints.audio.optional||(u.mediaConstraints.audio.optional=[]);var e=[{sourceId:n.id}];u.mediaConstraints.audio.optional=e.concat(u.mediaConstraints.audio.optional)}if(t){if(R)return void(!0!==u.mediaConstraints.video?u.mediaConstraints.video.deviceId=t.id:u.mediaConstraints.video={deviceId:t.id});1==u.mediaConstraints.video&&(u.mediaConstraints.video={mandatory:{},optional:[]}),u.mediaConstraints.video.optional||(u.mediaConstraints.video.optional=[]),e=[{sourceId:t.id}],u.mediaConstraints.video.optional=e.concat(u.mediaConstraints.video.optional)}}),u.sdpConstraints={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0},optional:[{VoiceActivityDetection:!1}]},u.optionalArgument={optional:[{DtlsSrtpKeyAgreement:!0},{googImprovedWifiBwe:!0},{googScreencastMinBitrate:300},{googIPv6:!0},{googDscp:!0},{googCpuUnderuseThreshold:55},{googCpuOveruseThreshold:85},{googSuspendBelowMinBitrate:!0},{googCpuOveruseDetection:!0}],mandatory:{}},u.iceServers=G.getIceServers(u),u.candidates={host:!0,stun:!0,turn:!0},u.iceProtocols={tcp:!0,udp:!0},u.onopen=function(e){u.enableLogs&&webrtcdev.info("Data connection has been opened between you & ",e.userid)},u.onclose=function(e){u.enableLogs&&webrtcdev.warn("Data connection has been closed between you & ",e.userid)},u.onerror=function(e){webrtcdev.log("========================",e),u.enableLogs&&webrtcdev.error(e.userid,"data-error",e)},u.onmessage=function(e){u.enableLogs&&webrtcdev.debug("data-message",e.userid,e.data)},u.send=function(e,n){webrtcdev.log("connection send -> connection.peers",u.peers),u.peers.send(e,n)},u.close=u.disconnect=u.leave=function(){t(0,!0)},u.closeEntireSession=function(n){n=n||function(){},u.socket.emit("close-entire-session",function e(){return u.getAllParticipants().length?void setTimeout(e,100):(u.onEntireSessionClosed({sessionid:u.sessionid,userid:u.userid,extra:u.extra}),void u.changeUserId(null,function(){u.close(),n()}))})},u.onEntireSessionClosed=function(e){u.enableLogs&&webrtcdev.info("Entire session is closed: ",e.sessionid,e.extra)},u.onstream=function(e){var n=u.videosContainer;n.insertBefore(e.mediaElement,n.firstChild),e.mediaElement.play(),setTimeout(function(){e.mediaElement.play()},5e3)},u.onstreamended=function(e){e.mediaElement||(e.mediaElement=document.getElementById(e.streamid)),e.mediaElement&&e.mediaElement.parentNode&&e.mediaElement.parentNode.removeChild(e.mediaElement)},u.direction="many-to-many",u.removeStream=function(n){var t;return u.attachStreams.forEach(function(e){e.id===n&&(t=e)}),t?(u.peers.getAllParticipants().forEach(function(e){var n=u.peers[e];try{n.peer.removeStream(t)}catch(e){}}),void u.renegotiate()):void webrtcdev.warn("No such stream exists.",n)},u.addStream=function(t,n){function i(e){t.streamCallback&&t.streamCallback(e),u.renegotiate(n)}return t.getAudioTracks?(-1===u.attachStreams.indexOf(t)&&(t.streamid||(t.streamid=t.id),u.attachStreams.push(t)),void u.renegotiate(n)):h(t)?void u.renegotiate(n):void((t.audio||t.video||t.screen)&&(t.screen?u.getScreenConstraints(function(e,n){return e?alert(e):void u.invokeGetUserMedia({audio:!!S(u)&&C(n),video:n,isScreen:!0},!t.audio&&!t.video||S(u)?i:u.invokeGetUserMedia(null,i))}):(t.audio||t.video)&&u.invokeGetUserMedia(null,i)))},u.invokeGetUserMedia=function(t,i,e){e||(e=u.session),t||(t=u.mediaConstraints),y({onGettingLocalMedia:function(e){var n=t.video;n&&(n.mediaSource||n.mozMediaSource?e.isScreen=!0:n.mandatory&&n.mandatory.chromeMediaSource&&(e.isScreen=!0)),e.isScreen||(e.isVideo=e.getVideoTracks().length,e.isAudio=!e.isVideo&&e.getAudioTracks().length),l.onGettingLocalMedia(e),i&&i(e)},onLocalMediaError:function(e,n){l.onLocalMediaError(e,n)},localMediaConstraints:t||{audio:!!e.audio&&t.audio,video:!!e.video&&t.video}})},u.applyConstraints=function(n,e){if(j&&j.prototype.applyConstraints){var t;if(e)return u.streamEvents[e]&&(t=u.streamEvents[e].stream),void i(t,n);u.attachStreams.forEach(function(e){i(e,n)})}else alert("track.applyConstraints is NOT supported in your browser.")},u.replaceTrack=function(t,n,i){function o(e){u.replaceTrack(e,n,i||t.video||t.screen)}if(t=t||{},L.prototype.getSenders)if(t instanceof j)r(t,n,i);else{if(t instanceof D)return t.getVideoTracks().length&&r(t.getVideoTracks()[0],n,!0),void(t.getAudioTracks().length&&r(t.getAudioTracks()[0],n,!1));if(h(t))throw"connection.replaceTrack requires audio and/or video and/or screen.";(t.audio||t.video||t.screen)&&(t.screen?u.getScreenConstraints(function(e,n){return e?alert(e):void u.invokeGetUserMedia({audio:!!S(u)&&C(n),video:n,isScreen:!0},!t.audio&&!t.video||S(u)?o:u.invokeGetUserMedia(null,o))}):(t.audio||t.video)&&u.invokeGetUserMedia(null,o))}else u.addStream(t)},u.resetTrack=function(e,t){e||(e=u.getAllParticipants()),"string"==typeof e&&(e=[e]),e.forEach(function(e){var n=u.peers[e].peer;void 0!==t&&!0!==t||!n.lastVideoTrack||u.replaceTrack(n.lastVideoTrack,e,!0),void 0!==t&&!1!==t||!n.lastAudioTrack||u.replaceTrack(n.lastAudioTrack,e,!1)})},u.renegotiate=function(e){return e?void l.renegotiatePeer(e):void u.peers.getAllParticipants().forEach(function(e){l.renegotiatePeer(e)})},u.setStreamEndHandler=function(n,t){n&&n.addEventListener&&(t=!!t,n.alreadySetEndHandler||(n.alreadySetEndHandler=!0,n.addEventListener("ended",function(){n.idInstance&&q.remove(n.idInstance),t||delete u.attachStreams[u.attachStreams.indexOf(n)];var e=u.streamEvents[n.streamid];e||(e={stream:n,streamid:n.streamid,type:t?"remote":"local",userid:u.userid,extra:u.extra,mediaElement:u.streamEvents[n.streamid]?u.streamEvents[n.streamid].mediaElement:null}),(e.userid!==u.userid||"remote"!==e.type)&&(u.onstreamended(e),delete u.streamEvents[n.streamid])},!1)))},u.onMediaError=function(e,n){u.enableLogs&&webrtcdev.error(e,n)},u.addNewBroadcaster=function(e,n){u.broadcasters.length&&setTimeout(function(){l.connectNewParticipantWithAllBroadcasters(e,n,u.broadcasters.join("|-,-|"))},1e4),u.session.oneway||u.session.broadcast||"many-to-many"!==u.direction||-1!==u.broadcasters.indexOf(e)||(u.broadcasters.push(e),o())},u.autoCloseEntireSession=!1,u.filesContainer=u.videosContainer=document.body||document.documentElement,u.isInitiator=!1,u.shareFile=l.shareFile,void 0!==J&&J.handle(u),void 0!==$&&$.handle(u),u.token=p,u.onNewParticipant=function(e,n){u.acceptParticipationRequest(e,n)},u.acceptParticipationRequest=function(e,n){n.successCallback&&(n.successCallback(),delete n.successCallback),l.createNewPeer(e,n)},u.onShiftedModerationControl=function(e,n){u.acceptModerationControl(e,n)},u.acceptModerationControl=function(n,e){u.isInitiator=!0,u.broadcasters=e,u.peers.getAllParticipants().forEach(function(e){l.onNegotiationNeeded({changedUUID:n,oldUUID:u.userid,newUUID:n},e)}),u.userid=n,u.socket.emit("changed-uuid",u.userid)},u.shiftModerationControl=function(e,n,t){l.onNegotiationNeeded({shiftedModerationControl:!0,broadcasters:n,firedOnLeave:!!t},e)},void 0!==z&&(u.StreamsHandler=z),u.onleave=function(e){},u.invokeSelectFileDialog=function(e){(new FileSelector).selectSingleFile(e)},u.getPublicModerators=function(e,n){"function"==typeof e&&(n=e),c(function(){u.socket.emit("get-public-moderators","string"==typeof e?e:"",n)})},u.onmute=function(e){e&&e.mediaElement&&("both"===e.muteType||"video"===e.muteType?(e.mediaElement.src=null,e.mediaElement.pause(),e.mediaElement.poster=e.snapshot||"https://cdn.webrtc-experiment.com/images/muted.png"):"audio"===e.muteType&&(e.mediaElement.muted=!0))},u.onunmute=function(e){e&&e.mediaElement&&e.stream&&("both"===e.unmuteType||"video"===e.unmuteType?(e.mediaElement.poster=null,e.mediaElement.src=URL.createObjectURL(e.stream),e.mediaElement.play()):"audio"===e.unmuteType&&(e.mediaElement.muted=!1))},u.onExtraDataUpdated=function(e){e.status="online",u.onUserStatusChanged(e,!0)},u.onJoinWithPassword=function(e){webrtcdev.warn(e,"is password protected. Please join with password.")},u.onInvalidPassword=function(e,n){webrtcdev.warn(e,"is password protected. Please join with valid password. Your old password",n,"is wrong.")},u.onPasswordMaxTriesOver=function(e){webrtcdev.warn(e,"is password protected. Your max password tries exceeded the limit.")},u.getAllParticipants=function(e){return u.peers.getAllParticipants(e)},void 0!==z&&(z.onSyncNeeded=function(n,t,i){u.peers.getAllParticipants().forEach(function(e){l.onNegotiationNeeded({streamid:n,action:t,streamSyncNeeded:!0,type:i||"both"},e)})}),u.connectSocket=function(e){c(e)},u.socketAutoReConnect=!0,u.closeSocket=function(){try{io.sockets={}}catch(e){}u.socket&&(u.socketAutoReConnect=!1,"function"==typeof u.socket.disconnect&&u.socket.disconnect(),u.socket=null)},u.getSocket=function(e){return u.socket?e&&e(u.socket):c(e),u.socket},u.getRemoteStreams=l.getRemoteStreams;var a=["selectFirst","selectAll","forEach"];if(u.streamEvents={selectFirst:function(e){if(!e){var n;for(var t in u.streamEvents)-1!==a.indexOf(t)||n||(n=u.streamEvents[t]);return n}},selectAll:function(){}},u.socketURL="/",u.socketMessageEvent="RTCMultiConnection-Message",u.socketCustomEvent="RTCMultiConnection-Custom-Message",u.DetectRTC=DetectRTC,u.setCustomSocketEvent=function(e){e&&(u.socketCustomEvent=e),u.socket&&u.socket.emit("set-custom-socket-event-listener",u.socketCustomEvent)},u.getNumberOfBroadcastViewers=function(e,n){u.socket&&e&&n&&u.socket.emit("get-number-of-users-in-specific-broadcast",e,n)},u.onNumberOfBroadcastViewersUpdated=function(e){u.enableLogs&&u.isInitiator&&webrtcdev.info("Number of broadcast (",e.broadcastId,") viewers",e.numberOfBroadcastViewers)},u.onUserStatusChanged=function(e,n){u.enableLogs&&!n&&webrtcdev.info(e.userid,e.status)},u.getUserMediaHandler=y,u.multiPeersHandler=l,u.enableLogs=!0,u.setCustomSocketHandler=function(e){void 0!==d&&(d=e)},u.chunkSize=65e3,u.maxParticipantsAllowed=50,u.disconnectWith=l.disconnectWith,u.checkPresence=function(e,n){return u.socket?void u.socket.emit("check-presence",(e||u.sessionid)+"",n):void u.connectSocket(function(){u.checkPresence(e,n)})},u.onReadyForOffer=function(e,n){u.multiPeersHandler.createNewPeer(e,n)},u.setUserPreferences=function(e){return u.dontAttachStream&&(e.dontAttachLocalStream=!0),u.dontGetRemoteStream&&(e.dontGetRemoteStream=!0),e},u.updateExtraData=function(){u.socket.emit("extra-data-updated",u.extra)},u.enableScalableBroadcast=!1,u.maxRelayLimitPerUser=3,u.dontCaptureUserMedia=!1,u.dontAttachStream=!1,u.dontGetRemoteStream=!1,u.onReConnecting=function(e){u.enableLogs&&webrtcdev.info("ReConnecting with",e.userid,"...")},u.beforeAddingStream=function(e){return e},u.beforeRemovingStream=function(e){return e},void 0!==k&&(u.checkIfChromeExtensionAvailable=k),void 0!==T&&(u.checkIfChromeExtensionAvailable=T),void 0!==P&&(u.getChromeExtensionStatus=P),u.getScreenConstraints=function(t,e){var i,o;S(u,e)&&(e=!0),i=function(e,n){e||(n=u.modifyScreenConstraints(n),t(e,n))},o=e,R?i(null,{mozMediaSource:"window",mediaSource:"window",width:29999,height:8640}):k(function(e){var n={mandatory:{chromeMediaSource:_,maxWidth:29999,maxHeight:8640,minFrameRate:30,maxFrameRate:128,minAspectRatio:1.77},optional:[]};return"desktop"!=_||H?("desktop"==_&&(n.mandatory.chromeMediaSourceId=H),void i(null,n)):void getSourceId(function(){n.mandatory.chromeMediaSourceId=H,i("PermissionDeniedError"==H?H:null,n),H=null},o)})},u.modifyScreenConstraints=function(e){return e},u.onPeerStateChanged=function(e){u.enableLogs&&-1!==e.iceConnectionState.search(/closed|failed/gi)&&webrtcdev.error("Peer connection is closed between you & ",e.userid,e.extra,"state:",e.iceConnectionState)},u.isOnline=!0,w("online",function(){u.isOnline=!0}),w("offline",function(){u.isOnline=!1}),u.isLowBandwidth=!1,navigator&&navigator.connection&&navigator.connection.type&&(u.isLowBandwidth=-1!==navigator.connection.type.toString().toLowerCase().search(/wifi|cell/g),u.isLowBandwidth)){if(u.bandwidth={audio:30,video:30,screen:30},u.mediaConstraints.audio&&u.mediaConstraints.audio.optional&&u.mediaConstraints.audio.optional.length){var s=[];u.mediaConstraints.audio.optional.forEach(function(e){void 0===e.bandwidth&&s.push(e)}),u.mediaConstraints.audio.optional=s}u.mediaConstraints.video&&u.mediaConstraints.video.optional&&u.mediaConstraints.video.optional.length&&(s=[],u.mediaConstraints.video.optional.forEach(function(e){void 0===e.bandwidth&&s.push(e)}),u.mediaConstraints.video.optional=s)}u.getExtraData=function(e){if(!e)throw"remoteUserId is required.";return u.peers[e]?u.peers[e].extra:{}},n.autoOpenOrJoin&&u.openOrJoin(u.sessionid),u.onUserIdAlreadyTaken=function(e,n){u.enableLogs&&webrtcdev.warn("Userid already taken.",e,"Your new userid:",n),u.join(e)},u.trickleIce=!0,u.onSettingLocalDescription=function(e){u.enableLogs&&webrtcdev.info("Set local description for remote user",e.userid)}}}();
"";var sourceId,screen_constraints,screenStreamId,scrConn,screenCallback,signaler,screen,screenRoomid,screenShareButton,chromeMediaSource="screen",isFirefox=void 0!==window.InstallTrigger,isOpera=!!window.opera||0<=navigator.userAgent.indexOf(" OPR/"),isChrome=!!window.chrome&&!isOpera,isMobileDevice=!!navigator.userAgent.match(/Android|iPhone|iPad|iPod|BlackBerry|IEMobile/i),iceServers=[],screenShareStreamLocal=null;function getSourceId(e,n){if(!e)throw'"callback" parameter is mandatory.';window.postMessage("webrtcdev-extension-getsourceId","*")}function getChromeExtensionStatus(n,t){if(2!=arguments.length&&(t=n,n=window.RMCExtensionID||"ajhifddimkapgcifgcodmmfdlknahffk"),isFirefox)return t("not-chrome");if(!n)return t("Null extensionID");try{var e=document.createElement("img");e.src="chrome-extension://"+n+"/icon.png",e.onload=function(){webrtcdev.info("screenshare extension ",e.src),chromeMediaSource="screen",window.postMessage("webrtcdev-extension-presence","*"),setTimeout(function(){t("screen"==chromeMediaSource?n==n?"installed-enabled":"installed-disabled":"installed-enabled")},2e3)},e.onerror=function(){webrtcdev.error("No screenshare extension ",e.src),t("not-installed")}}catch(e){webrtcdev.error("Screenshare extension image not found chrome-extension://",n,"/icon.png",e),t("not-installed")}}function isChromeExtensionAvailable(e){if(e){if(isFirefox)return isFirefoxExtensionAvailable(e);if("desktop"==chromeMediaSource)return e(!0);window.postMessage("webrtcdev-extension-presence","*"),setTimeout(function(){e("screen"!=chromeMediaSource)},2e3)}}function webrtcdevPrepareScreenShare(e){var n=(new Date).getUTCMilliseconds();null==screenRoomid&&(screenRoomid="screenshare_"+sessionid+"_"+n),webrtcdev.log(" webrtcdevPrepareScreenShare"+screenRoomid),webrtcdev.log(" Screenshare ||  filling up iceServers ",turn,webrtcdevIceServers),scrConn=new RTCMultiConnection,turn&&"none"!=turn&&(webrtcdevIceServers||alert("ICE server not found yet in screenshare session "),scrConn.iceServers=webrtcdevIceServers),scrConn.channel=screenRoomid,scrConn.socketURL=socketAddr,scrConn.session={screen:!0,oneway:!0},scrConn.sdpConstraints.mandatory={OfferToReceiveAudio:!1,OfferToReceiveVideo:!0},scrConn.dontCaptureUserMedia=!1,scrConn.onMediaError=function(e,n){webrtcdev.error(e,n),shownotificationWarning(e.name)},scrConn.onstream=function(e){if(webrtcdev.log(" on stream in _screenshare :",e),"remote"==e.type&&"local"!=e.type){e.userid,e.type;var n=e.stream;e.stream.streamid?(webrtcdev.log("remote screen event.stream.streamId "+e.stream.streamId),screenStreamId=e.stream.streamid):e.streamid&&(webrtcdev.log("remote screen event.streamid "+e.streamid),screenStreamId=e.streamid);var t=document.createElement("video");attachMediaStream(t,n),document.getElementById(screenshareobj.screenshareContainer).appendChild(t),document.getElementById(screenshareobj.screenshareContainer).hidden=!1,rtcConn.send({type:"screenshare",screenid:screenRoomid,message:"screenshareStartedViewing"})}else webrtcdev.log("started streaming local screen"),rtcConn.send({type:"screenshare",screenid:screenRoomid,screenStreamid:screenStreamId,message:"startscreenshare"});onScreenShareStarted()},scrConn.onstreamended=function(e){e&&webrtcdev.log(" onstreamended in _screenshare :",e),document.getElementById(screenshareobj.screenshareContainer)&&(document.getElementById(screenshareobj.screenshareContainer).innerHTML=""),scrConn.removeStream(screenStreamId),screenShareButton&&(screenShareButton.className=screenshareobj.button.shareButton.class_off,screenShareButton.innerHTML=screenshareobj.button.shareButton.html_off)},webrtcdev.log(" webrtcdevscreenshare calling callback for socket.io operations"),alert(" Preparing Screenshare "+screenRoomid),setTimeout(e(screenRoomid),3e3),onScreenShareSEnded()}function webrtcdevSharescreen(){webrtcdev.log("webrtcdevSharescreen . screenRoomid = ",screenRoomid),webrtcdevPrepareScreenShare(function(n){var t="temp_"+(new Date).getUTCMilliseconds();scrConn.dontCaptureUserMedia=!1,scrConn.open(n,function(){webrtcdev.log("Event : open-channel-screenshare"),socket.emit("open-channel-screenshare",{channel:n,sender:t,maxAllowed:6}),shownotification(" Making a new session for screenshare"+n)}),socket.on("open-channel-screenshare-resp",function(e){webrtcdev.log("Event Handler : open-channel-screenshare",e),e&&connectScrWebRTC("open",n,t,[])})}),webrtcdev.log("webrtcdevscreenshare . srcConn = ",scrConn," | rtcConn = ",rtcConn)}function connectScrWebRTC(e,n,t,r){webrtcdev.log("connectScrWebRTC -> ",e,n,t,r),"open"==e?(scrConn.connect(screenRoomid),shownotification("Connected to "+screenRoomid+" for screenshare ")):"join"==e?(scrConn.join(screenRoomid),shownotification("Connected with existing Screenshare channel "+screenRoomid)):shownotification("Connection type not found for Screenshare ")}function webrtcdevScreenConstraints(e){webrtcdev.log(" webrtcdevScreenConstraints  - chromeMediaSourceId: ",e),screen_constraints={audio:!1,video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxWidth:1920<window.screen.width?window.screen.width:1920,maxHeight:1080<window.screen.height?window.screen.height:1080},optional:[]}};try{webrtcdev.log(" screen getusermedia "),navigator.getUserMedia(screen_constraints,function(e){webrtcdev.log("screen stream ",e,screenshareobj.screenshareContainer);var n=e;screenShareStreamLocal=e,webrtcdev.log("Stream from getUserMedia",n),n.type="local",getRMCMediaElement(n,function(e){webrtcdev.log(" getRMCMediaElement Callback function --\x3e "+n.streamid+" .. "+n.id),n.streamid?(webrtcdev.log("using streamid"),e.id=n.streamid,e.muted=!0,e.volume=0,-1===scrConn.attachStreams.indexOf(n)&&scrConn.attachStreams.push(n),"undefined"!=typeof StreamsHandler&&StreamsHandler.setHandlers(n,!0,scrConn),scrConn.streamEvents[n.streamid]={stream:n,type:"local",mediaElement:e,userid:scrConn.userid,extra:scrConn.extra,streamid:n.streamid,blobURL:e.src||URL.createObjectURL(n),isAudioMuted:!0},scrConn.onstream(scrConn.streamEvents[n.streamid])):n.id?(webrtcdev.log("using id"),e.id=n.id,e.muted=!0,e.volume=0,-1===scrConn.attachStreams.indexOf(n)&&scrConn.attachStreams.push(n),"undefined"!=typeof StreamsHandler&&StreamsHandler.setHandlers(n,!0,scrConn),scrConn.streamEvents[n.id]={stream:n,type:"local",mediaElement:e,userid:scrConn.userid,extra:scrConn.extra,streamid:n.id,blobURL:e.src||URL.createObjectURL(n),isAudioMuted:!0},webrtcdev.log(scrConn.streamEvents[n.id]),scrConn.onstream(scrConn.streamEvents[n.id])):alert("screenshare has neither streamid not id")},scrConn)},function(e){webrtcdev.error(" Error in webrtcdevScreenConstraints ",e),isChrome&&"http:"===location.protocol?alert("Please test this WebRTC experiment on HTTPS."):isChrome?alert("Screen capturing is either denied or not supported. Please install chrome extension for screen capturing or run chrome with command-line flag: --enable-usermedia-screen-capturing"):navigator.mozGetUserMedia&&alert(Firefox_Screen_Capturing_Warning)})}catch(e){webrtcdev.log(" Error in webrtcdevScreenConstraints ",err)}}function getRMCMediaElement(t,e,r){webrtcdev.log(" getRMCMediaElement ",t,r);var n=!1;t.getVideoTracks&&!t.getVideoTracks().length&&(n=!0);var o=document.createElement(n?"audio":"video");return o.src=t,o.controls=!0,isFirefox&&o.addEventListener("ended",function(){if(currentUserMediaRequest.remove(t.idInstance),"local"===t.type){StreamsHandler.onSyncNeeded(t.streamid,"ended"),r.attachStreams.forEach(function(e,n){t.streamid===e.streamid&&delete r.attachStreams[n]});var n=[];r.attachStreams.forEach(function(e){e&&n.push(e)}),r.attachStreams=n;var e=r.streamEvents[t.streamid];if(e)return void r.onstreamended(e);this.parentNode&&this.parentNode.removeChild(this)}},!1),o.play(),void e(o)}function webrtcdevViewscreen(e){scrConn.join(e)}function webrtcdevStopShareScreen(){try{screenshareobj.screenshareContainer&&(document.getElementById(screenshareobj.screenshareContainer).innerHTML=""),rtcConn.send({type:"screenshare",screenid:screenRoomid,screenStreamid:screenStreamId,message:"stoppedscreenshare"}),window.postMessage("webrtcdev-extension-stopsource","*"),scrConn.onstreamended(),scrConn.close(),scrConn.closeEntireSession(),webrtcdev.log("Sender stopped: screenRoomid "+screenRoomid+" || Screen stoppped ",scrConn,document.getElementById(screenshareobj.screenshareContainer)),screenShareStreamLocal&&(screenShareStreamLocal.stop(),screenShareStreamLocal=null)}catch(e){webrtcdev.error(e)}}function createOrAssignScreenviewButton(){screenshareobj.button.viewButton.id&&document.getElementById(screenshareobj.button.viewButton.id)?assignScreenViewButton():createScreenViewButton()}function createScreenViewButton(){if(!document.getElementById("viewScreenShareButton")){var e=document.createElement("span");if(e.className=screenshareobj.button.viewButton.class_off,e.innerHTML=screenshareobj.button.viewButton.html_off,e.id="viewScreenShareButton",webrtcdevViewscreen(screenRoomid),e.onclick=function(){e.className==screenshareobj.button.viewButton.class_off?(document.getElementById(screenshareobj.screenshareContainer).hidden=!1,e.className=screenshareobj.button.viewButton.class_on,e.innerHTML=screenshareobj.button.viewButton.html_on):e.className==screenshareobj.button.viewButton.class_on&&(document.getElementById(screenshareobj.screenshareContainer).hidden=!0,e.className=screenshareobj.button.viewButton.class_off,e.innerHTML=screenshareobj.button.viewButton.html_off)},document.getElementById("topIconHolder_ul")){var n=document.createElement("li");n.appendChild(e),document.getElementById("topIconHolder_ul").appendChild(n)}}}function assignScreenViewButton(){var e=document.getElementById(screenshareobj.button.viewButton.id);webrtcdevViewscreen(screenRoomid),e.onclick=function(){e.className==screenshareobj.button.viewButton.class_off?(document.getElementById(screenshareobj.screenshareContainer).hidden=!1,e.className=screenshareobj.button.viewButton.class_on,e.innerHTML=screenshareobj.button.viewButton.html_on):e.className==screenshareobj.button.viewButton.class_on&&(document.getElementById(screenshareobj.screenshareContainer).hidden=!0,e.className=screenshareobj.button.viewButton.class_off,e.innerHTML=screenshareobj.button.viewButton.html_off)}}function removeScreenViewButton(){if(document.getElementById("viewScreenShareButton")){var e=document.getElementById("viewScreenShareButton");e.parentElement.removeChild(e)}}function createScreenInstallButton(n){var t=document.createElement("span");t.className=screenshareobj.button.installButton.class_off,t.innerHTML=screenshareobj.button.installButton.html_off,t.id="screeninstallButton",t.onclick=function(e){chrome.webstore.install("https://chrome.google.com/webstore/detail/"+n,function(){webrtcdev.log("Chrome extension inline installation - success . createOrAssignScreenshareButton with ",screenshareobj),getSourceId(function(){},t.hidden=!0),createOrAssignScreenshareButton(screenshareobj)},function(e){webrtcdev.log("Chrome extension inline installation - fail ",e)}),e.preventDefault()};var e=document.createElement("li");e.appendChild(t),document.getElementById("topIconHolder_ul").appendChild(e)}function assignScreenInstallButton(n){var t=document.getElementById(screenshareobj.button.installButton.id);t.onclick=function(e){chrome.webstore.install("https://chrome.google.com/webstore/detail/"+n,function(){webrtcdev.log("Chrome extension inline installation - success from assignScreenInstallButton . Now  createOrAssignScreenshareButton with ",screenshareobj),getSourceId(function(){},t.hidden=!0),createOrAssignScreenshareButton(screenshareobj)},function(e){webrtcdev.error("Chrome extension inline installation - fail ",e)}),e.preventDefault()}}function hideScreenInstallButton(){var e=document.getElementById(screenshareobj.button.installButton.id);e.hidden=!0,e.setAttribute("style","display:none")}function createOrAssignScreenshareButton(e){webrtcdev.log("createOrAssignScreenshareButton ",e),e.button.shareButton.id&&document.getElementById(e.button.shareButton.id)?(assignScreenShareButton(),hideScreenInstallButton(),showScreenShareButton()):createScreenShareButton()}function createScreenshareButton(){(screenShareButton=document.createElement("span")).className=screenshareobj.button.shareButton.class_off,screenShareButton.innerHTML=screenshareobj.button.shareButton.html_off,screenShareButton.id="screenShareButton",screenShareButton.onclick=function(e){screenShareButton.className==screenshareobj.button.shareButton.class_off?(webrtcdevSharescreen(),screenShareButton.className=screenshareobj.button.shareButton.class_on,screenShareButton.innerHTML=screenshareobj.button.shareButton.html_on):screenShareButton.className==screenshareobj.button.shareButton.class_on&&(screenShareButton.className=screenshareobj.button.shareButton.class_off,screenShareButton.innerHTML=screenshareobj.button.shareButton.html_off,webrtcdevStopShareScreen())};var e=document.createElement("li");return e.appendChild(screenShareButton),document.getElementById("topIconHolder_ul").appendChild(e),screenShareButton}function assignScreenShareButton(){webrtcdev.log("assignScreenShareButton");var n=document.getElementById(screenshareobj.button.shareButton.id);return n.onclick=function(e){n.className==screenshareobj.button.shareButton.class_off?(webrtcdevSharescreen(),n.className=screenshareobj.button.shareButton.class_on,n.innerHTML=screenshareobj.button.shareButton.html_on):(n.className=screenshareobj.button.shareButton.class_off,n.innerHTML=screenshareobj.button.shareButton.html_off,webrtcdevStopShareScreen())},n}function hideScreenShareButton(){var e=document.getElementById(screenshareobj.button.shareButton.id);e.hidden=!0,e.setAttribute("style","display:none")}function showScreenShareButton(){var e=document.getElementById(screenshareobj.button.shareButton.id);e.removeAttribute("hidden"),e.setAttribute("style","display:block")}function onScreenshareExtensionCallback(e){webrtcdev.log("onScreenshareExtensionCallback",e),e.data.chromeExtensionStatus&&webrtcdev.log(e.data.chromeExtensionStatus),e.data.sourceId&&("PermissionDeniedError"===e.data.sourceId?webrtcdev.error("permission-denied"):webrtcdevScreenConstraints(e.data.sourceId))}function detectExtension(n,t){return webrtcdev.log("detectExtension  ",n),getChromeExtensionStatus(n,function(e){webrtcdev.log("status extension ",e),webrtcdev.log("reset extension ",n),"not-installed"!=e&&window.postMessage("reset-webrtcdev-extension","*"),t(e)})}function showSrcConn(){webrtcdev.log(" srcConn : ",srcConn),webrtcdev.log(" srcConn.peers.getAllParticipants() : ",srcConn.peers.getAllParticipants())}var counterBeforeFailureNotice=0;function screenshareNotification(e,n){if(document.getElementById("alertBox")){if(document.getElementById("alertBox").innerHTML="","screenshareBegin"==n){var t=document.createElement("div");document.getElementById("alertBox").hidden=!1,document.getElementById("alertBox").innerHTML="",t.className="alert alert-info",t.innerHTML='<a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>You have begun sharing screen , waiting for peer to view',document.getElementById("alertBox").appendChild(t),setTimeout(function(){var e=document.createElement("div");document.getElementById("alertBox").hidden=!1,document.getElementById("alertBox").innerHTML="",e.className="alert alert-danger",e.innerHTML='<a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>Peer was not able to view screen , please retry',document.getElementById("alertBox").appendChild(e)},2e4)}else if("screenshareStartedViewing"==n){t=document.createElement("div");document.getElementById("alertBox").hidden=!1,document.getElementById("alertBox").innerHTML="",t.className="alert alert-success",t.innerHTML='<a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>Peer has started viewing screen ',document.getElementById("alertBox").appendChild(t)}else if("screenshareError"==n){t=document.createElement("div");document.getElementById("alertBox").hidden=!1,document.getElementById("alertBox").innerHTML="",t.className="alert alert-danger",t.innerHTML='<a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>There was a error while sharing screen , please contact support ',document.getElementById("alertBox").appendChild(t)}}else alert(e)}function createExtensionInstallWindow(){try{var e=document.createElement("div");e.className="modal fade",e.setAttribute("role","dialog"),e.id="screensharedialog";var n=document.createElement("div");n.className="modal-dialog";var t=document.createElement("div");t.className="modal-content";var r=document.createElement("div");r.className="modal-header";var o=document.createElement("button");o.className="close",o.setAttribute("data-dismiss","modal"),o.innerHTML="&times;";var s=document.createElement("h4");s.className="modal-title",s.innerHTML="Install extension",r.appendChild(s),r.appendChild(o);var a=document.createElement("div");a.className="modal-body";var c=document.createElement("div");c.innerHTML="install screen share extension ";var i=document.createElement("button");if(i.innerHTML=" Install ",i.onclick=function(e){chrome.webstore.install("https://chrome.google.com/webstore/detail/"+screenshareobj.extensionID,function(){webrtcdev.log("Chrome extension inline installation - success from assignScreenInstallButton . Now  createOrAssignScreenshareButton with ",screenshareobj),window.location.reload()},function(e){webrtcdev.error("Chrome extension inline installation - fail ",e)}),e.preventDefault()},a.appendChild(c),a.appendChild(i),t.appendChild(r),t.appendChild(a),n.appendChild(t),e.appendChild(n),document.getElementById("mainDiv"))document.getElementById("mainDiv").appendChild(e),$("#screensharedialog").modal("show")}catch(e){webrtcdev.error("[ createExtensionInstallWindow - Screenshare.js]",e)}}
"";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},WebRTCdetect=function(){var e,i="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";e="undefined"!=typeof global?global:window,"undefined"==typeof window&&("undefined"==typeof window&&"undefined"!=typeof global&&(global.navigator={userAgent:i,getUserMedia:function(){}},e.window=global),"undefined"==typeof document&&(e.document={},document.createElement=document.captureStream=document.mozCaptureStream=function(){return{}}),"undefined"==typeof location&&(e.location={protocol:"file:",href:"",hash:""}),"undefined"==typeof screen&&(e.screen={width:0,height:0}));var a=window.navigator;void 0!==a?(void 0!==a.webkitGetUserMedia&&(a.getUserMedia=a.webkitGetUserMedia),void 0!==a.mozGetUserMedia&&(a.getUserMedia=a.mozGetUserMedia)):a={getUserMedia:function(){},userAgent:i};var n=!!/Android|webOS|iPhone|iPad|iPod|BB10|BlackBerry|IEMobile|Opera Mini|Mobile|mobile/i.test(a.userAgent||""),d=!(-1===a.userAgent.indexOf("Edge")||!a.msSaveOrOpenBlob&&!a.msSaveBlob),c=!!window.opera||0<=a.userAgent.indexOf(" OPR/"),u=void 0!==window.InstallTrigger,w=0<Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor"),p=!!window.chrome&&!c,f=!!document.documentMode&&!d;function r(e,i){var n=0,o=!1,r=window.setInterval(function(){e()&&(window.clearInterval(r),i(o)),50<n++&&(window.clearInterval(r),i(o=!0))},10)}var o={Android:function(){return a.userAgent.match(/Android/i)},BlackBerry:function(){return a.userAgent.match(/BlackBerry|BB10/i)},iOS:function(){return a.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return a.userAgent.match(/Opera Mini/i)},Windows:function(){return a.userAgent.match(/IEMobile/i)},any:function(){return o.Android()||o.BlackBerry()||o.iOS()||o.Opera()||o.Windows()},getOsName:function(){var e="Unknown OS";return o.Android()&&(e="Android"),o.BlackBerry()&&(e="BlackBerry"),o.iOS()&&(e="iOS"),o.Opera()&&(e="Opera Mini"),o.Windows()&&(e="Windows"),e}};var t="Unknown OS",s="Unknown OS Version";if(o.any())t=o.getOsName();else{var m=function(){var e=a.appVersion,i=a.userAgent,n="-",o=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 3.11",r:/Win16/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}];for(var r in o){var t=o[r];if(t.r.test(i)){n=t.s;break}}var s="-";switch(/Windows/.test(n)&&(/Windows (.*)/.test(n)&&(s=/Windows (.*)/.exec(n)[1]),n="Windows"),n){case"Mac OS X":/Mac OS X (10[\.\_\d]+)/.test(i)&&(s=/Mac OS X (10[\.\_\d]+)/.exec(i)[1]);break;case"Android":/Android ([\.\_\d]+)/.test(i)&&(s=/Android ([\.\_\d]+)/.exec(i)[1]);break;case"iOS":/OS (\d+)_(\d+)_?(\d+)?/.test(i)&&(s=(s=/OS (\d+)_(\d+)_?(\d+)?/.exec(e))[1]+"."+s[2]+"."+(0|s[3]))}return{osName:n,osVersion:s}}();t=m.osName,s=m.osVersion}var v=!1,S=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach(function(e){!v&&e in document.createElement("canvas")&&(v=!0),!S&&e in document.createElement("video")&&(S=!0)});var l=[],b=[],C=[],k=[];a.mediaDevices&&a.mediaDevices.enumerateDevices&&(a.enumerateDevices=function(e){a.mediaDevices.enumerateDevices().then(e).catch(function(){e([])})});var h=!1;"undefined"!=typeof MediaStreamTrack&&"getSources"in MediaStreamTrack?h=!0:a.mediaDevices&&a.mediaDevices.enumerateDevices&&(h=!0);var g=!1,O=!1,W=!1,T=!1,M=!1;function y(i){h?(!a.enumerateDevices&&window.MediaStreamTrack&&window.MediaStreamTrack.getSources&&(a.enumerateDevices=window.MediaStreamTrack.getSources.bind(window.MediaStreamTrack)),!a.enumerateDevices&&a.enumerateDevices&&(a.enumerateDevices=a.enumerateDevices.bind(a)),a.enumerateDevices?(l=[],b=[],C=[],k=[],a.enumerateDevices(function(e){e.forEach(function(e){var i,n={};for(var o in e)n[o]=e[o];"audio"===n.kind&&(n.kind="audioinput"),"video"===n.kind&&(n.kind="videoinput"),l.forEach(function(e){e.id===n.id&&e.kind===n.kind&&(i=!0)}),i||(n.deviceId||(n.deviceId=n.id),n.id||(n.id=n.deviceId),n.label?("videoinput"!==n.kind||M||(M=!0),"audioinput"!==n.kind||T||(T=!0)):(n.label="Please invoke getUserMedia once.","https:"!==location.protocol&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(n.label="HTTPs is required to get label of this "+n.kind+" device.")),"audioinput"===n.kind&&(g=!0,-1===b.indexOf(n)&&b.push(n)),"audiooutput"===n.kind&&(O=!0,-1===C.indexOf(n)&&C.push(n)),"videoinput"===n.kind&&(W=!0,-1===k.indexOf(n)&&k.push(n)),-1===l.indexOf(n)&&l.push(n))}),void 0!==P&&(P.MediaDevices=l,P.hasMicrophone=g,P.hasSpeakers=O,P.hasWebcam=W,P.isWebsiteHasWebcamPermissions=M,P.isWebsiteHasMicrophonePermissions=T,P.audioInputDevices=b,P.audioOutputDevices=C,P.videoInputDevices=k),i&&i()})):i&&i()):i&&i()}y();var P=window.DetectRTC||{};P.browser=function(){a.appVersion;var e,i,n,o=a.userAgent,r=a.appName,t=""+parseFloat(a.appVersion),s=parseInt(a.appVersion,10);if(c){r="Opera";try{s=(t=a.userAgent.split("OPR/")[1].split(" ")[0]).split(".")[0]}catch(e){t="0.0.0.0",s=0}}else f?(i=o.indexOf("MSIE"),r="IE",t=o.substring(i+5)):p?(i=o.indexOf("Chrome"),r="Chrome",t=o.substring(i+7)):w?(i=o.indexOf("Safari"),r="Safari",t=o.substring(i+7),-1!==(i=o.indexOf("Version"))&&(t=o.substring(i+8))):u?(i=o.indexOf("Firefox"),r="Firefox",t=o.substring(i+8)):(e=o.lastIndexOf(" ")+1)<(i=o.lastIndexOf("/"))&&(r=o.substring(e,i),t=o.substring(i+1),r.toLowerCase()===r.toUpperCase()&&(r=a.appName));return d&&(r="Edge",t=parseInt(a.userAgent.match(/Edge\/(\d+).(\d+)$/)[2],10).toString()),-1!==(n=t.indexOf(";"))&&(t=t.substring(0,n)),-1!==(n=t.indexOf(" "))&&(t=t.substring(0,n)),s=parseInt(""+t,10),isNaN(s)&&(t=""+parseFloat(a.appVersion),s=parseInt(a.appVersion,10)),{fullVersion:t,version:s,name:r,isPrivateBrowsing:!1}}(),function(i){var n;if(window.webkitRequestFileSystem)window.webkitRequestFileSystem(window.TEMPORARY,1,function(){n=!1},function(e){webrtcdev.log(e),n=!0});else if(window.indexedDB&&/Firefox/.test(window.navigator.userAgent)){var o;try{o=window.indexedDB.open("test")}catch(e){n=!0}void 0===n&&r(function(){return"done"===o.readyState},function(e){e||(n=!o.result)})}else if(function(e){var i=e.toLowerCase();if(0===i.indexOf("msie")&&0===i.indexOf("trident"))return!1;var n=/(?:msie|rv:)\s?([\d\.]+)/.exec(i);return!!(n&&10<=parseInt(n[1],10))}(window.navigator.userAgent)){n=!1;try{window.indexedDB||(n=!0)}catch(e){n=!0}}else if(window.localStorage&&/Safari/.test(window.navigator.userAgent)){try{window.localStorage.setItem("test",1)}catch(e){n=!0}void 0===n&&(n=!1,window.localStorage.removeItem("test"))}r(function(){return void 0!==n},function(e){i(n)})}(function(e){P.browser.isPrivateBrowsing=!!e}),P.browser["is"+P.browser.name]=!0;window.process&&"object"===_typeof(window.process)&&window.process.versions&&window.process.versions["node-webkit"];var x=!1;["RTCPeerConnection","webkitRTCPeerConnection","mozRTCPeerConnection","RTCIceGatherer"].forEach(function(e){x||e in window&&(x=!0)}),P.isWebRTCSupported=x,P.isORTCSupported="undefined"!=typeof RTCIceGatherer;var D=!1;P.browser.isChrome&&35<=P.browser.version?D=!0:P.browser.isFirefox&&34<=P.browser.version&&(D=!0),"https:"!==location.protocol&&(D=!1),P.isScreenCapturingSupported=D;var R={isSupported:!1,isCreateMediaStreamSourceSupported:!1};["AudioContext","webkitAudioContext","mozAudioContext","msAudioContext"].forEach(function(e){R.isSupported||e in window&&(R.isSupported=!0,"createMediaStreamSource"in window[e].prototype&&(R.isCreateMediaStreamSourceSupported=!0))}),P.isAudioContextSupported=R.isSupported,P.isCreateMediaStreamSourceSupported=R.isCreateMediaStreamSourceSupported;var A=!1;P.browser.isChrome&&31<P.browser.version&&(A=!0),P.isRtpDataChannelsSupported=A;var I=!1;P.browser.isFirefox&&28<P.browser.version?I=!0:P.browser.isChrome&&25<P.browser.version?I=!0:P.browser.isOpera&&11<=P.browser.version&&(I=!0),P.isSctpDataChannelsSupported=I,P.isMobileDevice=n;var B=!1;a.getUserMedia?B=!0:a.mediaDevices&&a.mediaDevices.getUserMedia&&(B=!0),P.browser.isChrome&&46<=P.browser.version&&"https:"!==location.protocol&&(P.isGetUserMediaSupported="Requires HTTPs"),P.isGetUserMediaSupported=B,P.osName=t,P.osVersion=s;var N="";screen.width&&(N+=(screen.width?screen.width:"")+" x "+(screen.height?screen.height:""));P.displayResolution=N,P.isCanvasSupportsStreamCapturing=v,P.isVideoSupportsStreamCapturing=S,P.DetectLocalIPAddress=function(i){P.isWebRTCSupported&&(P.isORTCSupported||function(o){var r={},e=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,i=!!window.webkitRTCPeerConnection;if(!e){var n=document.getElementById("iframe");if(!n)throw"NOTE: you need to have an iframe in the page right above the script tag.";var t=n.contentWindow;e=t.RTCPeerConnection||t.mozRTCPeerConnection||t.webkitRTCPeerConnection,i=!!t.webkitRTCPeerConnection}if(e){var s;i&&(s={iceServers:[{urls:"stun:stun.services.mozilla.com"}]},void 0!==P&&P.browser.isFirefox&&P.browser.version<=38&&(s[0]={url:s[0].urls}));var a=new e(s,{optional:[{RtpDataChannels:!0}]});a.onicecandidate=function(e){e.candidate&&d(e.candidate.candidate)},a.createDataChannel(""),a.createOffer(function(e){a.setLocalDescription(e,function(){},function(){})},function(){}),setTimeout(function(){var e=a.localDescription.sdp.split("\n");e.forEach(function(e){0===e.indexOf("a=candidate:")&&d(e)})},1e3)}function d(e){var i=/([0-9]{1,3}(\.[0-9]{1,3}){3})/.exec(e);if(i){var n=i[1];void 0===r[n]&&o(n),r[n]=!0}else webrtcdev.warn("Could not match IP address in",e)}}(function(e){e.match(/^(192\.168\.|169\.254\.|10\.|172\.(1[6-9]|2\d|3[01]))/)?i("Local: "+e):i("Public: "+e)}))},P.isWebSocketsSupported="WebSocket"in window&&2===window.WebSocket.CLOSING,P.isWebSocketsBlocked=!P.isWebSocketsSupported,P.checkWebSocketsSupport=function(i){i=i||function(){};try{var e=new WebSocket("wss://echo.websocket.org:443/");e.onopen=function(){P.isWebSocketsBlocked=!1,i(),e.close(),e=null},e.onerror=function(){P.isWebSocketsBlocked=!0,i()}}catch(e){P.isWebSocketsBlocked=!0,i()}},P.load=function(e){y(e=e||function(){})},P.MediaDevices=l,P.hasMicrophone=g,P.hasSpeakers=O,P.hasWebcam=W,P.isWebsiteHasWebcamPermissions=M,P.isWebsiteHasMicrophonePermissions=T,P.audioInputDevices=b,P.audioOutputDevices=C,P.videoInputDevices=k;var E=!1;"setSinkId"in document.createElement("video")&&(E=!0),P.isSetSinkIdSupported=E;var U=!1;P.browser.isFirefox&&"undefined"!=typeof mozRTCPeerConnection?"getSenders"in mozRTCPeerConnection.prototype&&(U=!0):P.browser.isChrome&&"undefined"!=typeof webkitRTCPeerConnection&&"getSenders"in webkitRTCPeerConnection.prototype&&(U=!0),P.isRTPSenderReplaceTracksSupported=U;var F=!1;P.browser.isFirefox&&38<P.browser.version&&(F=!0),P.isRemoteStreamProcessingSupported=F;var V=!1;"undefined"!=typeof MediaStreamTrack&&"applyConstraints"in MediaStreamTrack.prototype&&(V=!0),P.isApplyConstraintsSupported=V;var _=!1;P.browser.isFirefox&&43<=P.browser.version&&(_=!0),P.isMultiMonitorScreenCapturingSupported=_,P.isPromisesSupported=!!("Promise"in window),void 0===P&&(window.DetectRTC={});var z=window.MediaStream;void 0===z&&"undefined"!=typeof webkitMediaStream&&(z=webkitMediaStream),P.MediaStream=void 0!==z&&Object.keys(z.prototype),"undefined"!=typeof MediaStreamTrack?P.MediaStreamTrack=Object.keys(MediaStreamTrack.prototype):P.MediaStreamTrack=!1;var X=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;P.RTCPeerConnection=void 0!==X&&Object.keys(X.prototype),window.DetectRTC=P,"undefined"!=typeof module&&(module.exports=P),"function"==typeof define&&define.amd&&define("DetectRTC",[],function(){return P})};
"";function checkDevices(e){for(x in e.hasMicrophone?webrtcdev.info("has Microphone"):webrtcdev.error("doesnt have  hasMicrophone"),e.hasSpeakers?webrtcdev.info("has Speakers"):webrtcdev.error("doesnt have  Speakers"),e.hasWebcam?webrtcdev.info("has Webcam"):webrtcdev.error("doesnt have Webcam"),webrtcdev.log(" Audio Input Device "),e.audioInputDevices)webrtcdev.info(e.audioInputDevices[x]);for(x in webrtcdev.log(" Audio Output Device "),e.audioOutputDevices)webrtcdev.info(e.audioOutputDevices[x]);for(x in webrtcdev.log(" Video Input Device "),e.videoInputDevices)webrtcdev.info(e.videoInputDevices[x]);webrtcdev.info(" Screen Device "+e.displayResolution),statisticsobj&&statisticsobj.active&&(document.getElementById(statisticsobj.statsConainer).innerHTML+=JSON.stringify(e),document.getElementById(statisticsobj.statsConainer).innerHTML+=JSON.stringify(e.bandwidth),document.getElementById(statisticsobj.statsConainer).innerHTML+=JSON.stringify(e.codecs),alert("detect RTC appended "))}function checkWebRTCSupport(e){webrtcdev.info(" Browser ",e.browser.name+e.browser.fullVersion),e.isWebRTCSupported,e.isAudioContextSupported,e.isScreenCapturingSupported,e.isSctpDataChannelsSupported,e.isRtpDataChannelsSupported}
"";function setSettingsAttributes(){$("#channelname").val(rtcConn.channel),$("#userid").val(rtcConn.userid),$("#inAudio").prop("checked",incomingAudio),$("#inVideo").prop("checked",incomingVideo),$("#inData").prop("checked",incomingData),$("#outAudio").prop("checked",outgoingAudio),$("#outVideo").prop("checked",outgoingVideo),$("#outData").prop("checked",outgoingData),$("#role").val(role),$("#btnGetPeers").click(function(){$("#alllpeerinfo").empty(),$("#allpeerinfo").append("<pre contenteditable>"+JSON.stringify(webcallpeers,null,2)+"<pre>")}),$("#btnDebug").click(function(){$("#allwebrtcdevinfo").empty(),$("#allwebrtcdevinfo").append("<pre contenteditable>"+rtcConn+"<pre>"),webrtcdev.info(rtcConn)})}function createSession(){var e=$("#roleMakeSession").val(),n=$("#appnameMakeSession").val(),o=$("#userNameMakeSession").val(),a=$("#sessionNameMakeSession").val(),i="https://"+window.location.host+window.location.pathname+"#"+a+"?appname="+n+"&role="+e+"&audio=1&video=1&name="+o;$("#sessionlink").val(i),$("#sessionlinkGo").click(function(){window.open($("#sessionlink").val())})}function AddPartner(){var e=$("#roleMakeSession").val(),n=$("#appnameMakeSession").val(),o=$("#partnername").val(),a=$("#sessionNameMakeSession").val(),i="https://"+window.location.host+window.location.pathname+"#"+a+"?appname="+n+"&role="+e+"&audio=1&video=1&name="+o;$("#partnerlink").val(i)}function EmailPartnerLink(){var e=$("#sessionNameMakeSession").val(),n=$("#partnerlink").val();window.open("mailto:test@example.com?subject=join Session "+e+"&body="+n)}function getAllPeerInfo(){webrtcdev.info(webcallpeers)}$("#SettingsButton").click(function(){webrtcdev.info(localobj.userdetails),localobj.userdisplay.latitude&&(localobj.userdisplay.latitude.value=latitude),localobj.userdisplay.longitude&&(localobj.userdisplay.longitude.value=longitude),localobj.userdisplay.operatingsystem&&(localobj.userdisplay.operatingsystem.value=operatingsystem)});
"";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(){function i(e,o){o=o||function(e){postMessage(e)};var a=e.file;a.uuid||(a.uuid=(100*Math.random()).toString().replace(/\./g,""));var u=e.chunkSize||15e3;e.extra&&e.extra.chunkSize&&(u=e.extra.chunkSize);var c,n=0,t=u,r=Math.floor(Math.min(1e8,t)/u)*u,s=Math.ceil(a.size/u);a.maxChunks=s;var f=0,l=[];o({currentPosition:f,uuid:a.uuid,maxChunks:s,size:a.size,name:a.name,type:a.type,lastModifiedDate:a.lastModifiedDate.toString(),start:!0});var i,A=new FileReader;A.onloadend=function(e){e.target.readyState==FileReader.DONE&&function(e,n,t){c=Math.ceil(n.byteLength/u);for(var r=0;r<c;r++){var i=r*u;l[f]=n.slice(i,Math.min(i+u,n.byteLength)),o({uuid:a.uuid,buffer:l[f],currentPosition:f,maxChunks:s,size:a.size,name:a.name,lastModifiedDate:a.lastModifiedDate.toString(),type:a.type}),f++}f==s&&!0;t()}(a.name,e.target.result,function(){(++n+1)*r<a.size?(i=a.slice(n*r,(n+1)*r),A.readAsArrayBuffer(i)):n*r<a.size?(i=a.slice(n*r,a.size),A.readAsArrayBuffer(i)):(a.url=URL.createObjectURL(a),o({currentPosition:f,uuid:a.uuid,maxChunks:s,size:a.size,name:a.name,lastModifiedDate:a.lastModifiedDate.toString(),url:URL.createObjectURL(a),type:a.type,end:!0}))})},f+=1,i=a.slice(n*r,(n+1)*r),A.readAsArrayBuffer(i)}this.readAsArrayBuffer=function(n,t){var r=t.earlyCallback;function e(e){n.chunks[e.uuid]||(n.chunks[e.uuid]={currentPosition:-1}),t.extra=t.extra||{userid:0},e.userid=t.userid||t.extra.userid||0,e.extra=t.extra,(n.chunks[e.uuid][e.currentPosition]=e).end&&r&&(r(e.uuid),r=null),200<e.maxChunks&&200==e.currentPosition&&r&&(r(e.uuid),r=null)}delete t.earlyCallback,i(t,e)}}function n(a){var u=this;u.chunks={},u.chunksWaiters={},u.receive=function n(t,r){if(t.uuid){if(t.start&&!u.chunks[t.uuid]&&(u.chunks[t.uuid]={},a.onBegin&&a.onBegin(t)),!t.end&&t.buffer&&(u.chunks[t.uuid][t.currentPosition]=t.buffer),t.end){var i=u.chunks[t.uuid],o=[];Object.keys(i).forEach(function(e,n){o.push(i[e])});var e=new Blob(o,{type:t.type});(e=function(e,n){if(e||(e={}),!n)return e;for(var t in n)try{e[t]=n[t]}catch(e){}return e}(e,t)).url=URL.createObjectURL(e),e.uuid=t.uuid,e.size||webrtcdev.error("Something went wrong. Blob Size is 0."),a.onEnd&&a.onEnd(e),delete u.chunks[t.uuid],delete u.chunksWaiters[t.uuid]}t.buffer&&a.onProgress&&a.onProgress(t),t.end||(r(t),u.chunksWaiters[t.uuid]=function(){setTimeout(function e(){t.buffer&&u.chunks[t.uuid]&&(t.currentPosition==t.maxChunks||u.chunks[t.uuid][t.currentPosition]||(r(t),setTimeout(e,5e3)))},5e3)},u.chunksWaiters[t.uuid]())}else a.convertToObject(t,function(e){n(e)})}}var r={ConvertToArrayBuffer:function(e,n){a.pack(e,function(e){n(e.buffer)})},ConvertToObject:function(e,n){a.unpack(e,n)}};var v=Uint8Array.BYTES_PER_ELEMENT,b=Uint16Array.BYTES_PER_ELEMENT,E=Uint32Array.BYTES_PER_ELEMENT,T={NULL:0,UNDEFINED:1,STRING:2,NUMBER:3,BOOLEAN:4,ARRAY:5,OBJECT:6,INT8ARRAY:7,INT16ARRAY:8,INT32ARRAY:9,UINT8ARRAY:10,UINT16ARRAY:11,UINT32ARRAY:12,FLOAT32ARRAY:13,FLOAT64ARRAY:14,ARRAYBUFFER:15,BLOB:16,FILE:16,BUFFER:17},U=[null,null,"Uint16","Float64","Uint8",null,null,"Int8","Int16","Int32","Uint8","Uint16","Uint32","Float32","Float64","Uint8","Uint8","Uint8"],t=function(e){var n=0,t=0,r=0,i=new ArrayBuffer(e[0].byte_length+e[0].header_size),o=new DataView(i);for(t=0;t<e.length;t++){e[t].header_size;var a=e[t].type,u=e[t].length,c=e[t].value,s=e[t].byte_length,f=U[a],l=null===f?0:window[f+"Array"].BYTES_PER_ELEMENT;switch(a===T.BUFFER?o.setUint8(n,T.BLOB,!1):o.setUint8(n,a,!1),n+=v,a!==T.ARRAY&&a!==T.OBJECT||(o.setUint16(n,u,!1),n+=b),o.setUint32(n,s,!1),n+=E,a){case T.NULL:case T.UNDEFINED:break;case T.STRING:for(r=0;r<u;r++,n+=l)o.setUint16(n,c.charCodeAt(r),!1);break;case T.NUMBER:case T.BOOLEAN:0,o["set"+f](n,c,!1),n+=l;break;case T.INT8ARRAY:case T.INT16ARRAY:case T.INT32ARRAY:case T.UINT8ARRAY:case T.UINT16ARRAY:case T.UINT32ARRAY:case T.FLOAT32ARRAY:case T.FLOAT64ARRAY:new Uint8Array(o.buffer,n,s).set(new Uint8Array(c.buffer)),n+=s;break;case T.ARRAYBUFFER:case T.BUFFER:new Uint8Array(o.buffer,n,s).set(new Uint8Array(c)),n+=s;break;case T.BLOB:case T.ARRAY:case T.OBJECT:break;default:throw"TypeError: Unexpected type found."}0}return o},i=function e(n,t){var r,i,o,a,u,c=0;r=n.getUint8(t,!1),t+=v,r!==T.ARRAY&&r!==T.OBJECT||(i=n.getUint16(t,!1),t+=b),o=n.getUint32(t,!1),t+=E;var s=U[r],f=null===s?0:window[s+"Array"].BYTES_PER_ELEMENT;switch(r){case T.NULL:case T.UNDEFINED:0,a=null;break;case T.STRING:i=o/f;var l=[];for(c=0;c<i;c++){var A=n.getUint16(t,!1);t+=f,l.push(String.fromCharCode(A))}a=l.join("");break;case T.NUMBER:a=n.getFloat64(t,!1),t+=f;break;case T.BOOLEAN:a=1===n.getUint8(t,!1),t+=f;break;case T.INT8ARRAY:case T.INT16ARRAY:case T.INT32ARRAY:case T.UINT8ARRAY:case T.UINT16ARRAY:case T.UINT32ARRAY:case T.FLOAT32ARRAY:case T.FLOAT64ARRAY:case T.ARRAYBUFFER:u=n.buffer.slice(t,t+o),t+=o,a=r===T.ARRAYBUFFER?u:new window[s+"Array"](u);break;case T.BLOB:if(window.Blob){var d=e(n,t),R=e(n,d.cursor);t=R.cursor,a=new Blob([R.value],{type:d.value})}else u=n.buffer.slice(t,t+o),t+=o,a=new Buffer(u);break;case T.ARRAY:for(a=[],c=0;c<i;c++)t=(u=e(n,t)).cursor,a.push(u.value);break;case T.OBJECT:for(a={},c=0;c<i;c++){var h=e(n,t),y=e(n,h.cursor);t=y.cursor,a[h.value]=y.value}break;default:throw"TypeError: Type not supported."}return{value:a,cursor:t}},A=function(e,i){for(var o=e.length,a=[],u=0,c=0,n=0;n<e.length;n++)!function(r){s(e[r],function(e){if(a[r]=e,c+=e[0].header_size+e[0].byte_length,++u===o){for(var n=[],t=0;t<a.length;t++)n=n.concat(a[t]);i(n,c)}})}(n)},s=function(t,r){var e,i,o=v+E,n=0,a=0,u=t;switch(i=function(e){var n=void 0;if(void 0===e)n=T.UNDEFINED;else if(null===e)n=T.NULL;else{var t=e.constructor.name;if(void 0!==t)n=T[t.toUpperCase()];else switch(void 0===e?"undefined":_typeof(e)){case"string":n=T.STRING;break;case"number":n=T.NUMBER;break;case"boolean":n=T.BOOLEAN;break;case"object":e instanceof Array?n=T.ARRAY:e instanceof Int8Array?n=T.INT8ARRAY:e instanceof Int16Array?n=T.INT16ARRAY:e instanceof Int32Array?n=T.INT32ARRAY:e instanceof Uint8Array?n=T.UINT8ARRAY:e instanceof Uint16Array?n=T.UINT16ARRAY:e instanceof Uint32Array?n=T.UINT32ARRAY:e instanceof Float32Array?n=T.FLOAT32ARRAY:e instanceof Float64Array?n=T.FLOAT64ARRAY:e instanceof ArrayBuffer?n=T.ARRAYBUFFER:e instanceof Blob?n=T.BLOB:e instanceof Buffer?n=T.BUFFER:e instanceof Object&&(n=T.OBJECT)}}return n}(t),e=null==U[i]?0:window[U[i]+"Array"].BYTES_PER_ELEMENT,i){case T.UNDEFINED:case T.NULL:break;case T.NUMBER:case T.BOOLEAN:n=e;break;case T.STRING:n+=(a=t.length)*e;break;case T.INT8ARRAY:case T.INT16ARRAY:case T.INT32ARRAY:case T.UINT8ARRAY:case T.UINT16ARRAY:case T.UINT32ARRAY:case T.FLOAT32ARRAY:case T.FLOAT64ARRAY:n+=(a=t.length)*e;break;case T.ARRAY:return void A(t,function(e,n){r([{type:i,length:t.length,header_size:o+b,byte_length:n,value:null}].concat(e))});case T.OBJECT:var c=[];for(var s in t)t.hasOwnProperty(s)&&(c.push(s),c.push(t[s]),a++);return void A(c,function(e,n){r([{type:i,length:a,header_size:o+b,byte_length:n,value:null}].concat(e))});case T.ARRAYBUFFER:n+=t.byteLength;break;case T.BLOB:var f=t.type,l=new FileReader;return l.onload=function(e){A([f,e.target.result],function(e,n){r([{type:i,length:a,header_size:o,byte_length:n,value:null}].concat(e))})},l.onerror=function(e){throw"FileReader Error: "+e},void l.readAsArrayBuffer(t);case T.BUFFER:n+=t.length;break;default:throw'TypeError: Type "'+t.constructor.name+'" not supported.'}r([{type:i,length:a,header_size:o,byte_length:n,value:u}].concat([]))},o=function(e,n){var t=e instanceof DataView?e:new DataView(e);return i(t,0).value};var a={pack:function(e,n){try{0,s(e,function(e){n(t(e))})}catch(e){throw e}},unpack:function(e,n){try{0;var t=o(e);0,n(t)}catch(e){throw e}}};window.FileConverter=r,window.FileSelector=function(){var o=this;function n(e,n){var t,r,i=document.createElement("input");i.type="file",n&&(i.multiple=!0),i.accept=o.accept,i.onchange=function(){if(n)return i.files.length?void e(i.files):void webrtcdev.error("No file selected.");i.files[0]?(e(i.files[0]),i.parentNode.removeChild(i)):webrtcdev.error("No file selected.")},i.style.display="none",(document.body||document.documentElement).appendChild(i),t=i,r=new window.MouseEvent("click",{view:window,bubbles:!0,cancelable:!0,button:0,buttons:0,mozInputSource:1}),t.dispatchEvent(r)}o.selectSingleFile=n,o.selectMultipleFiles=function(e){n(e,!0)},o.accept="*.*"},window.FileBufferReader=function(){var a=this,i=new e;a.chunks={},a.users={},a.readAsArrayBuffer=function(e,n,t){var r={file:e,earlyCallback:function(e){n(u(e,{currentPosition:-1}))},extra:t||{userid:0}};i.readAsArrayBuffer(a,r)},a.getNextChunk=function(e,n,t){var r;void 0!==e.currentPosition&&(r=e.currentPosition,e=e.uuid);var i=a.chunks[e];if(i){void 0!==t?(a.users[t+""]||(a.users[t+""]={fileUUID:e,userid:t,currentPosition:-1}),void 0!==r&&(a.users[t+""].currentPosition=r),a.users[t+""].currentPosition++,r=a.users[t+""].currentPosition):(void 0!==r&&(a.chunks[e].currentPosition=r),a.chunks[e].currentPosition++,r=a.chunks[e].currentPosition);var o=i[r];if(!o)return delete a.chunks[e],void a.convertToArrayBuffer({chunkMissing:!0,currentPosition:r,uuid:e},n);o=u(o),void 0!==t&&(o.remoteUserId=t+""),o.start&&a.onBegin(o),o.end&&a.onEnd(o),a.onProgress(o),a.convertToArrayBuffer(o,function(e){o.currentPosition!=o.maxChunks?n(e,!1):n(e,!0)})}};var t=new n(a);function u(e,n){if(null==e||"object"!=(void 0===e?"undefined":_typeof(e)))return e;if(e.constructor!=Object&&e.constructor!=Array)return e;if(e.constructor==Date||e.constructor==RegExp||e.constructor==Function||e.constructor==String||e.constructor==Number||e.constructor==Boolean)return new e.constructor(e);for(var t in n=n||new e.constructor,e)n[t]=void 0===n[t]?u(e[t],null):n[t];return n}a.addChunk=function(e,n){e&&t.receive(e,function(e){a.convertToArrayBuffer({readyForNextChunk:!0,currentPosition:e.currentPosition,uuid:e.uuid},n)})},a.chunkMissing=function(e){delete t.chunks[e.uuid],delete t.chunksWaiters[e.uuid]},a.onBegin=function(){},a.onEnd=function(){},a.onProgress=function(){},a.convertToObject=r.ConvertToObject,a.convertToArrayBuffer=r.ConvertToArrayBuffer,a.setMultipleUsers=function(){}}}();
"";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function MediaStreamRecorder(a){if(!a)throw"MediaStream is mandatory.";var i;this.start=function(t){var e=IsChrome?window.StereoRecorder:window.MediaRecorderWrapper;-1!=this.mimeType.indexOf("video")&&(e=IsChrome?window.WhammyRecorder:window.MediaRecorderWrapper),"image/gif"===this.mimeType&&(e=window.GifRecorder),(i=new e(a)).ondataavailable=this.ondataavailable,i.onstop=this.onstop,i.onStartedDrawingNonBlankFrames=this.onStartedDrawingNonBlankFrames,(i=mergeProps(i,this)).start(t)},this.onStartedDrawingNonBlankFrames=function(){},this.clearOldRecordedFrames=function(){i&&i.clearOldRecordedFrames()},this.stop=function(){i&&i.stop()},this.ondataavailable=function(t){webrtcdev.log("ondataavailable..",t)},this.onstop=function(t){webrtcdev.warn("stopped..",t)}}function loadScript(t,e){var a=window.MediaStreamRecorderScriptsDir,i=document.createElement("script");i.src=a+t,i.onload=e||function(){},document.documentElement.appendChild(i)}function mergeProps(t,e){for(var a in e=reformatProps(e))"function"!=typeof e[a]&&(t[a]=e[a]);return t}function reformatProps(t){var e={};for(var a in t)if(-1!=a.indexOf("-")){var i=a.split("-");e[i[0]+i[1].split("")[0].toUpperCase()+i[1].substr(1)]=t[a]}else e[a]=t[a];return e}window.requestAnimationFrame||(requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame),window.cancelAnimationFrame||(cancelAnimationFrame=window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame),window.AudioContext||(window.AudioContext=window.webkitAudioContext||window.mozAudioContext),URL=window.URL||window.webkitURL,navigator.getUserMedia=navigator.webkitGetUserMedia||navigator.mozGetUserMedia,window.webkitMediaStream&&(window.MediaStream=window.webkitMediaStream),IsChrome=!!navigator.webkitGetUserMedia;var ObjectStore={AudioContext:window.AudioContext||window.webkitAudioContext};function MediaRecorderWrapper(a){if("audio"==this.type&&a.getVideoTracks&&a.getVideoTracks().length&&!navigator.mozGetUserMedia){var t=new AudioContext,e=t.createMediaStreamSource(a),i=t.createMediaStreamDestination();e.connect(i),a=i.stream}var n=!(this.start=function(e){e=e||1e3,n=!1,function t(){n||((o=new MediaRecorder(a)).ondataavailable=function(t){if(webrtcdev.log("ondataavailable",t.data.type,t.data.size,t.data),t.data.size){var e=new window.Blob([t.data],{type:t.data.type||r.mimeType||"audio/ogg"});r.ondataavailable(e)}else webrtcdev.warn("Recording of",t.data.type,"failed.")},o.onstop=function(t){},o.onerror=function(t){webrtcdev.error(t),r.start(e)},o.onwarning=function(t){webrtcdev.warn(t)},o.start(0),setTimeout(function(){o.stop(),t()},e))}()});this.stop=function(){n=!0,r.onstop&&r.onstop({})},this.ondataavailable=this.onstop=function(){};var o,r=this;!r.mimeType&&a.getAudioTracks&&(r.mimeType=a.getAudioTracks().length&&a.getVideoTracks().length?"video/webm":"audio/ogg")}function StereoRecorder(e){var a,i;this.start=function(t){t=t||1e3,(a=new StereoAudioRecorder(e,this)).record(),i=setInterval(function(){a.requestData()},t)},this.stop=function(){a&&(a.stop(),clearTimeout(i))},this.ondataavailable=function(){}}function StereoAudioRecorder(t,u){var e,l=[],w=[],i=!1,m=0,f=u.mono?1:2;function v(t,e){for(var a=new Float32Array(e),i=0,n=t.length,o=0;o<n;o++){var r=t[o];a.set(r,i),i+=r.length}return a}function g(t,e,a){for(var i=a.length,n=0;n<i;n++)t.setUint8(e+n,a.charCodeAt(n))}this.record=function(){i=!0,l.length=w.length=0,m=0},this.requestData=function(){if(0!=m){p=!0;var t=l.slice(0),e=(w.slice(0),m);l.length=w.length=[],m=0,p=!1;var a=v(t,e),i=v(t,e);if(2===f)var n=function(t,e){for(var a=t.length+e.length,i=new Float32Array(a),n=0,o=0;o<a;)i[o++]=t[n],i[o++]=e[n],n++;return i}(a,i);else n=a;var o=new ArrayBuffer(44+2*n.length),r=new DataView(o);g(r,0,"RIFF"),r.setUint32(4,44+2*n.length,!0),g(r,8,"WAVE"),g(r,12,"fmt "),r.setUint32(16,16,!0),r.setUint16(20,1,!0),r.setUint16(22,f,!0),r.setUint32(24,44100,!0),r.setUint32(28,176400,!0),r.setUint16(32,2*f,!0),r.setUint16(34,16,!0),g(r,36,"data"),r.setUint32(40,2*n.length,!0);for(var d=n.length,s=44,c=0;c<d;c++)r.setInt16(s,32767*n[c],!0),s+=2;var h=new Blob([r],{type:"audio/wav"});webrtcdev.debug("audio recorded blob size:",bytesToSize(h.size)),u.ondataavailable(h)}else p=!1},this.stop=function(){i=!1,this.requestData()};var a=ObjectStore.AudioContext;ObjectStore.AudioContextConstructor||(ObjectStore.AudioContextConstructor=new a);var n=ObjectStore.AudioContextConstructor;ObjectStore.VolumeGainNode||(ObjectStore.VolumeGainNode=n.createGain());var o=ObjectStore.VolumeGainNode;ObjectStore.AudioInput||(ObjectStore.AudioInput=n.createMediaStreamSource(t)),ObjectStore.AudioInput.connect(o);var r=u.bufferSize||2048;if(0==u.bufferSize&&(r=0),n.createJavaScriptNode)e=n.createJavaScriptNode(r,f,f);else{if(!n.createScriptProcessor)throw"WebAudio API has no support on this browser.";e=n.createScriptProcessor(r,f,f)}r=e.bufferSize,webrtcdev.debug("using audio buffer-size:",r);var p=!1;window.scriptprocessornode=e,1==f&&webrtcdev.debug("It seems mono audio. All right-channels are skipped."),e.onaudioprocess=function(t){if(i&&!p){var e=t.inputBuffer.getChannelData(0);if(l.push(new Float32Array(e)),2==f){var a=t.inputBuffer.getChannelData(1);w.push(new Float32Array(a))}m+=r}},o.connect(e),e.connect(n.destination)}function WhammyRecorderHelper(e,a){this.record=function(t){this.width||(this.width=320),this.height||(this.height=240),this.video&&this.video instanceof HTMLVideoElement&&(this.width||(this.width=s.videoWidth||320),this.height||(this.height=s.videoHeight||240)),this.video||(this.video={width:this.width,height:this.height}),this.canvas||(this.canvas={width:this.width,height:this.height}),A.width=this.canvas.width,A.height=this.canvas.height,this.video&&this.video instanceof HTMLVideoElement?s=this.video.cloneNode():((s=document.createElement("video")).src=URL.createObjectURL(e),s.width=this.video.width,s.height=this.video.height),s.muted=!0,s.play(),c=(new Date).getTime(),h=new Whammy.Video,webrtcdev.log("canvas resolutions",A.width,"*",A.height),webrtcdev.log("video width/height",s.width||A.width,"*",s.height||A.height),r()};var i=!(this.clearOldRecordedFrames=function(){n=[]});this.requestData=function(){if(n.length){i=!0;var t=n.slice(0);n=[],h.frames=function(t,e,a,i){var n=document.createElement("canvas");n.width=A.width,n.height=A.height;for(var o=n.getContext("2d"),r=[],d=-1===e,s=e&&0<e&&e<=t.length?e:t.length,c={r:0,g:0,b:0},h=Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2)),u=a&&0<=a&&a<=1?a:0,l=i&&0<=i&&i<=1?i:0,w=!1,m=0;m<s;m++){var f,v,g;if(!w){var p=new Image;p.src=t[m].image,o.drawImage(p,0,0,A.width,A.height);var b=o.getImageData(0,0,A.width,A.height);f=0,v=b.data.length,g=b.data.length/4;for(var y=0;y<v;y+=4){var S={r:b.data[y],g:b.data[y+1],b:b.data[y+2]},M=Math.sqrt(Math.pow(S.r-c.r,2)+Math.pow(S.g-c.g,2)+Math.pow(S.b-c.b,2));M<=h*u&&f++}}!w&&g-f<=g*l||(d&&(w=!0),r.push(t[m]))}(r=r.concat(t.slice(s))).length<=0&&r.push(t[t.length-1]);return r}(t,-1);var e=h.compile();a.ondataavailable(e),webrtcdev.debug("video recorded blob size:",bytesToSize(e.size)),i=!1}else i=!1};var n=[],o=!1;function r(){if(!d){if(i)return setTimeout(r,100);var t=(new Date).getTime()-c;if(!t)return r();c=(new Date).getTime(),u.drawImage(s,0,0,A.width,A.height),!d&&n.push({duration:t,image:A.toDataURL("image/webp")}),o||function(t,e,a){var i=document.createElement("canvas");i.width=A.width,i.height=A.height;var n,o,r,d=i.getContext("2d"),s={r:0,g:0,b:0},c=Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2)),h=e&&0<=e&&e<=1?e:0,u=a&&0<=a&&a<=1?a:0,l=new Image;l.src=t.image,d.drawImage(l,0,0,A.width,A.height);var w=d.getImageData(0,0,A.width,A.height);n=0,o=w.data.length,r=w.data.length/4;for(var m=0;m<o;m+=4){var f={r:w.data[m],g:w.data[m+1],b:w.data[m+2]},v=Math.sqrt(Math.pow(f.r-s.r,2)+Math.pow(f.g-s.g,2)+Math.pow(f.b-s.b,2));v<=c*h&&n++}return!(r-n<=r*u)}(n[n.length-1])||(o=!0,a.onStartedDrawingNonBlankFrames()),setTimeout(r,10)}}var d=!1;this.stop=function(){d=!0,this.requestData()};var s,c,h,A=document.createElement("canvas"),u=A.getContext("2d")}function WhammyRecorder(a){var i,n;this.start=function(t){for(var e in t=t||1e3,i=new WhammyRecorderHelper(a,this),this)"function"!=typeof this[e]&&(i[e]=this[e]);i.record(),n=setInterval(function(){i.requestData()},t)},this.stop=function(){i&&(i.stop(),clearTimeout(n))},this.clearOldRecordedFrames=function(){i&&i.clearOldRecordedFrames()},this.ondataavailable=function(){}}var Whammy=function(){function t(t){for(var e,a=function(t){if(!t[0])return void webrtcdev.warn("Something went wrong. Maybe WebP format is not supported in the current browser.");for(var e=t[0].width,a=t[0].height,i=t[0].duration,n=1;n<t.length;n++)i+=t[n].duration;return{duration:i,width:e,height:a}}(t),i=[{id:440786851,data:[{data:1,id:17030},{data:1,id:17143},{data:4,id:17138},{data:8,id:17139},{data:"webm",id:17026},{data:2,id:17031},{data:2,id:17029}]},{id:408125543,data:[{id:357149030,data:[{data:1e6,id:2807729},{data:"whammy",id:19840},{data:"whammy",id:22337},{data:(e=a.duration,[].slice.call(new Uint8Array(new Float64Array([e]).buffer),0).map(function(t){return String.fromCharCode(t)}).reverse().join("")),id:17545}]},{id:374648427,data:[{id:174,data:[{data:1,id:215},{data:1,id:25541},{data:0,id:156},{data:"und",id:2274716},{data:"V_VP8",id:134},{data:"VP8",id:2459272},{data:1,id:131},{id:224,data:[{data:a.width,id:176},{data:a.height,id:186}]}]}]}]}],n=0,o=0;n<t.length;){for(var r=[],d=0;r.push(t[n]),d+=t[n].duration,++n<t.length&&d<3e4;);var s=0,c={id:524531317,data:[{data:o,id:231}].concat(r.map(function(t){var e=l({discardable:0,frame:t.data.slice(4),invisible:0,keyframe:1,lacing:0,trackNum:1,timecode:Math.round(s)});return s+=t.duration,{data:e,id:163}}))};i[1].data.push(c),o+=d}return function t(e){var a=[];for(var i=0;i<e.length;i++){var n=e[i].data;"object"==(void 0===n?"undefined":_typeof(n))&&(n=t(n)),"number"==typeof n&&(n=u(n.toString(2))),"string"==typeof n&&(n=new Uint8Array(n.split("").map(function(t){return t.charCodeAt(0)})));var o=n.size||n.byteLength||n.length,r=Math.ceil(Math.ceil(Math.log(o)/Math.log(2))/8),d=o.toString(2),s=new Array(7*r+7+1-d.length).join("0")+d,c=new Array(r).join("0")+"1"+s;a.push(h(e[i].id)),a.push(u(c)),a.push(n)}return new Blob(a,{type:"video/webm"})}(i)}function h(t){for(var e=[];0<t;)e.push(255&t),t>>=8;return new Uint8Array(e.reverse())}function u(t){var e=[];t=(t.length%8?new Array(9-t.length%8).join("0"):"")+t;for(var a=0;a<t.length;a+=8)e.push(parseInt(t.substr(a,8),2));return new Uint8Array(e)}function l(t){var e=0;if(t.keyframe&&(e|=128),t.invisible&&(e|=8),t.lacing&&(e|=t.lacing<<1),t.discardable&&(e|=1),127<t.trackNum)throw"TrackNumber > 127 not supported";return[128|t.trackNum,t.timecode>>8,255&t.timecode,e].map(function(t){return String.fromCharCode(t)}).join("")+t.frame}function e(t){this.frames=[],this.duration=t||1,this.quality=100}return e.prototype.add=function(t,e){if("canvas"in t&&(t=t.canvas),"toDataURL"in t&&(t=t.toDataURL("image/webp",this.quality)),!/^data:image\/webp;base64,/gi.test(t))throw"Input must be formatted properly as a base64 encoded DataURI of type image/webp";this.frames.push({image:t,duration:e||this.duration})},e.prototype.compile=function(){return new t(this.frames.map(function(t){var e=function(t){for(var e=t.RIFF[0].WEBP[0],a=e.indexOf("*"),i=0,n=[];i<4;i++)n[i]=e.charCodeAt(a+3+i);return{width:16383&(n[1]<<8|n[0]),height:16383&(n[3]<<8|n[2]),data:e,riff:t}}(function t(e){for(var a=0,i={};a<e.length;){var n=e.substr(a,4),o=parseInt(e.substr(a+4,4).split("").map(function(t){var e=t.charCodeAt(0).toString(2);return new Array(8-e.length+1).join("0")+e}).join(""),2),r=e.substr(a+4+4,o);a+=8+o,i[n]=i[n]||[],"RIFF"==n||"LIST"==n?i[n].push(t(r)):i[n].push(r)}return i}(atob(t.image.slice(23))));return e.duration=t.duration,e}))},{Video:e,toWebM:t}}();function GifRecorder(t){if(!window.GIFEncoder)throw"Please link: https://cdn.webrtc-experiment.com/gif-recorder.js";function e(){Date.now();var t=new Blob([new Uint8Array(s.stream().bin)],{type:"image/gif"});a.ondataavailable(t),s.stream().bin=[]}this.start=function(t){t=t||1e3;var a=this.videoWidth||320,i=this.videoHeight||240;n.width=r.width=a,n.height=r.height=i,(s=new GIFEncoder).setRepeat(0),s.setDelay(this.frameRate||200),s.setQuality(this.quality||1),s.start(),Date.now(),h=requestAnimationFrame(function t(e){h=requestAnimationFrame(t),void 0===(void 0===d?"undefined":_typeof(d))&&(d=e),e-d<90||(o.drawImage(r,0,0,a,i),s.addFrame(o),d=e)}),c=setTimeout(e,t)},this.stop=function(){h&&(cancelAnimationFrame(h),clearTimeout(c),e())},this.ondataavailable=function(){},this.onstop=function(){};var a=this,n=document.createElement("canvas"),o=n.getContext("2d"),r=document.createElement("video");r.muted=!0,r.autoplay=!0,r.src=URL.createObjectURL(t),r.play();var d,s,c,h=null}function MultiStreamRecorder(i){if(!i)throw"MediaStream is mandatory.";var n,o,r=this,d=!!navigator.mozGetUserMedia;this.stream=i,this.start=function(t){for(var e in n=new MediaStreamRecorder(i),o=new MediaStreamRecorder(i),n.mimeType="audio/ogg",o.mimeType="video/webm",this)"function"!=typeof this[e]&&(n[e]=o[e]=this[e]);function a(t){c++,r.ondataavailable(t)}n.ondataavailable=function(t){s[c]||(s[c]={}),s[c].audio=t,s[c].video&&!s[c].posted&&(s[c].posted=!0,a(s[c]))},o.ondataavailable=function(t){if(d)return r.ondataavailable({video:t,audio:t});s[c]||(s[c]={}),s[c].video=t,s[c].audio&&!s[c].invokedOnce&&(s[c].invokedOnce=!0,a(s[c]))},o.onstop=n.onstop=function(t){r.onstop(t)},d||(o.onStartedDrawingNonBlankFrames=function(){webrtcdev.debug("Fired: onStartedDrawingNonBlankFrames"),o.clearOldRecordedFrames(),n.start(t)}),o.start(t)},this.stop=function(){n&&n.stop(),o&&o.stop()},this.ondataavailable=function(t){webrtcdev.log("ondataavailable..",t)},this.onstop=function(t){webrtcdev.warn("stopped..",t)};var s={},c=0}function bytesToSize(t){if(0===t)return"0 Bytes";var e=parseInt(Math.floor(Math.log(t)/Math.log(1e3)),10);return(t/Math.pow(1e3,e)).toPrecision(3)+" "+["Bytes","KB","MB","GB","TB"][e]}function SaveToDisk(t,e){var a=document.createElement("a");a.href=URL.createObjectURL(t),a.target="_blank",a.download=(e||Math.round(9999999999*Math.random())+888888888)+"."+t.type.split("/")[1];var i=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});a.dispatchEvent(i),(window.URL||window.webkitURL).revokeObjectURL(a.href)}
"";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function RecordRTC(i,s){if(!i)throw"MediaStream is mandatory.";s=new RecordRTCConfiguration(i,s=s||{type:"video"});var n=this;function e(e){e&&(s.initCallback=function(){e(),e=s.initCallback=null});var t=new GetRecorderType(i,s);(f=new t(i,s)).record(),s.disableLogs||webrtcdev.debug("Initialized recorderType:",f.constructor.name,"for output-type:",s.type)}function t(r){if(!f)return webrtcdev.warn(d);var a=this;function e(e){for(var t in f)n&&(n[t]=f[t]),a&&(a[t]=f[t]);var i=f.blob;if(!i){if(!e)throw"Recording failed.";f.blob=i=e}if(r){var o=URL.createObjectURL(i);r(o)}i&&!s.disableLogs&&webrtcdev.debug(i.type,"->",bytesToSize(i.size)),s.autoWriteToDisk&&u(function(e){var t={};t[s.type+"Blob"]=e,DiskStorage.Store(t)})}s.disableLogs||webrtcdev.warn("Stopped recording "+s.type+" stream."),"gif"!==s.type?f.stop(e):(f.stop(),e())}function c(e){postMessage((new FileReaderSync).readAsDataURL(e))}function u(t,e){if(!t)throw"Pass a callback function over getDataURL.";var i,o,r,a=e?e.blob:(f||{}).blob;if(!a)return s.disableLogs||webrtcdev.warn("Blob encoder did not finish its job yet."),void setTimeout(function(){u(t,e)},1e3);if("undefined"==typeof Worker||navigator.mozGetUserMedia){var n=new FileReader;n.readAsDataURL(a),n.onload=function(e){t(e.target.result)}}else{var d=(i=c,o=URL.createObjectURL(new Blob([i.toString(),"this.onmessage =  function (e) {"+i.name+"(e.data);}"],{type:"application/javascript"})),r=new Worker(o),URL.revokeObjectURL(o),r);d.onmessage=function(e){t(e.data)},d.postMessage(a)}}function o(){setTimeout(function(){t(n.onRecordingStopped)},n.recordingDuration)}var f,d='It seems that "startRecording" is not invoked for '+s.type+" recorder.",r={startRecording:function(){return s.disableLogs||webrtcdev.debug("started recording "+s.type+" stream."),f?(f.clearRecordedData(),f.resume(),n.recordingDuration&&o()):e(function(){n.recordingDuration&&o()}),n},stopRecording:t,pauseRecording:function(){if(!f)return webrtcdev.warn(d);f.pause(),s.disableLogs||webrtcdev.debug("Paused recording.")},resumeRecording:function(){if(!f)return webrtcdev.warn(d);f.resume(),s.disableLogs||webrtcdev.debug("Resumed recording.")},initRecorder:e,setRecordingDuration:function(e,t){if(void 0===e)throw"milliseconds is required.";if("number"!=typeof e)throw"milliseconds must be a number.";return n.recordingDuration=e,n.onRecordingStopped=t||function(){},{onRecordingStopped:function(e){n.onRecordingStopped=e}}},clearRecordedData:function(){if(!f)return webrtcdev.warn(d);f.clearRecordedData(),s.disableLogs||webrtcdev.debug("Cleared old recorded data.")},getBlob:function(){return f?f.blob:webrtcdev.warn(d)},getDataURL:u,toURL:function(){return f?URL.createObjectURL(f.blob):webrtcdev.warn(d)},save:function(e){if(!f)return webrtcdev.warn(d);invokeSaveAsDialog(f.blob,e)},getFromDisk:function(e){if(!f)return webrtcdev.warn(d);RecordRTC.getFromDisk(s.type,e)},setAdvertisementArray:function(e){s.advertisement=[];for(var t=e.length,i=0;i<t;i++)s.advertisement.push({duration:i,image:e[i]})},blob:null,bufferSize:0,sampleRate:0,buffer:null,view:null};if(!this)return n=r;for(var a in r)this[a]=r[a];return n=this,r}function RecordRTCConfiguration(e,t){return t.recorderType&&!t.type&&(t.recorderType===WhammyRecorder||t.recorderType===CanvasRecorder?t.type="video":t.recorderType===GifRecorder?t.type="gif":t.recorderType===StereoAudioRecorder?t.type="audio":t.recorderType===MediaStreamRecorder&&(e.getAudioTracks().length&&e.getVideoTracks().length?t.type="video":e.getAudioTracks().length&&!e.getVideoTracks().length?t.type="audio":!e.getAudioTracks().length&&e.getVideoTracks().length&&(t.type="audio"))),void 0!==MediaStreamRecorder&&"undefined"!=typeof MediaRecorder&&"requestData"in MediaRecorder.prototype&&(t.mimeType||(t.mimeType="video/webm"),t.type||(t.type=t.mimeType.split("/")[0]),t.bitsPerSecond),t.type||(t.mimeType&&(t.type=t.mimeType.split("/")[0]),t.type||(t.type="audio")),t}function GetRecorderType(e,t){var i;return(isChrome||isEdge||isOpera)&&(i=StereoAudioRecorder),"undefined"!=typeof MediaRecorder&&"requestData"in MediaRecorder.prototype&&!isChrome&&(i=MediaStreamRecorder),"video"===t.type&&(isChrome||isOpera)&&(i=WhammyRecorder),"gif"===t.type&&(i=GifRecorder),"canvas"===t.type&&(i=CanvasRecorder),isMediaRecorderCompatible()&&i!==CanvasRecorder&&i!==GifRecorder&&"undefined"!=typeof MediaRecorder&&"requestData"in MediaRecorder.prototype&&e.getVideoTracks().length&&(i=MediaStreamRecorder),t.recorderType&&(i=t.recorderType),!t.disableLogs&&i&&i.name&&webrtcdev.debug("Using recorderType:",i.name||i.constructor.name),i}function MRecordRTC(n){this.addStream=function(e){e&&(n=e)},this.mediaType={audio:!0,video:!0},this.startRecording=function(){var e,t=this.mediaType,i=this.mimeType||{audio:null,video:null,gif:null};if("function"!=typeof t.audio&&isMediaRecorderCompatible()&&n.getAudioTracks&&!n.getAudioTracks().length&&(t.audio=!1),"function"!=typeof t.video&&isMediaRecorderCompatible()&&n.getVideoTracks&&!n.getVideoTracks().length&&(t.video=!1),!t.audio&&!t.video)throw"MediaStream must have either audio or video tracks.";if(t.audio&&(e=null,"function"==typeof t.audio&&(e=t.audio),this.audioRecorder=new RecordRTC(n,{type:"audio",bufferSize:this.bufferSize,sampleRate:this.sampleRate,numberOfAudioChannels:this.numberOfAudioChannels||2,disableLogs:this.disableLogs,recorderType:e,mimeType:i.audio}),t.video||this.audioRecorder.startRecording()),t.video){e=null,"function"==typeof t.video&&(e=t.video);var o=n;if(isMediaRecorderCompatible()&&t.audio&&"function"==typeof t.audio){var r=n.getVideoTracks()[0];navigator.mozGetUserMedia?((o=new MediaStream).addTrack(r),e&&e===WhammyRecorder&&(e=MediaStreamRecorder)):o=new MediaStream([r])}this.videoRecorder=new RecordRTC(o,{type:"video",video:this.video,canvas:this.canvas,frameInterval:this.frameInterval||10,disableLogs:this.disableLogs,recorderType:e,mimeType:i.video}),t.audio||this.videoRecorder.startRecording()}if(t.audio&&t.video){var a=this;isMediaRecorderCompatible()?(a.audioRecorder=null,a.videoRecorder.startRecording()):a.videoRecorder.initRecorder(function(){a.audioRecorder.initRecorder(function(){a.videoRecorder.startRecording(),a.audioRecorder.startRecording()})})}t.gif&&(e=null,"function"==typeof t.gif&&(e=t.gif),this.gifRecorder=new RecordRTC(n,{type:"gif",frameRate:this.frameRate||200,quality:this.quality||10,disableLogs:this.disableLogs,recorderType:e,mimeType:i.gif}),this.gifRecorder.startRecording())},this.stopRecording=function(t){t=t||function(){},this.audioRecorder&&this.audioRecorder.stopRecording(function(e){t(e,"audio")}),this.videoRecorder&&this.videoRecorder.stopRecording(function(e){t(e,"video")}),this.gifRecorder&&this.gifRecorder.stopRecording(function(e){t(e,"gif")})},this.pauseRecording=function(){this.audioRecorder&&this.audioRecorder.pauseRecording(),this.videoRecorder&&this.videoRecorder.pauseRecording(),this.gifRecorder&&this.gifRecorder.pauseRecording()},this.resumeRecording=function(){this.audioRecorder&&this.audioRecorder.resumeRecording(),this.videoRecorder&&this.videoRecorder.resumeRecording(),this.gifRecorder&&this.gifRecorder.resumeRecording()},this.getBlob=function(e){var t={};return this.audioRecorder&&(t.audio=this.audioRecorder.getBlob()),this.videoRecorder&&(t.video=this.videoRecorder.getBlob()),this.gifRecorder&&(t.gif=this.gifRecorder.getBlob()),e&&e(t),t},this.getDataURL=function(i){function o(e,t){if("undefined"!=typeof Worker){var i=function(e){var t,i=URL.createObjectURL(new Blob([e.toString(),"this.onmessage =  function (e) {"+e.name+"(e.data);}"],{type:"application/javascript"})),o=new Worker(i);if(void 0!==URL)t=URL;else{if("undefined"==typeof webkitURL)throw"Neither URL nor webkitURL detected.";t=webkitURL}return t.revokeObjectURL(i),o}(function(e){postMessage((new FileReaderSync).readAsDataURL(e))});i.onmessage=function(e){t(e.data)},i.postMessage(e)}else{var o=new FileReader;o.readAsDataURL(e),o.onload=function(e){t(e.target.result)}}}this.getBlob(function(e){e.audio&&e.video?o(e.audio,function(t){o(e.video,function(e){i({audio:t,video:e})})}):e.audio?o(e.audio,function(e){i({audio:e})}):e.video&&o(e.video,function(e){i({video:e})})})},this.writeToDisk=function(){RecordRTC.writeToDisk({audio:this.audioRecorder,video:this.videoRecorder,gif:this.gifRecorder})},this.save=function(e){(e=e||{audio:!0,video:!0,gif:!0}).audio&&this.audioRecorder&&this.audioRecorder.save("string"==typeof e.audio?e.audio:""),e.video&&this.videoRecorder&&this.videoRecorder.save("string"==typeof e.video?e.video:""),e.gif&&this.gifRecorder&&this.gifRecorder.save("string"==typeof e.gif?e.gif:"")}}RecordRTC.getFromDisk=function(i,o){if(!o)throw"callback is mandatory.";webrtcdev.log("Getting recorded "+("all"===i?"blobs":i+" blob ")+" from disk!"),DiskStorage.Fetch(function(e,t){"all"!==i&&t===i+"Blob"&&o&&o(e),"all"===i&&o&&o(e,t.replace("Blob",""))})},RecordRTC.writeToDisk=function(e){webrtcdev.log("Writing recorded blob(s) to disk!"),(e=e||{}).audio&&e.video&&e.gif?e.audio.getDataURL(function(i){e.video.getDataURL(function(t){e.gif.getDataURL(function(e){DiskStorage.Store({audioBlob:i,videoBlob:t,gifBlob:e})})})}):e.audio&&e.video?e.audio.getDataURL(function(t){e.video.getDataURL(function(e){DiskStorage.Store({audioBlob:t,videoBlob:e})})}):e.audio&&e.gif?e.audio.getDataURL(function(t){e.gif.getDataURL(function(e){DiskStorage.Store({audioBlob:t,gifBlob:e})})}):e.video&&e.gif?e.video.getDataURL(function(t){e.gif.getDataURL(function(e){DiskStorage.Store({videoBlob:t,gifBlob:e})})}):e.audio?e.audio.getDataURL(function(e){DiskStorage.Store({audioBlob:e})}):e.video?e.video.getDataURL(function(e){DiskStorage.Store({videoBlob:e})}):e.gif&&e.gif.getDataURL(function(e){DiskStorage.Store({gifBlob:e})})},"undefined"!=typeof module&&(module.exports=RecordRTC),"function"==typeof define&&define.amd&&define("RecordRTC",[],function(){return RecordRTC}),MRecordRTC.getFromDisk=RecordRTC.getFromDisk,MRecordRTC.writeToDisk=RecordRTC.writeToDisk,void 0!==RecordRTC&&(RecordRTC.MRecordRTC=MRecordRTC);var browserFakeUserAgent="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";!function(e){e&&"undefined"==typeof window&&"undefined"!=typeof global&&(global.navigator={userAgent:browserFakeUserAgent,getUserMedia:function(){}},global.webrtcdev||(global.webrtcdev={}),void 0===global.webrtcdev.debug&&(global.webrtcdev.debug=global.webrtcdev.info=global.webrtcdev.error=global.webrtcdev.log=global.webrtcdev.log||function(){webrtcdev.log(arguments)}),"undefined"==typeof document&&(e.document={},document.createElement=document.captureStream=document.mozCaptureStream=function(){var e={getContext:function(){return e},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""}};return e},e.HTMLVideoElement=function(){}),"undefined"==typeof location&&(e.location={protocol:"file:",href:"",hash:""}),"undefined"==typeof screen&&(e.screen={width:0,height:0}),void 0===URL&&(e.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),e.window=global)}("undefined"!=typeof global?global:null);var requestAnimationFrame=window.requestAnimationFrame;void 0===requestAnimationFrame&&("undefined"!=typeof webkitRequestAnimationFrame&&(requestAnimationFrame=webkitRequestAnimationFrame),"undefined"!=typeof mozRequestAnimationFrame&&(requestAnimationFrame=mozRequestAnimationFrame));var cancelAnimationFrame=window.cancelAnimationFrame;void 0===cancelAnimationFrame&&("undefined"!=typeof webkitCancelAnimationFrame&&(cancelAnimationFrame=webkitCancelAnimationFrame),"undefined"!=typeof mozCancelAnimationFrame&&(cancelAnimationFrame=mozCancelAnimationFrame));var AudioContext=window.AudioContext;void 0===AudioContext&&("undefined"!=typeof webkitAudioContext&&(AudioContext=webkitAudioContext),"undefined"!=typeof mozAudioContext&&(AudioContext=mozAudioContext));var URL=window.URL;void 0===URL&&"undefined"!=typeof webkitURL&&(URL=webkitURL),"undefined"!=typeof navigator&&void 0===navigator.getUserMedia&&(void 0!==navigator.webkitGetUserMedia&&(navigator.getUserMedia=navigator.webkitGetUserMedia),void 0!==navigator.mozGetUserMedia&&(navigator.getUserMedia=navigator.mozGetUserMedia));var isEdge=!(-1===navigator.userAgent.indexOf("Edge")||!navigator.msSaveBlob&&!navigator.msSaveOrOpenBlob),isOpera=!!window.opera||-1!==navigator.userAgent.indexOf("OPR/"),isChrome=!isOpera&&!isEdge&&!!navigator.webkitGetUserMedia,MediaStream=window.MediaStream;function bytesToSize(e){if(0===e)return"0 Bytes";var t=parseInt(Math.floor(Math.log(e)/Math.log(1e3)),10);return(e/Math.pow(1e3,t)).toPrecision(3)+" "+["Bytes","KB","MB","GB","TB"][t]}function invokeSaveAsDialog(e,t){if(!e)throw"Blob object is required.";if(!e.type)try{e.type="video/webm"}catch(e){}var i=(e.type||"video/webm").split("/")[1];if(t&&-1!==t.indexOf(".")){var o=t.split(".");t=o[0],i=o[1]}var r=(t||Math.round(9999999999*Math.random())+888888888)+"."+i;if(void 0!==navigator.msSaveOrOpenBlob)return navigator.msSaveOrOpenBlob(e,r);if(void 0!==navigator.msSaveBlob)return navigator.msSaveBlob(e,r);var a=document.createElement("a");a.href=URL.createObjectURL(e),a.target="_blank",a.download=r,navigator.mozGetUserMedia&&(a.onclick=function(){(document.body||document.documentElement).removeChild(a)},(document.body||document.documentElement).appendChild(a));var n=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});a.dispatchEvent(n),navigator.mozGetUserMedia||URL.revokeObjectURL(a.href)}void 0===MediaStream&&"undefined"!=typeof webkitMediaStream&&(MediaStream=webkitMediaStream),void 0!==MediaStream&&("getVideoTracks"in MediaStream.prototype||(MediaStream.prototype.getVideoTracks=function(){if(!this.getTracks)return[];var t=[];return this.getTracks.forEach(function(e){-1!==e.kind.toString().indexOf("video")&&t.push(e)}),t},MediaStream.prototype.getAudioTracks=function(){if(!this.getTracks)return[];var t=[];return this.getTracks.forEach(function(e){-1!==e.kind.toString().indexOf("audio")&&t.push(e)}),t}),"stop"in MediaStream.prototype||(MediaStream.prototype.stop=function(){this.getAudioTracks().forEach(function(e){e.stop&&e.stop()}),this.getVideoTracks().forEach(function(e){e.stop&&e.stop()})}));var Storage={};function isMediaRecorderCompatible(){var e=!!window.opera||0<=navigator.userAgent.indexOf(" OPR/"),t=!!window.chrome&&!e;if(void 0!==window.InstallTrigger)return!0;navigator.appVersion;var i,o,r=navigator.userAgent,a=""+parseFloat(navigator.appVersion),n=parseInt(navigator.appVersion,10);return(t||e)&&(i=r.indexOf("Chrome"),a=r.substring(i+7)),-1!==(o=a.indexOf(";"))&&(a=a.substring(0,o)),-1!==(o=a.indexOf(" "))&&(a=a.substring(0,o)),n=parseInt(""+a,10),isNaN(n)&&(a=""+parseFloat(navigator.appVersion),n=parseInt(navigator.appVersion,10)),49<=n}function MediaStreamRecorder(t,i){var o,r=this;if("audio"===(i=i||{mimeType:"video/webm"}).type){var e;if(t.getVideoTracks().length&&t.getAudioTracks().length)navigator.mozGetUserMedia?(e=new MediaStream).addTrack(t.getAudioTracks()[0]):e=new MediaStream(t.getAudioTracks()),t=e;i.mimeType&&-1!==i.mimeType.toString().toLowerCase().indexOf("audio")||(i.mimeType=isChrome?"audio/webm":"audio/ogg"),i.mimeType&&"audio/ogg"!==i.mimeType.toString().toLowerCase()&&navigator.mozGetUserMedia&&(i.mimeType="audio/ogg")}this.record=function(){r.blob=null;var e=i;i.disableLogs||webrtcdev.log("Passing following config over MediaRecorder API.",e),o&&(o=null),isChrome&&!isMediaRecorderCompatible()&&(e="video/vp8");try{o=new MediaRecorder(t,e)}catch(e){o=new MediaRecorder(t)}"canRecordMimeType"in o&&!1===o.canRecordMimeType(i.mimeType)&&(i.disableLogs||webrtcdev.warn("MediaRecorder API seems unable to record mimeType:",i.mimeType)),o.ignoreMutedMedia=i.ignoreMutedMedia||!1,o.ondataavailable=function(e){r.dontFireOnDataAvailableEvent||!e.data||!e.data.size||e.data.size<100||r.blob||(r.blob=i.getNativeBlob?e.data:new Blob([e.data],{type:i.mimeType||"video/webm"}),r.recordingCallback&&(r.recordingCallback(r.blob),r.recordingCallback=null))},o.onerror=function(e){i.disableLogs||("InvalidState"===e.name?webrtcdev.error("The MediaRecorder is not in a state in which the proposed operation is allowed to be executed."):"OutOfMemory"===e.name?webrtcdev.error("The UA has exhaused the available memory. User agents SHOULD provide as much additional information as possible in the message attribute."):"IllegalStreamModification"===e.name?webrtcdev.error("A modification to the stream has occurred that makes it impossible to continue recording. An example would be the addition of a Track while recording is occurring. User agents SHOULD provide as much additional information as possible in the message attribute."):"OtherRecordingError"===e.name?webrtcdev.error("Used for an fatal error other than those listed above. User agents SHOULD provide as much additional information as possible in the message attribute."):"GenericError"===e.name?webrtcdev.error("The UA cannot provide the codec or recording option that has been requested.",e):webrtcdev.error("MediaRecorder Error",e)),"inactive"!==o.state&&"stopped"!==o.state&&o.stop()},o.start(36e5),i.onAudioProcessStarted&&i.onAudioProcessStarted(),i.initCallback&&i.initCallback()},this.stop=function(t){o&&(this.recordingCallback=function(e){o=null,t&&t(e)},"recording"===o.state&&o.stop())},this.pause=function(){o&&"recording"===o.state&&o.pause()},this.resume=function(){if(this.dontFireOnDataAvailableEvent){this.dontFireOnDataAvailableEvent=!1;var e=i.disableLogs;return i.disableLogs=!0,this.record(),void(i.disableLogs=e)}o&&"paused"===o.state&&o.resume()},this.clearRecordedData=function(){o&&(this.pause(),this.dontFireOnDataAvailableEvent=!0,this.stop())};r=this;!function e(){if(o)return!1===function(){if("active"in t){if(!t.active)return!1}else if("ended"in t&&t.ended)return!1;return!0}()?(i.disableLogs||webrtcdev.log("MediaStream seems stopped."),void r.stop()):void setTimeout(e,1e3)}()}function StereoAudioRecorder(e,o){if(!e.getAudioTracks().length)throw"Your stream has no audio tracks.";var r,a=this,n=[],d=[],s=!1,c=0,u=2;function f(){if("active"in e){if(!e.active)return!1}else if("ended"in e&&e.ended)return!1;return!0}function t(e,t){function i(e,t){var i,o=e.numberOfAudioChannels,r=e.leftBuffers.slice(0),a=e.rightBuffers.slice(0),n=e.sampleRate,d=e.internalInterleavedLength;function s(e,t){for(var i=new Float64Array(t),o=0,r=e.length,a=0;a<r;a++){var n=e[a];i.set(n,o),o+=n.length}return i}function c(e,t,i){for(var o=i.length,r=0;r<o;r++)e.setUint8(t+r,i.charCodeAt(r))}2===o&&(r=s(r,d),a=s(a,d)),1===o&&(r=s(r,d)),2===o&&(i=function(e,t){for(var i=e.length+t.length,o=new Float64Array(i),r=0,a=0;a<i;)o[a++]=e[r],o[a++]=t[r],r++;return o}(r,a)),1===o&&(i=r);var u=i.length,f=new ArrayBuffer(44+2*u),l=new DataView(f);c(l,0,"RIFF"),l.setUint32(4,44+2*u,!0),c(l,8,"WAVE"),c(l,12,"fmt "),l.setUint32(16,16,!0),l.setUint16(20,1,!0),l.setUint16(22,o,!0),l.setUint32(24,n,!0),l.setUint32(28,2*n,!0),l.setUint16(32,2*o,!0),l.setUint16(34,16,!0),c(l,36,"data"),l.setUint32(40,2*u,!0);for(var g=u,m=44,h=0;h<g;h++)l.setInt16(m,32767*i[h],!0),m+=2;if(t)return t({buffer:f,view:l});postMessage({buffer:f,view:l})}if(isChrome){var o,r,a,n=(o=i,r=URL.createObjectURL(new Blob([o.toString(),";this.onmessage =  function (e) {"+o.name+"(e.data);}"],{type:"application/javascript"})),(a=new Worker(r)).workerURL=r,a);n.onmessage=function(e){t(e.data.buffer,e.data.view),URL.revokeObjectURL(n.workerURL)},n.postMessage(e)}else i(e,function(e){t(e.buffer,e.view)})}!0===(o=o||{}).leftChannel&&(u=1),1===o.numberOfAudioChannels&&(u=1),o.disableLogs||webrtcdev.debug("StereoAudioRecorder is set to record number of channels: ",u),this.record=function(){if(!1===f())throw"Please make sure MediaStream is active.";n.length=d.length=0,c=0,l&&l.connect(r),b=v=!1,s=!0},this.stop=function(i){s=!1,t({sampleRate:h,numberOfAudioChannels:u,internalInterleavedLength:c,leftBuffers:n,rightBuffers:1===u?[]:d},function(e,t){a.blob=new Blob([t],{type:"audio/wav"}),a.buffer=new ArrayBuffer(t.buffer.byteLength),a.view=t,a.sampleRate=h,a.bufferSize=m,a.length=c,i&&i(),b=!1})},Storage.AudioContextConstructor||(Storage.AudioContextConstructor=new Storage.AudioContext);var i=Storage.AudioContextConstructor,l=i.createMediaStreamSource(e),g=[0,256,512,1024,2048,4096,8192,16384],m=void 0===o.bufferSize?4096:o.bufferSize;if(-1===g.indexOf(m)&&(o.disableLogs||webrtcdev.warn("Legal values for buffer-size are "+JSON.stringify(g,null,"\t"))),i.createJavaScriptNode)r=i.createJavaScriptNode(m,u,u);else{if(!i.createScriptProcessor)throw"WebAudio API has no support on this browser.";r=i.createScriptProcessor(m,u,u)}l.connect(r),o.bufferSize||(m=r.bufferSize);var h=void 0!==o.sampleRate?o.sampleRate:i.sampleRate||44100;(h<22050||96e3<h)&&(o.disableLogs||webrtcdev.warn("sample-rate must be under range 22050 and 96000.")),o.disableLogs||(webrtcdev.log("sample-rate",h),webrtcdev.log("buffer-size",m));var v=!1;this.pause=function(){v=!0},this.resume=function(){if(!1===f())throw"Please make sure MediaStream is active.";if(!s)return o.disableLogs||webrtcdev.info("Seems recording has been restarted."),void this.record();v=!1};var b=!(this.clearRecordedData=function(){this.pause(),n.length=d.length=0,c=0});r.onaudioprocess=function(e){if(!v)if(!1===f()&&(o.disableLogs||webrtcdev.log("MediaStream seems stopped."),r.disconnect(),s=!1),s){b||(b=!0,o.onAudioProcessStarted&&o.onAudioProcessStarted(),o.initCallback&&o.initCallback());var t=e.inputBuffer.getChannelData(0);if(n.push(new Float32Array(t)),2===u){var i=e.inputBuffer.getChannelData(1);d.push(new Float32Array(i))}c+=m}else l.disconnect()},r.connect(i.destination)}function CanvasRecorder(o,a){if("undefined"==typeof html2canvas&&"canvas"!==o.nodeName.toLowerCase())throw"Please link: https://cdn.webrtc-experiment.com/screenshot.js";(a=a||{}).frameInterval||(a.frameInterval=10);var r=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach(function(e){e in document.createElement("canvas")&&(r=!0)});var i,n,d,e=!(!window.webkitRTCPeerConnection&&!window.webkitGetUserMedia||!window.chrome),t=50,s=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);if(e&&s&&s[2]&&(t=parseInt(s[2],10)),e&&t<52&&(r=!1),r)if(a.disableLogs||webrtcdev.debug("Your browser supports both MediRecorder API and canvas.captureStream!"),o instanceof HTMLCanvasElement)i=o;else{if(!(o instanceof CanvasRenderingContext2D))throw"Please pass either HTMLCanvasElement or CanvasRenderingContext2D.";i=o.canvas}else navigator.mozGetUserMedia&&(a.disableLogs||webrtcdev.error("Canvas recording is NOT supported in Firefox."));this.record=function(){if(d=!0,r){var e;"captureStream"in i?e=i.captureStream(25):"mozCaptureStream"in i?e=i.mozCaptureStream(25):"webkitCaptureStream"in i&&(e=i.webkitCaptureStream(25));try{var t=new MediaStream;t.addTrack(e.getVideoTracks()[0]),e=t}catch(e){}if(!e)throw"captureStream API are NOT available.";(n=new MediaStreamRecorder(e,{mimeType:"video/webm"})).record()}else l.frames=[],f=(new Date).getTime(),u();a.initCallback&&a.initCallback()},this.getWebPImages=function(e){if("canvas"===o.nodeName.toLowerCase()){var r=l.frames.length;l.frames.forEach(function(e,t){var i=r-t;a.disableLogs||webrtcdev.debug(i+"/"+r+" frames remaining"),a.onEncodingCallback&&a.onEncodingCallback(i,r);var o=e.image.toDataURL("image/webp",1);l.frames[t].image=o}),a.disableLogs||webrtcdev.debug("Generating WebM"),e()}else e()};var c=!(this.stop=function(t){d=!1;var i=this;r&&n?n.stop(t):this.getWebPImages(function(){l.compile(function(e){a.disableLogs||webrtcdev.debug("Recording finished!"),i.blob=e,i.blob.forEach&&(i.blob=new Blob([],{type:"video/webm"})),t&&t(i.blob),l.frames=[]})})});function u(){if(c)return f=(new Date).getTime(),setTimeout(u,500);if("canvas"===o.nodeName.toLowerCase()){var e=(new Date).getTime()-f;return f=(new Date).getTime(),l.frames.push({image:(t=document.createElement("canvas"),i=t.getContext("2d"),t.width=o.width,t.height=o.height,i.drawImage(o,0,0),t),duration:e}),void(d&&setTimeout(u,a.frameInterval))}var t,i;html2canvas(o,{grabMouse:void 0===a.showMousePointer||a.showMousePointer,onrendered:function(e){var t=(new Date).getTime()-f;if(!t)return setTimeout(u,a.frameInterval);f=(new Date).getTime(),l.frames.push({image:e.toDataURL("image/webp",1),duration:t}),d&&setTimeout(u,a.frameInterval)}})}this.pause=function(){c=!0},this.resume=function(){c=!1,d||this.record()},this.clearRecordedData=function(){this.pause(),l.frames=[]};var f=(new Date).getTime(),l=new Whammy.Video(100)}function WhammyRecorder(e,o){function i(e){e=void 0!==e?e:10;var t=(new Date).getTime()-d;return t?a?(d=(new Date).getTime(),setTimeout(i,100)):(d=(new Date).getTime(),n.paused&&n.play(),c.drawImage(n,0,0,w.width,w.height),s.frames.push({duration:t,image:w.toDataURL("image/webp")}),void(r||setTimeout(i,e,e))):setTimeout(i,e,e)}(o=o||{}).frameInterval||(o.frameInterval=10),o.disableLogs||webrtcdev.log("Using frames-interval:",o.frameInterval);var r=!(this.record=function(){o.width||(o.width=320),o.height||(o.height=240),o.video||(o.video={width:o.width,height:o.height}),o.canvas||(o.canvas={width:o.width,height:o.height}),w.width=o.canvas.width,w.height=o.canvas.height,c=w.getContext("2d"),o.video&&o.video instanceof HTMLVideoElement?(n=o.video.cloneNode(),o.initCallback&&o.initCallback()):(void 0!==(n=document.createElement("video")).srcObject?n.srcObject=e:n.src=URL.createObjectURL(e),n.onloadedmetadata=function(){o.initCallback&&o.initCallback()},n.width=o.video.width,n.height=o.video.height),n.muted=!0,n.play(),d=(new Date).getTime(),s=new Whammy.Video,o.disableLogs||(webrtcdev.log("canvas resolutions",w.width,"*",w.height),webrtcdev.log("video width/height",n.width||w.width,"*",n.height||w.height)),i(o.frameInterval)}),a=!(this.stop=function(t){r=!0;var i=this;setTimeout(function(){!function(i,e,t,o,r){var a=document.createElement("canvas");a.width=w.width,a.height=w.height;var n,d,s,u=a.getContext("2d"),f=[],l=-1===e,c=e&&0<e&&e<=i.length?e:i.length,g=0,m=0,h=0,v=Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2)),b=t&&0<=t&&t<=1?t:0,p=o&&0<=o&&o<=1?o:0,R=!1;d=-1,s=(n={length:c,functionToLoop:function(e,t){var a,n,d,s=function(){!R&&d-a<=d*p||(l&&(R=!0),f.push(i[t])),e()};if(R)s();else{var c=new Image;c.onload=function(){u.drawImage(c,0,0,w.width,w.height);var e=u.getImageData(0,0,w.width,w.height);a=0,n=e.data.length,d=e.data.length/4;for(var t=0;t<n;t+=4){var i=e.data[t],o=e.data[t+1],r=e.data[t+2];Math.sqrt(Math.pow(i-g,2)+Math.pow(o-m,2)+Math.pow(r-h,2))<=v*b&&a++}s()},c.src=i[t].image}},callback:function(){(f=f.concat(i.slice(c))).length<=0&&f.push(i[i.length-1]),r(f)}}).length,function e(){++d!==s?n.functionToLoop(e,d):n.callback()}()}(s.frames,-1,null,null,function(e){s.frames=e,o.advertisement&&o.advertisement.length&&(s.frames=o.advertisement.concat(s.frames)),s.compile(function(e){i.blob=e,i.blob.forEach&&(i.blob=new Blob([],{type:"video/webm"})),t&&t(i.blob)})})},10)});this.pause=function(){a=!0},this.resume=function(){a=!1,r&&this.record()},this.clearRecordedData=function(){this.pause(),s.frames=[]};var n,d,s,w=document.createElement("canvas"),c=w.getContext("2d")}void 0!==AudioContext?Storage.AudioContext=AudioContext:"undefined"!=typeof webkitAudioContext&&(Storage.AudioContext=webkitAudioContext),void 0!==RecordRTC&&(RecordRTC.Storage=Storage),void 0!==RecordRTC&&(RecordRTC.MediaStreamRecorder=MediaStreamRecorder),void 0!==RecordRTC&&(RecordRTC.StereoAudioRecorder=StereoAudioRecorder),void 0!==RecordRTC&&(RecordRTC.CanvasRecorder=CanvasRecorder),void 0!==RecordRTC&&(RecordRTC.WhammyRecorder=WhammyRecorder);var Whammy=function(){function e(e){this.frames=[],this.duration=e||1,this.quality=.8}function a(e){function c(e,i,t){return[{data:e,id:231}].concat(t.map(function(e){var t=function(e){var t=0;e.keyframe&&(t|=128);e.invisible&&(t|=8);e.lacing&&(t|=e.lacing<<1);e.discardable&&(t|=1);if(127<e.trackNum)throw"TrackNumber > 127 not supported";return[128|e.trackNum,e.timecode>>8,255&e.timecode,t].map(function(e){return String.fromCharCode(e)}).join("")+e.frame}({discardable:0,frame:e.data.slice(4),invisible:0,keyframe:1,lacing:0,trackNum:1,timecode:Math.round(i)});return i+=e.duration,{data:t,id:163}}))}function u(e){for(var t=[];0<e;)t.push(255&e),e>>=8;return new Uint8Array(t.reverse())}function f(e){var t=[];e=(e.length%8?new Array(9-e.length%8).join("0"):"")+e;for(var i=0;i<e.length;i+=8)t.push(parseInt(e.substr(i,8),2));return new Uint8Array(t)}var t=new function(e){var t=function(e){if(e[0]){for(var t=e[0].width,i=e[0].height,o=e[0].duration,r=1;r<e.length;r++)o+=e[r].duration;return{duration:o,width:t,height:i}}postMessage({error:"Something went wrong. Maybe WebP format is not supported in the current browser."})}(e);if(!t)return[];for(var i,o=[{id:440786851,data:[{data:1,id:17030},{data:1,id:17143},{data:4,id:17138},{data:8,id:17139},{data:"webm",id:17026},{data:2,id:17031},{data:2,id:17029}]},{id:408125543,data:[{id:357149030,data:[{data:1e6,id:2807729},{data:"whammy",id:19840},{data:"whammy",id:22337},{data:(i=t.duration,[].slice.call(new Uint8Array(new Float64Array([i]).buffer),0).map(function(e){return String.fromCharCode(e)}).reverse().join("")),id:17545}]},{id:374648427,data:[{id:174,data:[{data:1,id:215},{data:1,id:29637},{data:0,id:156},{data:"und",id:2274716},{data:"V_VP8",id:134},{data:"VP8",id:2459272},{data:1,id:131},{id:224,data:[{data:t.width,id:176},{data:t.height,id:186}]}]}]}]}],r=0,a=0;r<e.length;){for(var n=[],d=0;n.push(e[r]),d+=e[r].duration,++r<e.length&&d<3e4;);var s={id:524531317,data:c(a,0,n)};o[1].data.push(s),a+=d}return function e(t){for(var i=[],o=0;o<t.length;o++){var r=t[o].data;"object"===(void 0===r?"undefined":_typeof(r))&&(r=e(r)),"number"==typeof r&&(r=f(r.toString(2))),"string"==typeof r&&(r=new Uint8Array(r.split("").map(function(e){return e.charCodeAt(0)})));var a=r.size||r.byteLength||r.length,n=Math.ceil(Math.ceil(Math.log(a)/Math.log(2))/8),d=a.toString(2),s=new Array(7*n+7+1-d.length).join("0")+d,c=new Array(n).join("0")+"1"+s;i.push(u(t[o].id)),i.push(f(c)),i.push(r)}return new Blob(i,{type:"video/webm"})}(o)}(e.map(function(e){var t=function(e){for(var t=e.RIFF[0].WEBP[0],i=t.indexOf("*"),o=0,r=[];o<4;o++)r[o]=t.charCodeAt(i+3+o);return{width:16383&(r[1]<<8|r[0]),height:16383&(r[3]<<8|r[2]),data:t,riff:e}}(function e(t){for(var i,o=0,r={};o<t.length;){var a=t.substr(o,4),n=(i=o,parseInt(t.substr(i+4,4).split("").map(function(e){var t=e.charCodeAt(0).toString(2);return new Array(8-t.length+1).join("0")+t}).join(""),2)),d=t.substr(o+4+4,n);o+=8+n,r[a]=r[a]||[],"RIFF"===a||"LIST"===a?r[a].push(e(d)):r[a].push(d)}return r}(atob(e.image.slice(23))));return t.duration=e.duration,t}));postMessage(t)}return e.prototype.add=function(e,t){if("canvas"in e&&(e=e.canvas),"toDataURL"in e&&(e=e.toDataURL("image/webp",this.quality)),!/^data:image\/webp;base64,/gi.test(e))throw"Input must be formatted properly as a base64 encoded DataURI of type image/webp";this.frames.push({image:e,duration:t||this.duration})},e.prototype.compile=function(t){var e,i,o,r=(e=a,i=URL.createObjectURL(new Blob([e.toString(),"this.onmessage =  function (e) {"+e.name+"(e.data);}"],{type:"application/javascript"})),o=new Worker(i),URL.revokeObjectURL(i),o);r.onmessage=function(e){e.data.error?webrtcdev.error(e.data.error):t(e.data)},r.postMessage(this.frames)},{Video:e}}();void 0!==RecordRTC&&(RecordRTC.Whammy=Whammy);var DiskStorage={init:function(){var i=this;if("undefined"!=typeof indexedDB&&void 0!==indexedDB.open){var o,e=this.dbName||location.href.replace(/\/|:|#|%|\.|\[|\]/g,""),t=indexedDB.open(e,1);t.onerror=i.onError,t.onsuccess=function(){((o=t.result).onerror=i.onError,o.setVersion)?1!==o.version?o.setVersion(1).onsuccess=function(){r(o),a()}:a():a()},t.onupgradeneeded=function(e){r(e.target.result)}}else webrtcdev.error("IndexedDB API are not available in this browser.");function r(e){e.createObjectStore(i.dataStoreName)}function a(){var e=o.transaction([i.dataStoreName],"readwrite");function t(t){e.objectStore(i.dataStoreName).get(t).onsuccess=function(e){i.callback&&i.callback(e.target.result,t)}}i.videoBlob&&e.objectStore(i.dataStoreName).put(i.videoBlob,"videoBlob"),i.gifBlob&&e.objectStore(i.dataStoreName).put(i.gifBlob,"gifBlob"),i.audioBlob&&e.objectStore(i.dataStoreName).put(i.audioBlob,"audioBlob"),t("audioBlob"),t("videoBlob"),t("gifBlob")}},Fetch:function(e){return this.callback=e,this.init(),this},Store:function(e){return this.audioBlob=e.audioBlob,this.videoBlob=e.videoBlob,this.gifBlob=e.gifBlob,this.init(),this},onError:function(e){webrtcdev.error(JSON.stringify(e,null,"\t"))},dataStoreName:"recordRTC",dbName:null};function GifRecorder(e,i){if("undefined"==typeof GIFEncoder)throw"Please link: https://cdn.webrtc-experiment.com/gif-recorder.js";i=i||{};var o=e instanceof CanvasRenderingContext2D||e instanceof HTMLCanvasElement;this.record=function(){o||(i.width||(i.width=d.offsetWidth||320),this.height||(i.height=d.offsetHeight||240),i.video||(i.video={width:i.width,height:i.height}),i.canvas||(i.canvas={width:i.width,height:i.height}),a.width=i.canvas.width,a.height=i.canvas.height,d.width=i.video.width,d.height=i.video.height),(c=new GIFEncoder).setRepeat(0),c.setDelay(i.frameRate||200),c.setQuality(i.quality||10),c.start(),Date.now();u=requestAnimationFrame(function e(t){if(r)return setTimeout(function(){e(t)},100);u=requestAnimationFrame(e),void 0===(void 0===s?"undefined":_typeof(s))&&(s=t),t-s<90||(!o&&d.paused&&d.play(),o||n.drawImage(d,0,0,a.width,a.height),i.onGifPreview&&i.onGifPreview(a.toDataURL("image/png")),c.addFrame(n),s=t)}),i.initCallback&&i.initCallback()};var r=!(this.stop=function(){u&&cancelAnimationFrame(u),Date.now(),this.blob=new Blob([new Uint8Array(c.stream().bin)],{type:"image/gif"}),c.stream().bin=[]});this.pause=function(){r=!0},this.resume=function(){r=!1},this.clearRecordedData=function(){c&&(this.pause(),c.stream().bin=[])};var a=document.createElement("canvas"),n=a.getContext("2d");if(o&&(e instanceof CanvasRenderingContext2D?a=(n=e).canvas:e instanceof HTMLCanvasElement&&(n=e.getContext("2d"),a=e)),!o){var d=document.createElement("video");d.muted=!0,d.autoplay=!0,void 0!==d.srcObject?d.srcObject=e:d.src=URL.createObjectURL(e),d.play()}var s,c,u=null}void 0!==RecordRTC&&(RecordRTC.DiskStorage=DiskStorage),void 0!==RecordRTC&&(RecordRTC.GifRecorder=GifRecorder);
"";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function h2clog(t){_html2canvas.logging&&window.webrtcdev&&window.webrtcdev.log&&window.webrtcdev.log(t)}function backgroundBoundsFactory(t,e,n,a,o,r){var i,l,c,d,s=_html2canvas.Util.getCSS(e,t,o);if(1===s.length&&(d=s[0],(s=[])[0]=d,s[1]=d),-1!==s[0].toString().indexOf("%"))c=parseFloat(s[0])/100,l=n.width*c,"backgroundSize"!==t&&(l-=(r||a).width*c);else if("backgroundSize"===t)if("auto"===s[0])l=a.width;else if(s[0].match(/contain|cover/)){var h=_html2canvas.Util.resizeBounds(a.width,a.height,n.width,n.height,s[0]);l=h.width,i=h.height}else l=parseInt(s[0],10);else l=parseInt(s[0],10);return"auto"===s[1]?i=l/a.width*a.height:-1!==s[1].toString().indexOf("%")?(c=parseFloat(s[1])/100,i=n.height*c,"backgroundSize"!==t&&(i-=(r||a).height*c)):i=parseInt(s[1],10),[l,i]}function h2czContext(t){return{zindex:t,children:[]}}function h2cRenderContext(t,e){var n=[];return{storage:n,width:t,height:e,clip:function(){n.push({type:"function",name:"clip",arguments:arguments})},translate:function(){n.push({type:"function",name:"translate",arguments:arguments})},fill:function(){n.push({type:"function",name:"fill",arguments:arguments})},save:function(){n.push({type:"function",name:"save",arguments:arguments})},restore:function(){n.push({type:"function",name:"restore",arguments:arguments})},fillRect:function(){n.push({type:"function",name:"fillRect",arguments:arguments})},createPattern:function(){n.push({type:"function",name:"createPattern",arguments:arguments})},drawShape:function(){var t=[];return n.push({type:"function",name:"drawShape",arguments:t}),{moveTo:function(){t.push({name:"moveTo",arguments:arguments})},lineTo:function(){t.push({name:"lineTo",arguments:arguments})},arcTo:function(){t.push({name:"arcTo",arguments:arguments})},bezierCurveTo:function(){t.push({name:"bezierCurveTo",arguments:arguments})},quadraticCurveTo:function(){t.push({name:"quadraticCurveTo",arguments:arguments})}}},drawImage:function(){n.push({type:"function",name:"drawImage",arguments:arguments})},fillText:function(){n.push({type:"function",name:"fillText",arguments:arguments})},setVariable:function(t,e){n.push({type:"variable",name:t,arguments:e})}}}function getMouseXY(t){return IE?(coordX=event.clientX+document.body.scrollLeft,coordY=event.clientY+document.body.scrollTop):(coordX=t.pageX,coordY=t.pageY),coordX<0&&(coordX=0),coordY<0&&(coordY=0),!0}var previousElement,computedCSS,html2canvas,_html2canvas={};_html2canvas.Util={},_html2canvas.Util.trimText=function(e){return function(t){return e?e.apply(t):((t||"")+"").replace(/^\s+|\s+$/g,"")}}(String.prototype.trim),_html2canvas.Util.parseBackgroundImage=function(t){var e,n,a,o,r,i,l,c,d=[],s=0,h=0,u=function(){e&&('"'===n.substr(0,1)&&(n=n.substr(1,n.length-2)),n&&c.push(n),"-"===e.substr(0,1)&&0<(o=e.indexOf("-",1)+1)&&(a=e.substr(0,o),e=e.substr(o)),d.push({prefix:a,method:e.toLowerCase(),value:r,args:c})),c=[],e=a=n=r=""};u();for(var m=0,g=t.length;m<g;m++)if(i=t[m],!(0===s&&-1<" \r\n\t".indexOf(i))){switch(i){case'"':l?l===i&&(l=null):l=i;break;case"(":if(l)break;if(0===s){s=1,r+=i;continue}h++;break;case")":if(l)break;if(1===s){if(0===h){s=0,r+=i,u();continue}h--}break;case",":if(l)break;if(0===s){u();continue}if(1===s&&0===h&&!e.match(/^url$/i)){c.push(n),n="",r+=i;continue}}r+=i,0===s?e+=i:n+=i}return u(),d},_html2canvas.Util.Bounds=function(t){var e,n={};if(t.getBoundingClientRect)return e=t.getBoundingClientRect(),n.top=e.top,n.bottom=e.bottom||e.top+e.height,n.left=e.left,n.width=e.width||e.right-e.left,n.height=e.height||e.bottom-e.top,n},_html2canvas.Util.getCSS=function(r,t,e){function n(t,e){var n,a=r.runtimeStyle&&r.runtimeStyle[t],o=r.style;return!/^-?[0-9]+\.?[0-9]*(?:px)?$/i.test(e)&&/^-?\d/.test(e)&&(n=o.left,a&&(r.runtimeStyle.left=r.currentStyle.left),o.left="fontSize"===t?"1em":e||0,e=o.pixelLeft+"px",o.left=n,a&&(r.runtimeStyle.left=a)),/^(thin|medium|thick)$/i.test(e)?e:Math.round(parseFloat(e))+"px"}var a,o=t.match(/^background(Size|Position)$/);if(previousElement!==r&&(computedCSS=document.defaultView.getComputedStyle(r,null)),a=computedCSS[t],o)if(a=(a=(a||"").split(","))[e||0]||a[0]||"auto",a=_html2canvas.Util.trimText(a).split(" "),"backgroundSize"!==t||a[0]&&!a[0].match(/cover|contain|auto/)){if(a[0]=-1===a[0].indexOf("%")?n(t+"X",a[0]):a[0],void 0===a[1]){if("backgroundSize"===t)return a[1]="auto",a;a[1]=a[0]}a[1]=-1===a[1].indexOf("%")?n(t+"Y",a[1]):a[1]}else;else if(/border(Top|Bottom)(Left|Right)Radius/.test(t)){var i=a.split(" ");i.length<=1&&(i[1]=i[0]),i[0]=parseInt(i[0],10),i[1]=parseInt(i[1],10),a=i}return a},_html2canvas.Util.resizeBounds=function(t,e,n,a,o){var r,i,l=t/e;return o&&"auto"!==o?n/a<l^"contain"===o?r=(i=a)*l:i=(r=n)/l:(r=n,i=a),{width:r,height:i}},_html2canvas.Util.BackgroundPosition=function(t,e,n,a,o){var r=backgroundBoundsFactory("backgroundPosition",t,e,n,a,o);return{left:r[0],top:r[1]}},_html2canvas.Util.BackgroundSize=function(t,e,n,a){var o=backgroundBoundsFactory("backgroundSize",t,e,n,a);return{width:o[0],height:o[1]}},_html2canvas.Util.Extend=function(t,e){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},_html2canvas.Util.Children=function(t){var e,n,a;try{e=t.nodeName&&"IFRAME"===t.nodeName.toUpperCase()?t.contentDocument||t.contentWindow.document:(n=t.childNodes,a=[],null!==n&&function(t,e){var n=t.length,a=0;if("number"==typeof e.length)for(var o=e.length;a<o;a++)t[n++]=e[a];else for(;void 0!==e[a];)t[n++]=e[a++];t.length=n}(a,n),a)}catch(t){h2clog("html2canvas.Util.Children failed with exception: "+t.message),e=[]}return e},_html2canvas.Util.Font=function(){var d={};return function(t,e,n){if(void 0!==d[t+"-"+e])return d[t+"-"+e];var a,o,r=n.createElement("div"),i=n.createElement("img"),l=n.createElement("span"),c="Hidden Text";return r.style.visibility="hidden",r.style.fontFamily=t,r.style.fontSize=e,r.style.margin=0,r.style.padding=0,n.body.appendChild(r),i.src="data:image/gif;base64,R0lGODlhAQABAIABAP///wAAACwAAAAAAQABAAACAkQBADs=",i.width=1,i.height=1,i.style.margin=0,i.style.padding=0,i.style.verticalAlign="baseline",l.style.fontFamily=t,l.style.fontSize=e,l.style.margin=0,l.style.padding=0,l.appendChild(n.createTextNode(c)),r.appendChild(l),r.appendChild(i),a=i.offsetTop-l.offsetTop+1,r.removeChild(l),r.appendChild(n.createTextNode(c)),r.style.lineHeight="normal",i.style.verticalAlign="super",o={baseline:a,lineWidth:1,middle:i.offsetTop-r.offsetTop+1},d[t+"-"+e]=o,n.body.removeChild(r),o}}(),function(){_html2canvas.Generate={};var p=[/^(-webkit-linear-gradient)\(([a-z\s]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-o-linear-gradient)\(([a-z\s]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-webkit-gradient)\((linear|radial),\s((?:\d{1,3}%?)\s(?:\d{1,3}%?),\s(?:\d{1,3}%?)\s(?:\d{1,3}%?))([\w\d\.\s,%\(\)\-]+)\)$/,/^(-moz-linear-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?))([\w\d\.\s,%\(\)]+)\)$/,/^(-webkit-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s([a-z\-]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-moz-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s?([a-z\-]*)([\w\d\.\s,%\(\)]+)\)$/,/^(-o-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s([a-z\-]+)([\w\d\.\s,%\(\)]+)\)$/];_html2canvas.Generate.parseGradient=function(t,e){var n,a,o,r,i,l,c,d,s,h,u,m,g=p.length;for(a=0;a<g&&!(o=t.match(p[a]));a+=1);if(o)switch(o[1]){case"-webkit-linear-gradient":case"-o-linear-gradient":if(n={type:"linear",x0:null,y0:null,x1:null,y1:null,colorStops:[]},i=o[2].match(/\w+/g))for(l=i.length,a=0;a<l;a+=1)switch(i[a]){case"top":n.y0=0,n.y1=e.height;break;case"right":n.x0=e.width,n.x1=0;break;case"bottom":n.y0=e.height,n.y1=0;break;case"left":n.x0=0,n.x1=e.width}if(null===n.x0&&null===n.x1&&(n.x0=n.x1=e.width/2),null===n.y0&&null===n.y1&&(n.y0=n.y1=e.height/2),i=o[3].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}(?:%|px))?)+/g))for(l=i.length,c=1/Math.max(l-1,1),a=0;a<l;a+=1)(d=i[a].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%|px)?/))[2]?(r=parseFloat(d[2]),"%"===d[3]?r/=100:r/=e.width):r=a*c,n.colorStops.push({color:d[1],stop:r});break;case"-webkit-gradient":if(n={type:"radial"===o[2]?"circle":o[2],x0:0,y0:0,x1:0,y1:0,colorStops:[]},(i=o[3].match(/(\d{1,3})%?\s(\d{1,3})%?,\s(\d{1,3})%?\s(\d{1,3})%?/))&&(n.x0=i[1]*e.width/100,n.y0=i[2]*e.height/100,n.x1=i[3]*e.width/100,n.y1=i[4]*e.height/100),i=o[4].match(/((?:from|to|color-stop)\((?:[0-9\.]+,\s)?(?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)\))+/g))for(l=i.length,a=0;a<l;a+=1)d=i[a].match(/(from|to|color-stop)\(([0-9\.]+)?(?:,\s)?((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\)/),r=parseFloat(d[2]),"from"===d[1]&&(r=0),"to"===d[1]&&(r=1),n.colorStops.push({color:d[3],stop:r});break;case"-moz-linear-gradient":if(n={type:"linear",x0:0,y0:0,x1:0,y1:0,colorStops:[]},(i=o[2].match(/(\d{1,3})%?\s(\d{1,3})%?/))&&(n.x0=i[1]*e.width/100,n.y0=i[2]*e.height/100,n.x1=e.width-n.x0,n.y1=e.height-n.y0),i=o[3].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}%)?)+/g))for(l=i.length,c=1/Math.max(l-1,1),a=0;a<l;a+=1)(d=i[a].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%)?/))[2]?(r=parseFloat(d[2]),d[3]&&(r/=100)):r=a*c,n.colorStops.push({color:d[1],stop:r});break;case"-webkit-radial-gradient":case"-moz-radial-gradient":case"-o-radial-gradient":if(n={type:"circle",x0:0,y0:0,x1:e.width,y1:e.height,cx:0,cy:0,rx:0,ry:0,colorStops:[]},(i=o[2].match(/(\d{1,3})%?\s(\d{1,3})%?/))&&(n.cx=i[1]*e.width/100,n.cy=i[2]*e.height/100),i=o[3].match(/\w+/),d=o[4].match(/[a-z\-]*/),i&&d)switch(d[0]){case"farthest-corner":case"cover":case"":s=Math.sqrt(Math.pow(n.cx,2)+Math.pow(n.cy,2)),h=Math.sqrt(Math.pow(n.cx,2)+Math.pow(n.y1-n.cy,2)),u=Math.sqrt(Math.pow(n.x1-n.cx,2)+Math.pow(n.y1-n.cy,2)),m=Math.sqrt(Math.pow(n.x1-n.cx,2)+Math.pow(n.cy,2)),n.rx=n.ry=Math.max(s,h,u,m);break;case"closest-corner":s=Math.sqrt(Math.pow(n.cx,2)+Math.pow(n.cy,2)),h=Math.sqrt(Math.pow(n.cx,2)+Math.pow(n.y1-n.cy,2)),u=Math.sqrt(Math.pow(n.x1-n.cx,2)+Math.pow(n.y1-n.cy,2)),m=Math.sqrt(Math.pow(n.x1-n.cx,2)+Math.pow(n.cy,2)),n.rx=n.ry=Math.min(s,h,u,m);break;case"farthest-side":"circle"===i[0]?n.rx=n.ry=Math.max(n.cx,n.cy,n.x1-n.cx,n.y1-n.cy):(n.type=i[0],n.rx=Math.max(n.cx,n.x1-n.cx),n.ry=Math.max(n.cy,n.y1-n.cy));break;case"closest-side":case"contain":"circle"===i[0]?n.rx=n.ry=Math.min(n.cx,n.cy,n.x1-n.cx,n.y1-n.cy):(n.type=i[0],n.rx=Math.min(n.cx,n.x1-n.cx),n.ry=Math.min(n.cy,n.y1-n.cy))}if(i=o[5].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}(?:%|px))?)+/g))for(l=i.length,c=1/Math.max(l-1,1),a=0;a<l;a+=1)(d=i[a].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%|px)?/))[2]?(r=parseFloat(d[2]),"%"===d[3]?r/=100:r/=e.width):r=a*c,n.colorStops.push({color:d[1],stop:r})}return n},_html2canvas.Generate.Gradient=function(e,t){if(0!==t.width&&0!==t.height){var n,a,o,r,i=document.createElement("canvas"),l=i.getContext("2d");if(i.width=t.width,i.height=t.height,n=_html2canvas.Generate.parseGradient(e,t))if("linear"===n.type){for(a=l.createLinearGradient(n.x0,n.y0,n.x1,n.y1),o=0,r=n.colorStops.length;o<r;o+=1)try{a.addColorStop(n.colorStops[o].stop,n.colorStops[o].color)}catch(t){h2clog(["failed to add color stop: ",t,"; tried to add: ",n.colorStops[o],"; stop: ",o,"; in: ",e])}l.fillStyle=a,l.fillRect(0,0,t.width,t.height)}else if("circle"===n.type){for(a=l.createRadialGradient(n.cx,n.cy,0,n.cx,n.cy,n.rx),o=0,r=n.colorStops.length;o<r;o+=1)try{a.addColorStop(n.colorStops[o].stop,n.colorStops[o].color)}catch(t){h2clog(["failed to add color stop: ",t,"; tried to add: ",n.colorStops[o],"; stop: ",o,"; in: ",e])}l.fillStyle=a,l.fillRect(0,0,t.width,t.height)}else if("ellipse"===n.type){var c=document.createElement("canvas"),d=c.getContext("2d"),s=Math.max(n.rx,n.ry),h=2*s;for(c.width=c.height=h,a=d.createRadialGradient(n.rx,n.ry,0,n.rx,n.ry,s),o=0,r=n.colorStops.length;o<r;o+=1)try{a.addColorStop(n.colorStops[o].stop,n.colorStops[o].color)}catch(t){h2clog(["failed to add color stop: ",t,"; tried to add: ",n.colorStops[o],"; stop: ",o,"; in: ",e])}d.fillStyle=a,d.fillRect(0,0,h,h),l.fillStyle=n.colorStops[o-1].color,l.fillRect(0,0,i.width,i.height),l.drawImage(c,n.cx-n.rx,n.cy-n.ry,2*n.rx,2*n.ry)}return i}},_html2canvas.Generate.ListAlpha=function(t){for(var e,n="";e=t%26,n=String.fromCharCode(e+64)+n,26<26*(t/=26););return n},_html2canvas.Generate.ListRoman=function(t){var e,n=["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"],a=[1e3,900,500,400,100,90,50,40,10,9,5,4,1],o="",r=n.length;if(t<=0||4e3<=t)return t;for(e=0;e<r;e+=1)for(;a[e]<=t;)t-=a[e],o+=n[e];return o}}(),_html2canvas.Parse=function(n,m){function g(){return Math.max(Math.max(y.body.scrollWidth,y.documentElement.scrollWidth),Math.max(y.body.offsetWidth,y.documentElement.offsetWidth),Math.max(y.body.clientWidth,y.documentElement.clientWidth))}function p(){return Math.max(Math.max(y.body.scrollHeight,y.documentElement.scrollHeight),Math.max(y.body.offsetHeight,y.documentElement.offsetHeight),Math.max(y.body.clientHeight,y.documentElement.clientHeight))}function f(t,e){var n=parseInt(F(t,e),10);return isNaN(n)?0:n}function C(t,e,n,a,o,r){"transparent"!==r&&(t.setVariable("fillStyle",r),t.fillRect(e,n,a,o),1)}function u(t,e,n,a){null!==t&&0<_html2canvas.Util.trimText(t).length&&(a.fillText(t,e,n),1)}function w(t,e,n,a){var o=F(e,"fontWeight"),r=F(e,"fontFamily"),i=F(e,"fontSize");switch(parseInt(o,10)){case 401:o="bold";break;case 400:o="normal"}if(t.setVariable("fillStyle",a),t.setVariable("font",[F(e,"fontStyle"),F(e,"fontVariant"),o,i,r].join(" ")),t.setVariable("textAlign","left"),"none"!==n)return _html2canvas.Util.Font(r,i,y)}function h(t,e,n,a){var o,r,i,l,c;if(b.rangeBounds)"none"===n&&0===_html2canvas.Util.trimText(e).length||(r=e,i=t.node,l=t.textOffset,(c=y.createRange()).setStart(i,l),c.setEnd(i,l+r.length),o=c.getBoundingClientRect()),t.textOffset+=e.length;else if(t.node&&"string"==typeof t.node.nodeValue){var d=a?t.node.splitText(e.length):null;o=function(t){var e=t.parentNode,n=y.createElement("wrapper"),a=t.cloneNode(!0);n.appendChild(t.cloneNode(!0)),e.replaceChild(n,t);var o=_html2canvas.Util.Bounds(n);return e.replaceChild(a,n),o}(t.node),t.node=d}return o}function i(t,e,n){var a,o,r,i=n.ctx,l=F(t,"color"),c=F(t,"textDecoration"),d=F(t,"textAlign"),s={node:e,textOffset:0};0<_html2canvas.Util.trimText(e.nodeValue).length&&(e.nodeValue=function(t,e){switch(e){case"lowercase":return t.toLowerCase();case"capitalize":return t.replace(/(^|\s|:|-|\(|\))([a-z])/g,function(t,e,n){if(0<t.length)return e+n.toUpperCase()});case"uppercase":return t.toUpperCase();default:return t}}(e.nodeValue,F(t,"textTransform")),d=d.replace(["-webkit-auto"],["auto"]),o=!m.letterRendering&&/^(left|right|justify|auto)$/.test(d)&&(r=F(t,"letterSpacing"),/^(normal|none|0px)$/.test(r))?e.nodeValue.split(/(\b| )/):e.nodeValue.split(""),a=w(i,t,c,l),m.chinese&&o.forEach(function(t,e){/.*[\u4E00-\u9FA5].*$/.test(t)&&((t=t.split("")).unshift(e,1),o.splice.apply(o,t))}),o.forEach(function(t,e){var n=h(s,t,c,e<o.length-1);n&&(u(t,n.left,n.bottom,i),function(t,e,n,a,o){switch(e){case"underline":C(t,n.left,Math.round(n.top+a.baseline+a.lineWidth),n.width,1,o);break;case"overline":C(t,n.left,Math.round(n.top),n.width,1,o);break;case"line-through":C(t,n.left,Math.ceil(n.top+a.middle+a.lineWidth),n.width,1,o)}}(i,c,n,a,l))}))}function A(t,e,n){var a,o,r,i,l,c,d,s=e.ctx,h=F(t,"listStyleType");if(/^(decimal|decimal-leading-zero|upper-alpha|upper-latin|upper-roman|lower-alpha|lower-greek|lower-latin|lower-roman)$/i.test(h)){if(a=function(t,e){var n,a=function(t){var e=-1,n=1,a=t.parentNode.childNodes;if(t.parentNode){for(;a[++e]!==t;)1===a[e].nodeType&&n++;return n}return-1}(t);switch(e){case"decimal":n=a;break;case"decimal-leading-zero":n=1===a.toString().length?a="0"+a.toString():a.toString();break;case"upper-roman":n=_html2canvas.Generate.ListRoman(a);break;case"lower-roman":n=_html2canvas.Generate.ListRoman(a).toLowerCase();break;case"lower-alpha":n=_html2canvas.Generate.ListAlpha(a).toLowerCase();break;case"upper-alpha":n=_html2canvas.Generate.ListAlpha(a)}return n+=". "}(t,h),r=t,i=a,(d=y.createElement("boundelement")).style.display="inline",l=r.style.listStyleType,r.style.listStyleType="none",d.appendChild(y.createTextNode(i)),r.insertBefore(d,r.firstChild),c=_html2canvas.Util.Bounds(d),r.removeChild(d),r.style.listStyleType=l,o=c,w(s,t,"none",F(t,"color")),"inside"!==F(t,"listStylePosition"))return;s.setVariable("textAlign","left"),u(a,n.left,o.bottom,s)}}function S(t){var e=n[t];return!(!e||!0!==e.succeeded)&&e.img}function R(t,e){var n=Math.max(t.left,e.left),a=Math.max(t.top,e.top);return{left:n,top:a,width:Math.min(t.left+t.width,e.left+e.width)-n,height:Math.min(t.top+t.height,e.top+e.height)-a}}function E(t,e,n,a,o){var r=f(e,"paddingLeft"),i=f(e,"paddingTop"),l=f(e,"paddingRight"),c=f(e,"paddingBottom");d(t,n,0,0,n.width,n.height,a.left+r+o[3].width,a.top+i+o[0].width,a.width-(o[1].width+o[3].width+r+l),a.height-(o[0].width+o[2].width+i+c))}function v(l,c,d,s){var h=function(t,e,n){return{x:t.x+(e.x-t.x)*n,y:t.y+(e.y-t.y)*n}};return{start:l,startControl:c,endControl:d,end:s,subdivide:function(t){var e=h(l,c,t),n=h(c,d,t),a=h(d,s,t),o=h(e,n,t),r=h(n,a,t),i=h(o,r,t);return[v(l,e,o,i),v(i,r,a,s)]},curveTo:function(t){t.push(["bezierCurve",c.x,c.y,d.x,d.y,s.x,s.y])},curveToReversed:function(t){t.push(["bezierCurve",d.x,d.y,c.x,c.y,l.x,l.y])}}}function N(t,e,n,a,o,r,i){0<e[0]||0<e[1]?(t.push(["line",a[0].start.x,a[0].start.y]),a[0].curveTo(t),a[1].curveTo(t)):t.push(["line",r,i]),(0<n[0]||0<n[1])&&t.push(["line",o[0].start.x,o[0].start.y])}function B(t,e,n,a,o,r,i){var l=[];return 0<e[0]||0<e[1]?(l.push(["line",a[1].start.x,a[1].start.y]),a[1].curveTo(l)):l.push(["line",t.c1[0],t.c1[1]]),0<n[0]||0<n[1]?(l.push(["line",r[0].start.x,r[0].start.y]),r[0].curveTo(l),l.push(["line",i[0].end.x,i[0].end.y]),i[0].curveToReversed(l)):(l.push(["line",t.c2[0],t.c2[1]]),l.push(["line",t.c3[0],t.c3[1]])),0<e[0]||0<e[1]?(l.push(["line",o[1].end.x,o[1].end.y]),o[1].curveToReversed(l)):l.push(["line",t.c4[0],t.c4[1]]),l}function M(t,e,n){var a,o,r,i,l,c,d,s,h,u,m,g,p,f,w,v,y,b,x,C,A,S,R,E,M,k,T=e.left,I=e.top,L=e.width,U=e.height,_=(k=t,["TopLeft","TopRight","BottomRight","BottomLeft"].map(function(t){return F(k,"border"+t+"Radius")})),z=(s=_,h=n,u=(d=e).left,m=d.top,g=d.width,p=d.height,f=s[0][0],w=s[0][1],v=s[1][0],y=s[1][1],b=s[2][0],x=s[2][1],C=s[3][0],A=s[3][1],S=g-v,R=p-b,E=g-x,M=p-A,{topLeftOuter:W(u,m,f,w).topLeft.subdivide(.5),topLeftInner:W(u+h[3].width,m+h[0].width,Math.max(0,f-h[3].width),Math.max(0,w-h[0].width)).topLeft.subdivide(.5),topRightOuter:W(u+S,m,v,y).topRight.subdivide(.5),topRightInner:W(u+Math.min(S,g+h[3].width),m+h[0].width,S>g+h[3].width?0:v-h[3].width,y-h[0].width).topRight.subdivide(.5),bottomRightOuter:W(u+E,m+R,x,b).bottomRight.subdivide(.5),bottomRightInner:W(u+Math.min(E,g+h[3].width),m+Math.min(R,p+h[0].width),Math.max(0,x-h[1].width),Math.max(0,b-h[2].width)).bottomRight.subdivide(.5),bottomLeftOuter:W(u,m+M,C,A).bottomLeft.subdivide(.5),bottomLeftInner:W(u+h[3].width,m+M,Math.max(0,C-h[3].width),Math.max(0,A-h[2].width)).bottomLeft.subdivide(.5)}),O={clip:function(t,e,n,a,o){var r=[];switch(F(t,"backgroundClip")){case"content-box":case"padding-box":N(r,a[0],a[1],e.topLeftInner,e.topRightInner,o.left+n[3].width,o.top+n[0].width),N(r,a[1],a[2],e.topRightInner,e.bottomRightInner,o.left+o.width-n[1].width,o.top+n[0].width),N(r,a[2],a[3],e.bottomRightInner,e.bottomLeftInner,o.left+o.width-n[1].width,o.top+o.height-n[2].width),N(r,a[3],a[0],e.bottomLeftInner,e.topLeftInner,o.left+n[3].width,o.top+o.height-n[2].width);break;default:N(r,a[0],a[1],e.topLeftOuter,e.topRightOuter,o.left,o.top),N(r,a[1],a[2],e.topRightOuter,e.bottomRightOuter,o.left+o.width,o.top),N(r,a[2],a[3],e.bottomRightOuter,e.bottomLeftOuter,o.left+o.width,o.top+o.height),N(r,a[3],a[0],e.bottomLeftOuter,e.topLeftOuter,o.left,o.top+o.height)}return r}(t,z,n,_,e),borders:[]};for(a=0;a<4;a++)if(0<n[a].width){switch(o=T,r=I,i=L,l=U-n[2].width,a){case 0:l=n[0].width,c=B({c1:[o,r],c2:[o+i,r],c3:[o+i-n[1].width,r+l],c4:[o+n[3].width,r+l]},_[0],_[1],z.topLeftOuter,z.topLeftInner,z.topRightOuter,z.topRightInner);break;case 1:c=B({c1:[(o=T+L-n[1].width)+(i=n[1].width),r],c2:[o+i,r+l+n[2].width],c3:[o,r+l],c4:[o,r+n[0].width]},_[1],_[2],z.topRightOuter,z.topRightInner,z.bottomRightOuter,z.bottomRightInner);break;case 2:c=B({c1:[o+i,(r=r+U-n[2].width)+(l=n[2].width)],c2:[o,r+l],c3:[o+n[3].width,r],c4:[o+i-n[2].width,r]},_[2],_[3],z.bottomRightOuter,z.bottomRightInner,z.bottomLeftOuter,z.bottomLeftInner);break;case 3:i=n[3].width,c=B({c1:[o,r+l+n[2].width],c2:[o,r],c3:[o+i,r+n[0].width],c4:[o+i,r+l]},_[3],_[0],z.bottomLeftOuter,z.bottomLeftInner,z.topLeftOuter,z.topLeftInner)}O.borders.push({args:c,color:n[a].color})}return O}function k(t,e){var n=t.drawShape();return e.forEach(function(t,e){n[0===e?"moveTo":t[0]+"To"].apply(null,t.slice(1))}),n}function T(e,t,n){var a,o,r=y.createElement("valuewrap");["lineHeight","textAlign","fontFamily","color","fontSize","paddingLeft","paddingTop","width","height","border","borderLeftWidth","borderTopWidth"].forEach(function(t){try{r.style[t]=F(e,t)}catch(t){h2clog("html2canvas: Parse: Exception caught in renderFormValue: "+t.message)}}),r.style.borderColor="black",r.style.borderStyle="solid",r.style.display="block",r.style.position="absolute",(/^(submit|reset|button|text|password)$/.test(e.type)||"SELECT"===e.nodeName)&&(r.style.lineHeight=F(e,"height")),r.style.top=t.top+"px",r.style.left=t.left+"px",(a="SELECT"===e.nodeName?(e.options[e.selectedIndex]||0).text:e.value)||(a=e.placeholder),o=y.createTextNode(a),r.appendChild(o),x.appendChild(r),i(e,o,n),x.removeChild(r)}function d(t){t.drawImage.apply(t,Array.prototype.slice.call(arguments,1)),1}function I(t,e){var n=window.getComputedStyle(t,e);if(n&&n.content&&"none"!==n.content&&"-moz-alt-content"!==n.content){var a=n.content+"",o=a.substr(0,1);o===a.substr(a.length-1)&&o.match(/'|"/)&&(a=a.substr(1,a.length-2));var r="url"===a.substr(0,3),i=document.createElement(r?"img":"span");return i.className=O+"-before "+O+"-after",Object.keys(n).filter(l).forEach(function(t){i.style[t]=n[t]}),r?i.src=_html2canvas.Util.parseBackgroundImage(a)[0].args[0]:i.innerHTML=a,i}}function l(t){return isNaN(window.parseInt(t,10))}function s(t,e,n,a){var o=Math.round(a.left+n.left),r=Math.round(a.top+n.top);t.createPattern(e),t.translate(o,r),t.fill(),t.translate(-o,-r)}function c(t,e,n,a,o,r,i,l){var c=[];c.push(["line",Math.round(o),Math.round(r)]),c.push(["line",Math.round(o+i),Math.round(r)]),c.push(["line",Math.round(o+i),Math.round(l+r)]),c.push(["line",Math.round(o),Math.round(l+r)]),k(t,c),t.save(),t.clip(),s(t,e,n,a),t.restore()}function L(t,e,n,a,o){var r=_html2canvas.Util.BackgroundSize(t,e,a,o),i=_html2canvas.Util.BackgroundPosition(t,e,a,o,r),l=F(t,"backgroundRepeat").split(",").map(function(t){return t.trim()});switch(a=function(t,e){if(t.width===e.width&&t.height===e.height)return t;var n=y.createElement("canvas");return n.width=e.width,n.height=e.height,d(n.getContext("2d"),t,0,0,t.width,t.height,0,0,e.width,e.height),n}(a,r),l=l[o]||l[0]){case"repeat-x":c(n,a,i,e,e.left,e.top+i.top,99999,a.height);break;case"repeat-y":c(n,a,i,e,e.left+i.left,e.top,a.width,99999);break;case"no-repeat":c(n,a,i,e,e.left+i.left,e.top+i.top,a.width,a.height);break;default:s(n,a,i,{top:e.top,left:e.left,width:a.width,height:a.height})}}function U(t,e,n){var a,o,r,i,l,c,d,s,h=h2cRenderContext(e?n.width:g(),e?n.height:p()),u={ctx:h,zIndex:(c=F(t,"zIndex"),d=e?e.zIndex:null,d?"auto"!==c?(s=h2czContext(c),d.children.push(s),s):d:s=h2czContext(0)),opacity:(o=h,r=t,i=e,l=F(r,"opacity")*(i?i.opacity:1),o.setVariable("globalAlpha",l),l),cssPosition:F(t,"position"),borders:(a=t,["Top","Right","Bottom","Left"].map(function(t){return{width:f(a,"border"+t+"Width"),color:F(a,"border"+t+"Color")}})),clip:e&&e.clip?_html2canvas.Util.Extend({},e.clip):null};return!0===m.useOverflow&&!0===/(hidden|scroll|auto)/.test(F(t,"overflow"))&&!1===/(BODY)/i.test(t.nodeName)&&(u.clip=u.clip?R(u.clip,n):n),u.zIndex.children.push(u),u}function o(t,e,n){var a,o,r,i,l,c,d,s,h,u,m,g=_html2canvas.Util.Bounds(t),p=z.test(t.nodeName)?"#efefef":F(t,"backgroundColor"),f=U(t,e,g),w=f.borders,v=f.ctx,y=(o=w,r=g,i=f.clip,l={left:r.left+o[3].width,top:r.top+o[0].width,width:r.width-(o[1].width+o[3].width),height:r.height-(o[0].width+o[2].width)},i&&(l=R(l,i)),l),b=M(t,g,w);switch(k(v,b.clip),v.save(),v.clip(),0<y.height&&0<y.width&&(d=p,C(v,(c=g).left,c.top,c.width,c.height,d),function(t,e,n){for(var a,o=F(t,"backgroundImage"),r=_html2canvas.Util.parseBackgroundImage(o),i=r.length;i--;)(o=r[i]).args&&0!==o.args.length&&((a=S("url"===o.method?o.args[0]:o.value))?L(t,e,n,a,i):h2clog("html2canvas: Error loading background:",o))}(t,y,v)),v.restore(),b.borders.forEach(function(t){var e,n,a;e=v,n=t.args,"transparent"!==(a=t.color)&&(e.setVariable("fillStyle",a),k(e,n),e.fill(),1)}),n||(h=f,u=I(s=t,":before"),m=I(s,":after"),(u||m)&&(u&&(s.className+=" "+O+"-before",s.parentNode.insertBefore(u,s),_(u,h,!0),s.parentNode.removeChild(u),s.className=s.className.replace(O+"-before","").trim()),m&&(s.className+=" "+O+"-after",s.appendChild(m),_(m,h,!0),s.removeChild(m),s.className=s.className.replace(O+"-after","").trim()))),t.nodeName){case"IMG":(a=S(t.getAttribute("src")))?E(v,t,a,g,w):h2clog("html2canvas: Error loading <img>:"+t.getAttribute("src"));break;case"INPUT":/^(text|url|email|submit|button|reset)$/.test(t.type)&&0<(t.value||t.placeholder).length&&T(t,g,f);break;case"TEXTAREA":0<(t.value||t.placeholder||"").length&&T(t,g,f);break;case"SELECT":0<(t.options||t.placeholder||"").length&&T(t,g,f);break;case"LI":A(t,f,y);break;case"VIDEO":var x=document.createElement("canvas");x.width=t.videoWidth||t.clientWidth||320,x.height=t.videoHeight||t.clientHeight||240,x.getContext("2d").drawImage(t,0,0,x.width,x.height),E(v,x,x,g,w);break;case"CANVAS":E(v,t,t,g,w)}return f}function _(e,n,a){var t;"none"===F(t=e,"display")||"hidden"===F(t,"visibility")||t.hasAttribute("data-html2canvas-ignore")||(n=o(e,n,a)||n,z.test(e.nodeName)||("IFRAME"==e.tagName&&(e=e.contentDocument),_html2canvas.Util.Children(e).forEach(function(t){1===t.nodeType?_(t,n,a):3===t.nodeType&&i(e,t,n)})))}var t=void 0===m.elements?document.body:m.elements[0],y=t.ownerDocument,b=_html2canvas.Util.Support(m,y),z=new RegExp("("+m.ignoreElements+")"),x=y.body,F=_html2canvas.Util.getCSS,O="___html2canvas___pseudoelement",e=y.createElement("style");e.innerHTML="."+O+'-before:before { content: "" !important; display: none !important; }.'+O+'-after:after { content: "" !important; display: none !important; }',x.appendChild(e),n=n||{};var P,a,r,V,G,Y,D,q,W=(P=(Math.sqrt(2)-1)/3*4,function(t,e,n,a){var o=n*P,r=a*P,i=t+n,l=e+a;return{topLeft:v({x:t,y:l},{x:t,y:l-r},{x:i-o,y:e},{x:i,y:e}),topRight:v({x:t,y:e},{x:t+o,y:e},{x:i,y:l-r},{x:i,y:l}),bottomRight:v({x:i,y:e},{x:i,y:e+r},{x:t+o,y:l},{x:t,y:l}),bottomLeft:v({x:i,y:l},{x:i-o,y:l},{x:t,y:e+r},{x:t,y:e})}});return q=o(t,null),b.svgRendering&&(a=document.documentElement,r=q,V=new Image,G=g(),Y=p(),D="",function t(e){var n,a,o,r,i,l=_html2canvas.Util.Children(e),c=l.length;for(i=0;i<c;i+=1)if(3===(r=l[i]).nodeType)D+=r.nodeValue.replace(/</g,"&lt;").replace(/>/g,"&gt;");else if(1===r.nodeType&&!/^(script|meta|title)$/.test(r.nodeName.toLowerCase())){if(D+="<"+r.nodeName.toLowerCase(),r.hasAttributes())for(o=(n=r.attributes).length,a=0;a<o;a+=1)D+=" "+n[a].name+'="'+n[a].value+'"';D+=">",t(r),D+="</"+r.nodeName.toLowerCase()+">"}}(a),V.src=["data:image/svg+xml,","<svg xmlns='http://www.w3.org/2000/svg' version='1.1' width='"+G+"' height='"+Y+"'>","<foreignObject width='"+G+"' height='"+Y+"'>","<html xmlns='http://www.w3.org/1999/xhtml' style='margin:0;'>",D.replace(/\#/g,"%23"),"</html>","</foreignObject>","</svg>"].join(""),V.onload=function(){r.svgRender=V}),Array.prototype.slice.call(t.children,0).forEach(function(t){_(t,q)}),q.backgroundColor=F(document.documentElement,"backgroundColor"),x.removeChild(e),q},_html2canvas.Preload=function(i){function l(){h2clog("html2canvas: start: images: "+u.numLoaded+" / "+u.numTotal+" (failed: "+u.numFailed+")"),!u.firstRun&&u.numLoaded>=u.numTotal&&(h2clog("Finished loading images: # "+u.numTotal+" (failed: "+u.numFailed+")"),"function"==typeof i.complete&&i.complete(u))}function o(t,e,n){var a,o,r=i.proxy;w.href=t,t=w.href,a="html2canvas_"+m++,n.callbackname=a,-1<r.indexOf("?")?r+="&":r+="?",r+="url="+encodeURIComponent(t)+"&callback="+a,o=g.createElement("script"),window[a]=function(t){"error:"===t.substring(0,6)?(n.succeeded=!1,u.numLoaded++,u.numFailed++,l()):(d(e,n),e.src=t),window[a]=void 0;try{delete window[a]}catch(t){}o.parentNode.removeChild(o),o=null,delete n.script,delete n.callbackname},o.setAttribute("type","text/javascript"),o.setAttribute("src",r),n.script=o,window.document.body.appendChild(o)}function r(t,e){var n=window.getComputedStyle(t,e),a=n.content;"url"===a.substr(0,3)&&h.loadImage(_html2canvas.Util.parseBackgroundImage(a)[0].args[0]),c(n.backgroundImage,t)}function e(t){return t&&t.method&&t.args&&0<t.args.length}function c(t,o){var r;_html2canvas.Util.parseBackgroundImage(t).filter(e).forEach(function(t){var e,n,a;"url"===t.method?h.loadImage(t.args[0]):t.method.match(/\-?gradient$/)&&(void 0===r&&(r=_html2canvas.Util.Bounds(o)),e=t.value,n=r,void 0!==(a=_html2canvas.Generate.Gradient(e,n))&&(u[e]={img:a,succeeded:!0},u.numTotal++,u.numLoaded++,l()))})}function d(e,n){e.onload=function(){void 0!==n.timer&&window.clearTimeout(n.timer),u.numLoaded++,n.succeeded=!0,e.onerror=e.onload=null,l()},e.onerror=function(){if("anonymous"===e.crossOrigin&&(window.clearTimeout(n.timer),i.proxy)){var t=e.src;return e=new Image,(n.img=e).src=t,void o(e.src,e,n)}u.numLoaded++,u.numFailed++,n.succeeded=!1,e.onerror=e.onload=null,l()}}var s,h,t,n,u={numLoaded:0,numFailed:0,numTotal:0,cleanupDone:!1},m=0,a=i.elements[0]||document.body,g=a.ownerDocument,p=g.images,f=p.length,w=g.createElement("a"),v=void 0!==(new Image).crossOrigin;for(w.href=window.location.href,s=w.protocol+w.host,h={loadImage:function(t){var e,n,a;t&&void 0===u[t]&&(e=new Image,t.match(/data:image\/.*;base64,/i)?(e.src=t.replace(/url\(['"]{0,}|['"]{0,}\)$/gi,""),n=u[t]={img:e},u.numTotal++,d(e,n)):(a=t,w.href=a,w.href=w.href,w.protocol+w.host===s||!0===i.allowTaint?(n=u[t]={img:e},u.numTotal++,d(e,n),e.src=t):v&&!i.allowTaint&&i.useCORS?(e.crossOrigin="anonymous",n=u[t]={img:e},u.numTotal++,d(e,n),e.src=t,e.customComplete=function(){this.img.complete?this.img.onerror():this.timer=window.setTimeout(this.img.customComplete,100)}.bind(n),e.customComplete()):i.proxy&&(n=u[t]={img:e},u.numTotal++,o(t,e,n))))},cleanupDOM:function(t){var e,n;if(!u.cleanupDone){for(n in h2clog(t&&"string"==typeof t?"html2canvas: Cleanup because: "+t:"html2canvas: Cleanup after timeout: "+i.timeout+" ms."),u)if(u.hasOwnProperty(n)&&"object"===(void 0===(e=u[n])?"undefined":_typeof(e))&&e.callbackname&&void 0===e.succeeded){window[e.callbackname]=void 0;try{delete window[e.callbackname]}catch(t){}e.script&&e.script.parentNode&&(e.script.setAttribute("src","about:blank"),e.script.parentNode.removeChild(e.script)),u.numLoaded++,u.numFailed++,h2clog("html2canvas: Cleaned up failed img: '"+n+"' Steps: "+u.numLoaded+" / "+u.numTotal)}void 0!==window.stop?window.stop():void 0!==document.execCommand&&document.execCommand("Stop",!1),void 0!==document.close&&document.close(),u.cleanupDone=!0,t&&"string"==typeof t||l()}},renderingDone:function(){n&&window.clearTimeout(n)}},0<i.timeout&&(n=window.setTimeout(h.cleanupDOM,i.timeout)),h2clog("html2canvas: Preload starts: finding background-images"),u.firstRun=!0,function e(t){var n,a=!1;try{_html2canvas.Util.Children(t).forEach(function(t){e(t)})}catch(t){}try{a=t.nodeType}catch(t){a=!1,h2clog("html2canvas: failed to access some element's nodeType - Exception: "+t.message)}if(1===a||void 0===a){r(n=t,":before"),r(n,":after");try{c(_html2canvas.Util.getCSS(t,"backgroundImage"),t)}catch(t){h2clog("html2canvas: failed to get background-image - Exception: "+t.message)}c(t)}}(a),h2clog("html2canvas: Preload: Finding images"),t=0;t<f;t+=1)h.loadImage(p[t].getAttribute("src"));return u.firstRun=!1,h2clog("html2canvas: Preload: Done."),u.numTotal===u.numLoaded&&l(),h},_html2canvas.Renderer=function(t,n){return function(t){var e;if("string"==typeof n.renderer&&void 0!==_html2canvas.Renderer[t])e=_html2canvas.Renderer[t](n);else{if("function"!=typeof t)throw new Error("Unknown renderer");e=t(n)}if("function"!=typeof e)throw new Error("Invalid renderer defined");return e}(n.renderer)(t,n,document,(a=[],function t(e){var o=[],n=[];e.children.forEach(function(t){t.children&&0<t.children.length?(o.push(t),n.push(t.zindex)):a.push(t)}),n.sort(function(t,e){return t-e}),n.forEach(function(n){var a;o.some(function(t,e){return a=e,t.zindex===n}),t(o.splice(a,1)[0])})}(t.zIndex),a),_html2canvas);var a},_html2canvas.Util.Support=function(t,a){return{rangeBounds:(o=!1,a.createRange&&(e=a.createRange()).getBoundingClientRect&&((n=a.createElement("boundtest")).style.height="123px",n.style.display="block",a.body.appendChild(n),e.selectNode(n),123===e.getBoundingClientRect().height&&(o=!0),a.body.removeChild(n)),o),svgRendering:t.svgRendering&&function(){var t=new Image,e=a.createElement("canvas"),n=void 0!==e.getContext&&e.getContext("2d");if(!1===n)return!1;e.width=e.height=10,t.src=["data:image/svg+xml,","<svg xmlns='http://www.w3.org/2000/svg' width='10' height='10'>","<foreignObject width='10' height='10'>","<div xmlns='http://www.w3.org/1999/xhtml' style='width:10;height:10;'>","sup","</div>","</foreignObject>","</svg>"].join("");try{n.drawImage(t,0,0),e.toDataURL()}catch(t){return!1}return h2clog("html2canvas: Parse: SVG powered rendering available"),!0}()};var e,n,o},window.html2canvas=function(t,e){var n,a,o={logging:!1,elements:t=t.length?t:[t],background:"#fff",proxy:null,timeout:0,useCORS:!1,allowTaint:!1,svgRendering:!1,ignoreElements:"IFRAME|OBJECT|PARAM",useOverflow:!0,letterRendering:!1,chinese:!1,width:null,height:null,taintTest:!0,renderer:"Canvas"};return o=_html2canvas.Util.Extend(e,o),_html2canvas.logging=o.logging,o.complete=function(t){if(!("function"==typeof o.onpreloaded&&!1===o.onpreloaded(t)||(n=_html2canvas.Parse(t,o),"function"==typeof o.onparsed&&!1===o.onparsed(n)||(a=_html2canvas.Renderer(n,o),"function"!=typeof o.onrendered))))if(void 0===o.grabMouse||o.grabMouse){var e=new Image(25,25);e.onload=function(){a.getContext("2d").drawImage(e,coordX,coordY,25,25),o.onrendered(a)},e.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAZCAYAAAAxFw7TAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjExR/NCNwAAAzZJREFUSEut1EtME1EUANBiTTFaivRDKbaFFgiILgxx0bQllYItYKFIgEYoC2oEwqeCC4gG1xg2dmEwEQMJujIxwQ24wA2uCFAB3SBBfqWuyqd/CuV634QSPgOFxElu+mZye+a++948BgAw/mccYAwGIyY7O1vR3NzSiuMLX5GiDoO8tLQ0QzAYDLW1tT2/qEgHJslk8rKtLU9odzcMTU3N7RdB6UBhRkZG6fz8QrCuzgJutwfq6xtazovSgunp6SUOhzPI5XJBr9fD9nYojHjDeVA6MJH0EMGARCIBRKC8vJygO2ZzrSUaSgumpqY+cDjWAlJpCgWSMJlMiO6EqqpMtWehtKBUKi1eXV3zI3wAEhQrJJUGseJHp6G0IE61CKfsl8lkR0CCWiyPAXeU32AwVNChdKAAwUIEfXK5/ARI0IaGRkS3vXp9ofE4SguKxWL92tpfH642LUjQ1lYr+P0Bt1abX3wYPQv04n48FSRoe/sz8Pn8G7m5uboISgfyk5OT72OF3szMzBMgk8k88qyjowPW1zddCoVCS1BaUCQSEdCTlZV18GcOh0ONq6trYGbmJ0xMTO3Z7dMwPj4B4XAYXC7XhkqlKqAFBQJBAS6KB08dClEqlTA8/JUak5cEAkHo6nppMxqN7ZWVVZ0GQ0lnRUXlC6VSVXoamI+gm/RQKEyChYU/u5gYUqvVFDo09AVsNttrHMdh3MAQYyRhxNIeX3y+QLu0tLKlVufC5OQU9Pa+/TgwMPCpv7+fAouKigG/pFX81qV4H4PBwrh8Wg95eOUtLi5vLi+v4FSHRzExRafTNZJ7NptNobOzs2C1Wp+eZx/yEhIS8jwer99ut//icOJvk+mwWCzF3NzvebPZTIF4+ILd/mMcx1ei7UOeUCjUjY19n8YvRYPJVzG4GGk9PT3vRkZGKJDH44PT6STTfxgNjGez4+4idg8Tr+8nx+KvNCcnx4y926mpMUNf33vY2wPo7n71JhpImszer4x5KFmE4zujo98m3W6ve3Dww2eNRvMEW3GLrG4kj26Vj/c5ch+Pg5t4ApXhopFWSDASMcjzg+siIKmWVJm839Nr+Hvp+Nsj4D+5Hdf43ZzjNQAAAABJRU5ErkJggg=="}else o.onrendered(a)},window.setTimeout(function(){_html2canvas.Preload(o)},0),{render:function(t,e){return _html2canvas.Renderer(t,_html2canvas.Util.Extend(e,o))},parse:function(t,e){return _html2canvas.Parse(t,_html2canvas.Util.Extend(e,o))},preload:function(t){return _html2canvas.Preload(_html2canvas.Util.Extend(t,o))},log:h2clog}},window.html2canvas.log=h2clog,window.html2canvas.Renderer={Canvas:void 0},_html2canvas.Renderer.Canvas=function(o){function m(t,e){switch(e.type){case"variable":t[e.name]=e.arguments;break;case"function":if("createPattern"===e.name){if(0<e.arguments[0].width&&0<e.arguments[0].height)try{t.fillStyle=t.createPattern(e.arguments[0],"repeat")}catch(t){h2clog("html2canvas: Renderer: Error creating pattern",t.message)}}else"drawShape"===e.name?(n=t,a=e.arguments,n.beginPath(),a.forEach(function(t){n[t.name].apply(n,t.arguments)}),n.closePath()):"drawImage"===e.name?0<e.arguments[8]&&0<e.arguments[7]&&(!o.taintTest||o.taintTest&&function(t){if(-1===i.indexOf(t.arguments[0].src)){c.drawImage(t.arguments[0],0,0);try{c.getImageData(0,0,1,1)}catch(t){return l=r.createElement("canvas"),c=l.getContext("2d"),!1}i.push(t.arguments[0].src)}return!0}(e))&&t.drawImage.apply(t,e.arguments):t[e.name].apply(t,e.arguments)}var n,a}o=o||{};var r=document,i=[],l=document.createElement("canvas"),c=l.getContext("2d"),g=o.canvas||r.createElement("canvas");return function(t,e,n,a,o){var r,i,l,c,d,s,h,u=g.getContext("2d");if(g.width=g.style.width=e.width||t.ctx.width,g.height=g.style.height=e.height||t.ctx.height,s=u.fillStyle,u.fillStyle="transparent"!==(h=t.backgroundColor)&&"rgba(0, 0, 0, 0)"!==h||void 0===e.background?t.backgroundColor:e.background,u.fillRect(0,0,g.width,g.height),u.fillStyle=s,e.svgRendering&&void 0!==t.svgRender)u.drawImage(t.svgRender,0,0);else for(i=0,l=a.length;i<l;i+=1)(r=a.splice(0,1)[0]).canvasPosition=r.canvasPosition||{},u.textBaseline="bottom",r.clip&&(u.save(),u.beginPath(),u.rect(r.clip.left,r.clip.top,r.clip.width,r.clip.height),u.clip()),r.ctx.storage&&r.ctx.storage.forEach(m.bind(null,u)),r.clip&&u.restore();return h2clog("html2canvas: Renderer: Canvas renderer done - returning canvas obj"),1===(l=e.elements.length)&&"object"===_typeof(e.elements[0])&&"BODY"!==e.elements[0].nodeName?(d=o.Util.Bounds(e.elements[0]),(c=n.createElement("canvas")).width=d.width,c.height=d.height,(u=c.getContext("2d")).drawImage(g,d.left,d.top,d.width,d.height,0,0,d.width,d.height),g=null,c):g}},function(){for(var r=0,t=["ms","moz","webkit","o"],e=0;e<t.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[t[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[e]+"CancelAnimationFrame"]||window[t[e]+"RequestCancelAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,e){var n=(new Date).getTime(),a=Math.max(0,16-(n-r)),o=window.setTimeout(function(){t(n+a)},a);return r=n+a,o}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}();var IE=!!document.all;IE||document.captureEvents(Event.MOUSEMOVE),document.addEventListener("mousemove",getMouseXY,!1);var coordX=0,coordY=0;
"";function createSnapshotButton(t,e){var n=document.createElement("div");return n.id=t+"snapshotButton",n.setAttribute("title","Snapshot"),n.setAttribute("data-placement","bottom"),n.setAttribute("data-toggle","tooltip"),n.setAttribute("data-container","body"),n.className=snapshotobj.button.class_on,n.innerHTML=snapshotobj.button.html_on,n.onclick=function(){takeSnapshot(e,function(t){var e,n="snapshot"+(new Date).getTime();(e=selfuserid?findPeerInfo(selfuserid):findPeerInfo(rtcConn.userid)).filearray.push(n),document.createElement("div").value=e.filearray.length,fileshareobj.active&&(syncSnapshot(t,"imagesnapshot",n),displayList(e.uuid,e,t,n,"imagesnapshot")),displayFile(e.uuid,e,t,n,"imagesnapshot")})},n}function takeSnapshot(t,n){try{return t.videoContainer?function(t){if(t){var e=document.createElement("canvas");e.width=t.videoWidth||t.clientWidth,e.height=t.videoHeight||t.clientHeight,e.getContext("2d").drawImage(t,0,0,e.width,e.height),n(e.toDataURL("image/png"))}else n("")}(document.getElementById(t.videoContainer)):"empty"}catch(t){webrtcdev.error(" [Snapshot - take snapshot] ",t)}}function syncSnapshot(t,e,n){rtcConn.send({type:e,message:t,name:n})}
"";function showPosition(o){webrtcdev.log("Latitude: "+o.coords.latitude+"<br>Longitude: "+o.coords.longitude),latitude=o.coords.latitude,longitude=o.coords.longitude}function showError(o){switch(o.code){case o.PERMISSION_DENIED:shownotification("User denied the request for Geolocation.");break;case o.POSITION_UNAVAILABLE:shownotification("Location information is unavailable.");break;case o.TIMEOUT:shownotification("The request to get user location timed out.");break;case o.UNKNOWN_ERROR:shownotification("An unknown error occurred.")}}navigator.geolocation?(operatingsystem=navigator.platform,navigator.geolocation.getCurrentPosition(showPosition,showError)):x.innerHTML="Geolocation is not supported by this browser.";
"";function createChatButton(e){var t=document.createElement("span");t.className=chatobj.button.class_on,t.innerHTML=chatobj.button.html_on,t.onclick=function(){t.className==chatobj.button.class_off?(document.getElementById(chatobj.container.id).hidden=!0,t.className=chatobj.button.class_on,t.innerHTML=chatobj.button.html_on):t.className==chatobj.button.class_on&&(document.getElementById(chatobj.container.id).hidden=!1,t.className=chatobj.button.class_off,t.innerHTML=chatobj.button.html_off)};var n=document.createElement("li");n.appendChild(t),document.getElementById("topIconHolder_ul").appendChild(n)}function createChatBox(e){var t=document.createElement("div"),n=document.createElement("input");n.setAttribute("type","text"),n.className="form-control chatInputClass",n.id="chatInput",n.onkeypress=function(e){13==e.keyCode&&(sendChatMessage(n.value),n.value="")};var a=document.createElement("span");a.className="btn btn-primary",a.innerHTML="Enter",a.onclick=function(){var e=document.getElementById("chatInput");sendChatMessage(e.value),e.value=""};var o=document.createElement("div");o.className="whoTypingClass",o.id="whoTyping",t.appendChild(n),t.appendChild(a),t.appendChild(o),document.getElementById(chatobj.container.id).appendChild(t);var c=document.createElement("div");c.className="chatMessagesClass",c.setAttribute("contenteditable",!0),c.id=chatobj.chatBox.id,document.getElementById(chatobj.container.id).appendChild(c)}function assignChatBox(e){var n=document.getElementById(chatobj.inputBox.text_id);(n.onkeypress=function(e){if(13==e.keyCode){var t=findPeerInfo(selfuserid);webrtcdev.log(" chat ",selfuserid,t),sendChatMessage(n.value,t),n.value=""}},document.getElementById(chatobj.inputBox.sendbutton_id))&&(document.getElementById(chatobj.inputBox.sendbutton_id).onclick=function(e){var t=findPeerInfo(selfuserid),n=document.getElementById(chatobj.inputBox.text_id);sendChatMessage(n.value,t),n.value=""});document.getElementById(chatobj.inputBox.minbutton_id)&&(document.getElementById(chatobj.inputBox.minbutton_id).onclick=function(e){document.getElementById(chatobj.container.id).hidden?document.getElementById(chatobj.container.id).hidden=!1:document.getElementById(chatobj.container.id).hidden=!0})}function updateWhotyping(e){document.getElementById("whoTyping").innerHTML=e}function sendChatMessage(e,t){addNewMessagelocal({header:rtcConn.extra.username,message:e,userinfo:t,color:rtcConn.extra.color}),rtcConn.send({type:"chat",userinfo:t,message:e})}function replaceURLWithHTMLLinks(e){return e.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi,"<a href='$1'>$1</a>")}function addNewMessagelocal(e){""!=e.message&&" "!=e.message&&addMessageSnapshotFormat("user-activity user-activity-right localMessageClass",e.userinfo,e.message,chatobj.chatBox.id)}function addNewMessage(e){""!=e.message&&" "!=e.message&&addMessageSnapshotFormat("user-activity user-activity-right remoteMessageClass",e.userinfo,e.message,chatobj.chatBox.id)}function addMessageSnapshotFormat(e,t,a,n){var o=document.createElement("div");o.className=e,webrtcdev.log("addNewMessagelocal",t),takeSnapshot(t,function(e){var t=document.createElement("img");t.src=e,t.style.height="40px";var n=document.createElement("span");n.innerHTML=replaceURLWithHTMLLinks(a),o.appendChild(t),o.appendChild(n)}),document.getElementById(n).insertBefore(o,document.getElementById(n).firstChild)}function addMessageLineformat(e,t,n,a){var o=document.createElement("div");o.className=e,o.innerHTML=t?t+" : "+replaceURLWithHTMLLinks(n):replaceURLWithHTMLLinks(n),document.getElementById(a).insertBefore(o,document.getElementById(a).firstChild)}function addMessageBlockFormat(e,t,n,a,o){var c=document.createElement("div");c.className=e,c.innerHTML='<div class="chatusername">'+t+"</div>";var s=document.createElement("div");s.className=n,s.innerHTML=a,c.appendChild(s),$("#"+o).append(s)}$("#chatbox").css("max-height",$("#leftVideo").height()+80),$("#chatBoard").css("max-height",$("#leftVideo").height()),$("#chatBoard").css("overflow-y","scroll");
"";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function appendVideo(o,n){createVideoContainer(o,n,function(t){var e=document.createElement("video");e.className=n,e.setAttribute("style","height:auto;opacity:1;"),e.controls=!1,e.id=o.userid,e.src=URL.createObjectURL(o.stream),viden.hidden=!1;document.getElementById("remote");t.appendChild(e),e.play()})}function createVideoContainer(t,e,o){var n=document.createElement("div");n.setAttribute("style",e||"float:left;opacity: 1;width: 32%;"),remote.insertBefore(n,remote.firstChild),o&&o(n)}function attachUserDetails(t,e){var o=document.createElement("div");o.setAttribute("style","background-color:"+e.color),o.className="videoHeaderClass",o.innerHTML=e.name+"<br/>",t.parentNode.insertBefore(o,t.parentNode.firstChild)}function attachMetaUserDetails(t,e){webrtcdev.log(e.userid+":"+e.type);var o=document.createElement("span");o.setAttribute("style","background-color:"+e.color),o.innerHTML=e.userid+":"+e.type+"<br/>",t.parentNode.insertBefore(o,t.parentNode.firstChild)}function attachControlButtons(t,e){var o=e.stream,n=e.streamid,a=e.controlBarName,r=(e.fileSharingContainer,t.parentNode.childNodes);for(i=0;i<r.length;i++)webrtcdev.log("ChildNode of video Parent ",r[i]),"DIV"==r[i].nodeName&&null!=r[i].id&&-1<r[i].id.indexOf("control")&&(webrtcdev.log("control bar exists already  , delete the previous one before adding new one"),t.parentNode.removeChild(r[i]));var c=document.createElement("div");if(c.id=a,"local"==e.type?c.className="localVideoControlBarClass":c.className="remoteVideoControlBarClass",muteobj.active&&(muteobj.audio.active&&c.appendChild(createAudioMuteButton(a,e)),muteobj.video.active&&c.appendChild(createVideoMuteButton(a,e))),snapshotobj.active&&c.appendChild(createSnapshotButton(a,e)),videoRecordobj.active&&c.appendChild(createRecordButton(a,e,n,o)),cursorobj.active&&c.appendChild(createCursorButton(a,e)),minmaxobj.active&&(c.appendChild(createFullScreenButton(a,e,n,o)),c.appendChild(createMinimizeVideoButton(a,e,n,o))),debug){var m=document.createElement("span");m.innerHTML=t.id,c.appendChild(m)}t.parentNode.appendChild(c)}function createFullScreenButton(t,e,o,n){var a=document.createElement("span");return a.id=t+"fullscreeButton",a.className=minmaxobj.max.button.class_off,a.innerHTML=minmaxobj.max.button.html_off,a.onclick=function(){a.className==minmaxobj.max.button.class_off?(document.getElementById(e.videoContainer).webkitRequestFullScreen(),a.className=minmaxobj.max.button.class_on,a.innerHTML=minmaxobj.max.button.html_on):(a.className=minmaxobj.max.button.class_off,a.innerHTML=minmaxobj.max.button.html_off)},a}function createMinimizeVideoButton(t,e,o,n){var a=document.createElement("span");a.id=t+"minmizevideoButton",a.className=minmaxobj.min.button.class_off,a.innerHTML=minmaxobj.min.button.html_off;var i=document.getElementById(e.videoContainer);return a.onclick=function(){a.className==minmaxobj.min.button.class_off?(i.hidden=!0,a.className=minmaxobj.min.button.class_on,a.innerHTML=minmaxobj.min.button.html_on):(i.hidden=!1,a.className=minmaxobj.min.button.class_off,a.innerHTML=minmaxobj.min.button.html_off)},a}function createAudioMuteButton(t,e){var o=document.createElement("span");return o.id=t+"audioButton",o.setAttribute("data-val","mute"),o.setAttribute("title","Toggle Audio"),o.setAttribute("data-placement","bottom"),o.setAttribute("data-toggle","tooltip"),o.setAttribute("data-container","body"),o.className=muteobj.audio.button.class_on,o.innerHTML=muteobj.audio.button.html_on,o.onclick=function(){o.className==muteobj.audio.button.class_on?(e.stream.mute({audio:!0}),o.className=muteobj.audio.button.class_off,o.innerHTML=muteobj.audio.button.html_off):(e.stream.unmute({audio:!0}),o.className=muteobj.audio.button.class_on,o.innerHTML=muteobj.audio.button.html_on),syncButton(o.id)},o}function createVideoMuteButton(t,e){var o=document.createElement("span");return o.id=t+"videoButton",o.setAttribute("title","Toggle Video"),o.setAttribute("data-container","body"),o.className=muteobj.video.button.class_on,o.innerHTML=muteobj.video.button.html_on,o.onclick=function(t){o.className==muteobj.video.button.class_on?(e.stream.mute({video:!0}),o.innerHTML=muteobj.video.button.html_off,o.className=muteobj.video.button.class_off):(e.stream.unmute({video:!0}),o.innerHTML=muteobj.video.button.html_on,o.className=muteobj.video.button.class_on),syncButton(o.id)},o}function waitForRemoteVideo(t,e,o,n){0===t.getVideoTracks().length||0<e.currentTime?transitionToActive(e,o,n):setTimeout(function(){waitForRemoteVideo(t,e,o,n)},100)}function transitionToActive(t,e,o){t.style.opacity=1,null!=localVideo&&setTimeout(function(){e.src=""},500),null!=miniVideo&&setTimeout(function(){o.style.opacity=1},1e3)}function transitionToWaiting(){card.style.webkitTransform="rotateY(0deg)",setTimeout(function(){localVideo.src=miniVideo.src,localVideo.muted=!0,miniVideo.src="",remoteVideo.src="",localVideo.style.opacity=1},500),miniVideo.style.opacity=0,remoteVideo.style.opacity=0}function attachMediaStream(t,e){try{webrtcdev.log("[ Mediacontrol - attachMediaStream ] element.src",_typeof(t.src),_typeof(t.srcObject)," || stream "+e),e?("string"==typeof t.src?t.src=URL.createObjectURL(e):"object"==_typeof(t.srcObject)?t.srcObject=e:webrtcdev.log("Error attaching stream to element.",t,e),webrtcdev.log(" Media Stream attached to ",t," succesfully")):webrtcdev.debug(" Media Stream not attached to ",t," as stream is not valid ",e)}catch(t){webrtcdev.error(" [ Mediacontrol - attachMediaStream ]  error",t)}}function reattachMediaStream(t,e){t.src=e.src}
"";function createRecordButton(e,o,r,t){var d=document.createElement("div");return d.id=e+"recordButton",d.setAttribute("title","Record"),d.setAttribute("data-placement","bottom"),d.setAttribute("data-toggle","tooltip"),d.setAttribute("data-container","body"),d.className=videoRecordobj.button.class_off,d.innerHTML=videoRecordobj.button.html_off,d.onclick=function(e){d.className==videoRecordobj.button.class_on?(d.className=videoRecordobj.button.class_off,d.innerHTML=videoRecordobj.button.html_off,stopRecord(o,r,t)):d.className==videoRecordobj.button.class_off&&(d.className=videoRecordobj.button.class_on,d.innerHTML=videoRecordobj.button.html_on,startRecord(o,r,t))},d}var listOfRecorders={};function startRecord(e,o,r){var t=RecordRTC(r,{type:"video",recorderType:MediaStreamRecorder});t.startRecording(),listOfRecorders[o]=t}function stopRecord(t,e,o){listOfRecorders[e]||webrtcdev.log("wrong stream id ");var d=listOfRecorders[e];d.stopRecording(function(){var e=d.getBlob();t||(t=selfuserid?findPeerInfo(selfuserid):findPeerInfo(rtcConn.userid));var o="recordedvideo"+(new Date).getTime();t.filearray.push(o),document.createElement("div").value=t.filearray.length;var r=URL.createObjectURL(e);displayList(t.uuid,t,r,o,"videoRecording"),displayFile(t.uuid,t,r,o,"videoRecording")})}function stopSessionRecord(e,o,r,t,d){listOfRecorders[o]||webrtcdev.log("wrong stream id scrrecordStreamid"),listOfRecorders[t]||webrtcdev.log("wrong stream id scrrecordAudioStreamid");var c=listOfRecorders[o];c.stopRecording(function(){var e=c.getBlob();webrtcdev.log(" scrrecordStreamid stopped recoridng blob is ",e)});var i=listOfRecorders[t];i.stopRecording(function(){var e=i.getBlob();webrtcdev.log(" scrrecordStreamid stopped recoridng blob is ",e)})}
"";var scrrecordStream=null,scrrecordStreamid=null,scrrecordAudioStream=null,scrrecordAudioStreamid=null;function syncVideoScreenRecording(e,r,o){rtcMultiConnection.send({type:r,message:e,name:o})}function autorecordScreenVideo(){}function assignScreenRecordButton(){var a=document.getElementById(screenrecordobj.button.id);a.onclick=function(){if(a.className==screenrecordobj.button.class_off)a.className=screenrecordobj.button.class_on,a.innerHTML=screenrecordobj.button.html_on,webrtcdevRecordScreen();else if(a.className==screenrecordobj.button.class_on){var e,r,o;e=selfuserid?findPeerInfo(selfuserid):findPeerInfo(rtcConn.userid),a.className=screenrecordobj.button.class_off,a.innerHTML=screenrecordobj.button.html_off,webrtcdevStopRecordScreen(),stopRecord(e,scrrecordStreamid,scrrecordStream,scrrecordAudioStreamid,scrrecordAudioStream);var t=listOfRecorders[scrrecordStreamid];t.stopRecording(function(){r=t.getBlob()});var n=listOfRecorders[scrrecordAudioStreamid];n.stopRecording(function(){o=n.getBlob()}),setTimeout(function(){webrtcdev.log(" ===2 blobs====",r,o),mergeStreams(r,o),scrrecordAudioStream=scrrecordAudioStreamid=scrrecordStream=scrrecordStreamid=null},5e3)}}}function getSourceIdScreenrecord(e,r){if(!e)throw'"callback" parameter is mandatory.';window.postMessage("webrtcdev-extension-getsourceId-audio-plus-tab","*")}function onScreenrecordExtensionCallback(e){webrtcdev.log("onScreenrecordExtensionCallback",e),e.data.chromeExtensionStatus&&webrtcdev.log(e.data.chromeExtensionStatus),e.data.sourceId&&("PermissionDeniedError"===e.data.sourceId?webrtcdev.log("permission-denied"):webrtcdevScreenRecordConstraints(e.data.sourceId))}function webrtcdevScreenRecordConstraints(e){webrtcdev.log(" webrtcdevScreenRecordConstraints :"+e),navigator.getUserMedia({audio:!0,video:!1},function(e){var r;r=selfuserid?findPeerInfo(selfuserid):findPeerInfo(rtcConn.userid),scrrecordAudioStreamid=e.id,scrrecordAudioStream=e,startRecord(r,scrrecordAudioStreamid,scrrecordAudioStream)},function(e){webrtcdev.log(" Error in webrtcdevScreenRecordConstraints ",e),isChrome&&"http:"===location.protocol?alert("Please test this WebRTC experiment on HTTPS."):isChrome?alert("Screen capturing is either denied or not supported. Please install chrome extension for screen capturing or run chrome with command-line flag: --enable-usermedia-screen-capturing"):navigator.mozGetUserMedia&&alert(Firefox_Screen_Capturing_Warning)}),navigator.getUserMedia({audio:!1,video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxWidth:1920<window.screen.width?window.screen.width:1920,maxHeight:1080<window.screen.height?window.screen.height:1080},optional:[]}},function(e){var r;r=selfuserid?findPeerInfo(selfuserid):findPeerInfo(rtcConn.userid),scrrecordStreamid=e.id,scrrecordStream=e,startRecord(r,scrrecordStreamid,scrrecordStream)},function(e){webrtcdev.log(" Error in webrtcdevScreenRecordConstraints ",e),isChrome&&"http:"===location.protocol?alert("Please test this WebRTC experiment on HTTPS."):isChrome?alert("Screen capturing is either denied or not supported. Please install chrome extension for screen capturing or run chrome with command-line flag: --enable-usermedia-screen-capturing"):navigator.mozGetUserMedia&&alert(Firefox_Screen_Capturing_Warning)})}function webrtcdevRecordScreen(){webrtcdev.log("webrtcdevRecordScreen"),getSourceIdScreenrecord(function(){},!0)}function webrtcdevStopRecordScreen(){webrtcdev.log("webrtcdevStopRecordScreen screenRoomid"),window.postMessage("webrtcdev-extension-stopsource-screenrecord","*"),scrrecordStream?scrrecordStream.stop():alert(" screen video recoridng was not succesfull"),scrrecordAudioStream?scrrecordAudioStream.stop():alert(" screen audio recording was not successfull")}var worker,workerPath="https://archive.org/download/ffmpeg_asm/ffmpeg_asm.js";function processInWebWorker(){var e=URL.createObjectURL(new Blob(['importScripts("'+workerPath+'");var now = Date.now;function print(text) {postMessage({"type" : "stdout","data" : text});};onmessage = function(event) {var message = event.data;if (message.type === "command") {var Module = {print: print,printErr: print,files: message.files || [],arguments: message.arguments || [],TOTAL_MEMORY: message.TOTAL_MEMORY || false};postMessage({"type" : "start","data" : Module.arguments.join(" ")});postMessage({"type" : "stdout","data" : "Received command: " +Module.arguments.join(" ") +((Module.TOTAL_MEMORY) ? ".  Processing with " + Module.TOTAL_MEMORY + " bits." : "")});var time = now();var result = ffmpeg_run(Module);var totalTime = now() - time;postMessage({"type" : "stdout","data" : "Finished processing (took " + totalTime + "ms)"});postMessage({"type" : "done","data" : result,"time" : totalTime});}};postMessage({"type" : "ready"});'],{type:"application/javascript"})),r=new Worker(e);return URL.revokeObjectURL(e),r}var videoFile=navigator.mozGetUserMedia?"video.gif":"video.webm";function mergeStreams(e,r){var o;o=selfuserid?findPeerInfo(selfuserid):findPeerInfo(rtcConn.userid);var t="recordedvideo"+(new Date).getTime();o.filearray.push(t),document.createElement("div").value=o.filearray.length;var n=URL.createObjectURL(e),a="recordedaudio"+(new Date).getTime();o.filearray.push(a),document.createElement("div").value=o.filearray.length;var d={videofileurl:n,audiofileurl:URL.createObjectURL(r)},i={videoname:t,audioname:a};displayList(o.uuid,o,d,i,"sessionRecording"),displayFile(o.uuid,o,d,i,"sessionRecording")}function convertStreams(e,r){var o,t,n,a,d=!1,i=new FileReader;i.onload=function(){o=this.result,t&&(n=!0),n&&a&&!d&&s()};var c=new FileReader;c.onload=function(){t=this.result,o&&(n=!0),n&&a&&!d&&s()},webrtcdev.log("videoBlob ",e),webrtcdev.log("audioBlob ",r),i.readAsArrayBuffer(e),c.readAsArrayBuffer(r),worker||(worker=processInWebWorker()),worker.onmessage=function(e){var r=e.data;if("ready"==r.type)webrtcdev.log('<a href="'+workerPath+'" download="ffmpeg-asm.js">ffmpeg-asm.js</a> file has been loaded.'),a=!0,n&&s();else if("stdout"==r.type)webrtcdev.log(r.data);else if("start"==r.type)webrtcdev.log('<a href="'+workerPath+'" download="ffmpeg-asm.js">ffmpeg-asm.js</a> file received ffmpeg command.');else if("done"==r.type){webrtcdev.log(JSON.stringify(r));var o=r.data[0];webrtcdev.log(JSON.stringify(o));var t=new Blob([o.data],{type:"video/mp4"});webrtcdev.log(JSON.stringify(t)),PostBlob(t)}};var s=function(){d=!0,worker.postMessage({type:"command",arguments:["-i",videoFile,"-i","audio.wav","-c:v","mpeg4","-c:a","vorbis","-b:v","6400k","-b:a","4800k","-strict","experimental","output.mp4"],files:[{data:new Uint8Array(o),name:videoFile},{data:new Uint8Array(t),name:"audio.wav"}]})}}function PostBlob(e){var r;r=selfuserid?findPeerInfo(selfuserid):findPeerInfo(rtcConn.userid);var o="recordedvideo"+(new Date).getTime();r.filearray.push(o),document.createElement("div").value=r.filearray.length;URL.createObjectURL(e);var t=document.createElement("video");t.controls=!0;var n=document.createElement("source");n.src=URL.createObjectURL(e),n.type="video/mp4; codecs=mpeg4",t.appendChild(n),t.download="Play mp4 in VLC Player.mp4",document.body.appendChild(t),t.tabIndex=0,t.focus(),t.play()}
"";var progressHelper={};function createFileShareButton(e){widgetholder="topIconHolder_ul";var t=document.createElement("span");t.setAttribute("data-provides","fileinput"),t.className=e.button.class,t.innerHTML=e.button.html,t.onclick=function(){(new FileSelector).selectSingleFile(function(e){sendFile(e)})};var i=document.createElement("li");i.appendChild(t),document.getElementById(widgetholder).appendChild(i)}function assignFileShareButton(e){document.getElementById(e.button.id).onclick=function(){(new FileSelector).selectSingleFile(function(e){sendFile(e)})}}function sendFile(e){webrtcdev.log(" [filehsraing js] Send file - ",e),rtcConn.send(e)}function addProgressHelper(e,t,i,n,l){try{if(!t)return void webrtcdev.error(" [filehsraingJs]Progress helpler cannot be added for one peer as its absent");if(!t.fileList.container||!document.getElementById(t.fileList.container))return void webrtcdev.error(" [filehsraingJs] Progress helpler cannot be added , missing fileListcontainer ");if(document.getElementById(i))webrtcdev.log(" Not creating progress bar div as it already exists ");else{webrtcdev.log(" [filehsraingJs] progresshelper ",e,t,i,n,l);var a=document.createElement("div");a.id=i,a.title=e+i,a.setAttribute("class",l),a.innerHTML="<label>0%</label><progress></progress>",document.getElementById(t.fileList.container).appendChild(a),progressHelper[e]={div:a,progress:a.querySelector("progress"),label:a.querySelector("label")},progressHelper[e].progress.max=n}}catch(e){webrtcdev.error(" [filehsraingJs] problem in progress helper ",e)}}function requestOldFiles(){try{rtcConn.send({type:"syncOldFiles"})}catch(e){webrtcdev.error("[filesharing js ] syncOldFiles",e)}}function sendOldFiles(){var e=[];for(x in webcallpeers){webrtcdev.log(" Checking Old Files in index ",x);var t=webcallpeers[x];if(t.filearray&&0<t.filearray.length)for(y in t.filearray){for(o in e)if(e[o].name==t.filearray[y].name)break;webrtcdev.log(" ======== user.filearray[y]",t.filearray[y]),e.push(t.filearray[y])}}setTimeout(function(){if(0<e.length)for(f in webrtcdev.log(" [filehsraing js] sendOldFiles ",e),e)sendFile(e[f])},2e4)}function addNewFileLocal(e){webrtcdev.log("addNewFileLocal message ",e),""!=e.message&&" "!=e.message&&webrtcdev.log("addNewFileLocal")}function addNewFileRemote(e){webrtcdev.log("addNewFileRemote message ",e),""!=e.message&&" "!=e.message&&webrtcdev.log("addNewFileRemote")}function updateLabel(e,t){if(-1!=e.position){var i=+e.position.toFixed(2).split(".")[1]||100;t.innerHTML=i+"%"}}function simulateClick(e){return document.getElementById(e).click(),webrtcdev.log("simulateClick on "+e),!0}function displayList(e,t,i,n,l){try{webrtcdev.log("DisplayList peerinfo->",t,i,n,l);var a=t.fileList.container,o=t.fileShare.container,r=(t.filearray.length,null);"sessionRecording"==l&&(n=n.videoname+"_"+n.audioname,r=n);var d=document.createElement("div");d.innerHTML=n,d.title=l+" shared by "+t.name,d.className="filenameClass",d.id="name"+n;var c=document.createElement("div");if(c.id="downloadButton"+n,c.style.float="right",fileshareobj.filelist.saveicon)(m=document.createElement("img")).src=fileshareobj.filelist.downloadicon,c.appendChild(m);else c.innerHTML='<i class="fa fa-download" style=" color: #615aa8;padding: 10px; font-size: larger;"></i>';c.onclick=function(){downloadFile(e,o,i,r,l)};var s=document.createElement("div");if(s.id="saveButton"+n,s.style.float="right",s.setAttribute("data-toggle","modal"),s.setAttribute("data-target","#saveModal"),fileshareobj.filelist.saveicon)(m=document.createElement("img")).src=fileshareobj.filelist.saveicon,s.appendChild(m);else s.innerHTML='<i class="fa fa-floppy-o" style="color: #615aa8;padding: 10px; font-size: larger;"></i>';s.onclick=function(){createModalPopup(l)};var m,p=document.createElement("div");if(p.id="showButton"+n,p.style.float="right",fileshareobj.filelist.saveicon)(m=document.createElement("img")).src=fileshareobj.filelist.showicon,p.appendChild(m);else p.innerHTML='<i class="fa fa-eye-slash" style="color: #615aa8;padding: 10px; font-size: larger;"></i>';var f=0;repeatFlagHideButton=n,repeatFlagShowButton="",p.onclick=function(){showHideFile(e,o,i,n,l,p,++f)};var u,h,g=document.createElement("div");g.id="removeButton"+n,g.style.float="right",g.innerHTML='<i class="fa fa-trash-o" style="color: #615aa8;padding: 10px; font-size: larger;"></i>',g.onclick=function(e){if(repeatFlagRemoveButton!=n){hideFile(o,n);var t=n;rtcConn.send({type:"shareFileRemove",_element:t,_filename:n}),removeFile(t),repeatFlagRemoveButton=n}else repeatFlagRemoveButton==n&&(repeatFlagRemoveButton="")},document.getElementById(n)?h=document.getElementById(n):(u=document.getElementById(a)?document.getElementById(a):document.body,h=document.createElement("div")),fileshareobj.active&&(h.id=n,h.innerHTML="",h.className="row",h.appendChild(d),h.appendChild(c),h.appendChild(p),h.appendChild(s),h.appendChild(g)),u&&u.appendChild(h)}catch(e){webrtcdev.error(" [filesharing ] Display list exception ",e)}}function getFileElementDisplayByType(e,t,i){var n;if(-1<e.indexOf("msword")||-1<e.indexOf("officedocument")){var l=document.createElement("div");l.className="alert alert-warning",l.innerHTML="Microsoft and Libra word file cannot be opened in browser. Click bottom DOWNLOAD in UF box . File shows up below the UF box. Click arrow on right, then select OPEN  . File Opens in New Window, then 'Save As'.",n=l}else if(-1<e.indexOf("image")){var a=document.createElement("img");a.src=t,a.style.width="100%",a.title=i,a.id="display"+i,n=a}else if("sessionRecording"==e){alert(" Session Reording");i=i.videoname+"_"+i.audioname;var o=document.createElement("div");o.setAttribute("background-color","black"),o.id="display"+i,o.title=i,(d=document.createElement("video")).src=t.videofileurl,d.setAttribute("type","audvideo/webm"),d.setAttribute("name","videofile"),d.controls="controls",d.title=i.videoname+".webm";var r=document.createElement("audio");r.src=t.audiofileurl,r.setAttribute("type","audio/wav"),r.controls="controls",r.title=i.videoname+".wav",o.appendChild(d),o.appendChild(r),n=o,d.play(),r.play()}else if(-1<e.indexOf("videoScreenRecording")){webrtcdev.log("videoScreenRecording ",t),(d=document.createElement("video")).src=t,d.setAttribute("controls","controls"),d.style.width="100%",d.title=i,d.id="display"+i,n=d}else if(-1<e.indexOf("video")){var d;webrtcdev.log("videoRecording ",t),(d=document.createElement("video")).src=t,d.setAttribute("controls","controls"),d.style.width="100%",d.title=i,d.id="display"+i,n=d}else{var c=document.createElement("iframe");c.style.width="100%",c.src=t,c.className="viewerIframeClass",c.title=i,c.id="display"+i,n=c}return n}function displayFile(e,t,i,n,l){try{if(!t||!t.fileShare)return;var a=document.getElementById(t.fileShare.container),o=getFileElementDisplayByType(l,i,n);if(a)a.innerHTML="",a.appendChild(o);else if("inspector"==role)for(r in webcallpeers){var d=++r;if(document.getElementById(webcallpeers[d].fileShare.container)){(a=document.getElementById(webcallpeers[d].fileShare.container)).innerHTML="",a.appendChild(o);break}}else document.body.appendChild(o)}catch(e){webrtcdev.error("[filehsaring js] displayFile ",e)}}function syncButton(e){var t=document.getElementById(e);for(x in webcallpeers)if(t.getAttribute("lastClickedBy")==webcallpeers[x].userid)return void t.setAttribute("lastClickedBy","");""==t.getAttribute("lastClickedBy")&&(t.setAttribute("lastClickedBy",rtcConn.userid),rtcConn.send({type:"buttonclick",buttonName:e}))}function showHideFile(e,t,i,n,l,a,o){webrtcdev.log(" filehsare - show/hide button ",n," || ",o),o%2==1?(showFile(t,i,n,l),a.innerHTML='<i class="fa fa-eye-slash" style="color: #615aa8;padding: 10px; font-size: larger;"></i>',webrtcdev.log(" Executed script to show the file")):o%2==0&&(hideFile(t,n),a.innerHTML='<i class="fa fa-eye" style="color: #615aa8;padding: 10px; font-size: larger;"></i>',webrtcdev.log(" Executed script to hide the file "))}function showFile(e,t,i,n){$("#"+e).html(getFileElementDisplayByType(n,t,i))}function hideFile(e,t){$("#"+e).has("#display"+t)?(webrtcdev.log("hidefile ",t," from ",e),document.getElementById(e).innerHTML=""):webrtcdev.log(" file is not displayed to hide  ")}function removeFile(e){document.getElementById(e).hidden=!0}function downloadFile(e,t,i,n,l){if(webrtcdev.log(" downloadButton _filename ",n,"  filetype ",l),"sessionRecording"==l){var a=document.createElement("a");document.body.appendChild(a),a.style="display: none",a.href=i.audiofileurl,a.download=peerinfo.filearray[0]+".wav",a.click(),window.URL.revokeObjectURL(i.audiofileurl);var o=document.createElement("a");document.body.appendChild(o),o.style="display: none",o.href=i.videofileurl,o.download=peerinfo.filearray[1]+".webm",o.click(),window.URL.revokeObjectURL(i.videofileurl)}else window.open(i,"downloadedDocument")}function createFileSharingBox(t,e){try{if(webrtcdev.log(" [ filehsreing js ]  createFileSharingBox ",t,e),document.getElementById(t.fileShare.outerbox))return;var i=document.createElement("div");"single"==fileshareobj.props.fileList?i.className="col-md-12 fileviewing-box":i.className="fileviewing-box",i.setAttribute("style","background-color:"+t.color),i.id=t.fileShare.outerbox;var n=document.createElement("p");n.id=t.fileShare.container+"controlBar",n.appendChild(document.createTextNode(t.name));var l=document.createElement("span");if(fileshareobj.fileshare.minicon)(r=document.createElement("img")).src=fileshareobj.fileshare.minicon,l.appendChild(r);else l.innerHTML='<i class="fa fa-minus-square" style="font-size: 25px;"></i>';l.id=t.fileShare.minButton,l.style.float="right",l.style.display="none",l.setAttribute("lastClickedBy",""),l.onclick=function(){resizeFV(t.userid,l.id,t.fileShare.outerbox),l.style.display="none",a.style.display="block"};var a=document.createElement("span");if(fileshareobj.fileshare.minicon)(r=document.createElement("img")).src=fileshareobj.fileshare.maxicon,a.appendChild(r);else a.innerHTML='<i class="fa fa-external-link-square" style="font-size: 25px;"></i>';a.id=t.fileShare.maxButton,a.style.float="right",a.style.display="block",a.setAttribute("lastClickedBy",""),a.onclick=function(){maxFV(t.userid,a.id,t.fileShare.outerbox),a.style.display="none",l.style.display="block"};var o=document.createElement("span");if(fileshareobj.fileshare.closeicon)(r=document.createElement("img")).src=fileshareobj.fileshare.closeicon,o.appendChild(r);else o.innerHTML='<i class="fa fa-times-circle" style="font-size: 25px;"></i>';o.id=t.fileShare.closeButton,o.style.float="right",o.setAttribute("lastClickedBy",""),o.onclick=function(){closeFV(t.userid,o.id,t.fileShare.container)};var r,d=0,c=document.createElement("span");if(fileshareobj.fileshare.rotateicon)(r=document.createElement("img")).src=fileshareobj.fileshare.rotateicon,c.appendChild(r);else c.innerHTML='<i class="fa fa-mail-forward" style="font-size: 25px;"></i>';c.id="btnRotate",c.style.float="right",c.onclick=function(){var e=document.getElementById(t.fileShare.container).firstChild;d=(d+90)%360,e.className="rotate"+d},n.appendChild(c),n.appendChild(l),n.appendChild(a),n.appendChild(o);var s=document.createElement("div");s.className="filesharingWidget",s.id=t.fileShare.container;var m=document.createElement("p");if(m.className="filler",debug){var p=document.createElement("span");p.innerHTML="<br/>"+s.id+"<br/>",i.appendChild(p)}linebreak=document.createElement("br"),i.appendChild(n),i.appendChild(linebreak),i.appendChild(linebreak),i.appendChild(s),i.appendChild(m),e.appendChild(i)}catch(e){webrtcdev.error(" createFileSharingBox ",e)}}function createFileListingBox(e,t){try{if(document.getElementById(e.fileList.outerbox))return;var i=document.createElement("div");"single"==fileshareobj.props.fileList?i.className="col-sm-12 filesharing-box":i.className="col-sm-6 filesharing-box",i.id=e.fileList.outerbox;var n=document.createElement("p"),l=document.createElement("span");l.innerHTML='<i class="fa fa-minus-square" style="font-size: 20px;></i>',l.id=e.fileShare.minButton,l.setAttribute("lastClickedBy",""),l.onclick=function(){resizeFV(e.userid,l.id,e.fileShare.outerbox)};var a=document.createElement("span");a.innerHTML='<i class="fa fa-external-link-square" style="font-size: 20px;></i>',a.id=e.fileShare.maxButton,a.setAttribute("lastClickedBy",""),a.onclick=function(){maxFV(e.userid,a.id,e.fileShare.outerbox)};var o=document.createElement("span");o.innerHTML='<i class="fa fa-times-circle" style="font-size: 20px;></i>',o.id=e.fileShare.closeButton,o.setAttribute("lastClickedBy",""),o.onclick=function(){closeFV(e.userid,o.id,e.fileShare.container)},n.appendChild(l),n.appendChild(a),n.appendChild(o);var r=document.createElement("div");r.id=e.fileList.container;var d=document.createElement("div");if(debug){var c=document.createElement("span");c.innerHTML=r.id,i.appendChild(c)}i.appendChild(n),i.appendChild(r),i.appendChild(d),t.appendChild(i)}catch(e){webrtcdev.error(" createFileListingBox ",e)}}function createFileSharingDiv(e){if(webrtcdev.log(" -------createFileSharingDiv  ",e),"inspector"!=e.role||"inspector"==role){if(!document.getElementById(e.fileShare.outerbox))createFileSharingBox(e,document.getElementById(fileshareobj.fileShareContainer));if(!document.getElementById(e.fileList.outerbox))createFileListingBox(e,document.getElementById(fileshareobj.fileListContainer))}}function closeFV(e,t,i){document.getElementById(i).innerHTML=""}function resizeFV(e,t,i){for(x in webcallpeers)webcallpeers[x].fileShare.outerbox==i?(document.getElementById(i).hidden=!1,document.getElementById(i).style.width="50%"):(document.getElementById(webcallpeers[x].fileShare.outerbox).hidden=!1,document.getElementById(webcallpeers[x].fileShare.outerbox).style.width="50%")}function minFV(e,t,i){document.getElementById(i).hidden=!1,document.getElementById(i).style.width="50%",document.getElementById(i).style.height="10%"}function maxFV(e,t,i){for(x in webcallpeers)webcallpeers[x].fileShare.outerbox==i?(document.getElementById(i).hidden=!1,document.getElementById(i).style.width="100%"):(document.getElementById(webcallpeers[x].fileShare.outerbox).hidden=!0,document.getElementById(webcallpeers[x].fileShare.outerbox).style.width="0%")}function createModalPopup(e){webrtcdev.log(" create Modal popup for filetype ",e);var t=document.getElementById("mainDiv");document.getElementById("saveModal")&&t.removeChild(document.getElementById("saveModal"));var i=document.createElement("div");i.className="modal fade",i.setAttribute("role","dialog"),i.id="saveModal";var n=document.createElement("div");n.className="modal-dialog";var l=document.createElement("div");l.className="modal-content";var a=document.createElement("div");a.className="modal-header";var o=document.createElement("button");o.className="close",o.setAttribute("data-dismiss","modal"),o.innerHTML="&times;";var r=document.createElement("h4");r.className="modal-title",r.innerHTML="Save File",r.setAttribute("float","left"),a.appendChild(r),a.appendChild(o);var d=document.createElement("div");d.className="modal-body",d.innerHTML="";var c=document.createElement("div");switch(e){case"blobcanvas":r.innerHTML="Save Drawing",(m=document.createElement("div")).innerHTML="Right Click on Save, pop up window gives following info: Right Click on Draw image, Click Save As when window opens up.",c.appendChild(m);break;case"application/pdf":r.innerHTML="Save PDF",(m=document.createElement("div")).innerHTML="Click DOWNLOAD on top of the doc . Click SAVE AS when window opens up";var s=document.createElement("img");s.src="images/savefile.PNG",c.appendChild(m),c.appendChild(s);break;case"image/jpeg":case"image/png":case"video/mov":case"video/webm":case"imagesnapshot":r.innerHTML="Save Picture / Video",(m=document.createElement("div")).innerHTML="Right Click on the FILE . Click SAVE AS when window opens up",c.appendChild(m);break;case"audio/mp3":r.innerHTML="Save Music File",(m=document.createElement("div")).innerHTML="Right Click on the FILE (play display line). Click SAVE AS when window opens up",c.appendChild(m);break;case"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":case"application/vnd.ms-excel":case"application/vnd.openxmlformats-officedocument.presentationml.presentation":case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":case"video/x-ms-wmv":r.innerHTML="Save Microsoft Office / Libra / Open Office Documents",(m=document.createElement("div")).innerHTML="Click bottom DOWNLOAD in Uploaded Files box . File shows up below the Uploaded Files box. Click arrow on right, then select OPEN  . File Opens in New Window, then 'Save As'.",c.appendChild(m);break;case"sessionRecording":r.innerHTML="Save Session Recording",(m=document.createElement("div")).innerHTML="Extract the video and audio recording from the dowloaded compresed file and play together ",c.appendChild(m);break;default:var m;(m=document.createElement("div")).innerHTML="Document is Unrecognizable, cannot be saved, but can be shared with Remote. Use/Click Screen Share for Remote to view your screen. Then open the document on your screen.",c.appendChild(m)}d.appendChild(c),l.appendChild(a),l.appendChild(d),n.appendChild(l),i.appendChild(n),t.appendChild(i)}
"";var CanvasDesigner,isDrawOpened=!1;function webrtcdevCanvasDesigner(e){if(document.getElementById(e.drawCanvasContainer).innerHTML.indexOf("iframe")<0)try{CanvasDesigner.addSyncListener(function(e){rtcConn.send({type:"canvas",draw:e})}),CanvasDesigner.setSelected("pencil"),CanvasDesigner.setTools({pencil:!0,eraser:!0}),CanvasDesigner.appendTo(document.getElementById(e.drawCanvasContainer))}catch(e){webrtcdev.error(" Canvas drawing not supported ",e)}else webrtcdev.log("CanvasDesigner already started .iframe is attached ")}function syncDrawBoard(e){document.getElementById(e.button.id)?document.getElementById(e.button.id).click():webrtcdev.error(" Receieved sync board evenet but no button id found")}function createdrawButton(n){var t=document.createElement("span");t.className=n.button.class_off,t.innerHTML=n.button.html_off,t.onclick=function(){if(t.className==n.button.class_off&&document.getElementById(n.drawCanvasContainer).hidden){if(alert(" Draw Board Opened "),t.className=n.button.class_on,t.innerHTML=n.button.html_on,document.getElementById(n.container.id)?document.getElementById(n.container.id).hidden=!1:webrtcdev.error("Draw : container-",n.container.id," doesnt exist"),document.getElementById(n.drawCanvasContainer)){document.getElementById(n.drawCanvasContainer).hidden=!1,document.getElementById(n.drawCanvasContainer).focus();var e={event:"open",from:"remote",board:n.drawCanvasContainer,button:n.button};rtcConn.send({type:"canvas",board:e})}else webrtcdev.error("Draw : canvascontainer-",n.drawCanvasContainer," doesnt exist");webrtcdevCanvasDesigner(n)}else t.className!=n.button.class_on||document.getElementById(n.drawCanvasContainer).hidden||(t.className=n.button.class_off,t.innerHTML=n.button.html_off,document.getElementById(n.container.id)?document.getElementById(n.container.id).hidden=!0:webrtcdev.error("Draw : container-",n.container.id," doesnt exist"),document.getElementById(n.drawCanvasContainer)?document.getElementById(n.drawCanvasContainer).hidden=!0:webrtcdev.error("Draw : canvascontainer-",n.drawCanvasContainer," doesnt exist"))};var e=document.createElement("li");e.appendChild(t),document.getElementById("topIconHolder_ul").appendChild(e)}function assigndrawButton(n){drawButton=document.getElementById(n.button.id),drawButton.className=n.button.class_off,drawButton.innerHTML=n.button.html_off,drawButton.onclick=function(){if(drawButton.className==n.button.class_off&&document.getElementById(n.drawCanvasContainer).hidden){if(drawButton.className=n.button.class_on,drawButton.innerHTML=n.button.html_on,document.getElementById(n.container.id)?document.getElementById(n.container.id).hidden=!1:webrtcdev.error("Draw : container-",n.container.id," doesnt exist"),document.getElementById(n.drawCanvasContainer)){document.getElementById(n.drawCanvasContainer).hidden=!1,document.getElementById(n.drawCanvasContainer).focus(),isDrawOpened=!0;var e={event:"open",from:"remote",board:n.drawCanvasContainer,button:n.button};rtcConn.send({type:"canvas",board:e})}else webrtcdev.error("Draw : canvascontainer-",n.drawCanvasContainer," doesnt exist");webrtcdevCanvasDesigner(n)}else if(drawButton.className==n.button.class_on&&!document.getElementById(n.drawCanvasContainer).hidden)if(drawButton.className=n.button.class_off,drawButton.innerHTML=n.button.html_off,document.getElementById(n.container.id)?document.getElementById(n.container.id).hidden=!0:webrtcdev.error("Draw : container-",n.container.id," doesnt exist"),document.getElementById(n.drawCanvasContainer)){document.getElementById(n.drawCanvasContainer).hidden=!0,isDrawOpened=!1;e={event:"close",from:"remote",board:n.drawCanvasContainer,button:n.button};rtcConn.send({type:"canvas",board:e})}else webrtcdev.error("Draw : canvascontainer-",n.drawCanvasContainer," doesnt exist")}}var saveButtonCanvas=document.createElement("div");saveButtonCanvas.id="saveButtonCanvasDraw",saveButtonCanvas.setAttribute("data-toggle","modal"),saveButtonCanvas.setAttribute("data-target","#saveModal"),saveButtonCanvas.onclick=function(){createModalPopup("blobcanvas")},document.body.appendChild(saveButtonCanvas);
"";function createButtonRedial(){var n=document.createElement("span");n.className=reconnectobj.button.class,n.innerHTML=reconnectobj.button.html,n.onclick=function(){1==confirm("Do you want to reconnet ?")&&($(this).html('<img src="http://www.bba-reman.com/images/fbloader.gif" />'),setTimeout(function(){$(this).html(reconnectobj.button.html)},3e3))};var t=document.createElement("li");t.appendChild(n),document.getElementById("topIconHolder_ul").appendChild(t)}function assignButtonRedial(n){document.getElementById(n).onclick=function(){if(1==confirm("Do you want to reconnect ?")){if(!rtcConn.peers[rtcConn.connectionDescription.remoteUserId])return;rtcConn.peers[rtcConn.connectionDescription.remoteUserId].peer.close(),rtcConn.rejoin(rtcConn.connectionDescription),$(this).html('<img src="http://www.bba-reman.com/images/fbloader.gif" />'),setTimeout(function(){document.getElementById(n).innerHTML=reconnectobj.button.html},3e3)}}}
"";if(document.getElementById("ListenInButton")){var listeninLink=window.location+"?appname=webrtcwebcall&role=inspector&audio=0&video=0",modalBox=document.createElement("div");modalBox.className="modal fade",modalBox.setAttribute("role","dialog"),modalBox.id="myModal";var modalinnerBox=document.createElement("div");modalinnerBox.className="modal-dialog";var modal=document.createElement("div");modal.className="modal-content";var modalheader=document.createElement("div");modalheader.className="modal-header";var closeButton=document.createElement("button");closeButton.className="close",closeButton.setAttribute("data-dismiss","modal"),closeButton.innerHTML="&times;";var title=document.createElement("h4");title.className="modal-title",title.innerHTML="Listen-In Link",modalheader.appendChild(title),modalheader.appendChild(closeButton);var modalbody=document.createElement("div");modalbody.className="modal-body";var link=document.createElement("div");link.innerHTML=window.location+"?appname=webrtcwebcall&role=inspector&audio=0&video=0";var mail=document.createElement("div");mail.innerHTML='<a href="mailto:?Subject=Hello%20again" target="_top">Send Mail</a>',modalbody.appendChild(link),modalbody.appendChild(mail),modal.appendChild(modalheader),modal.appendChild(modalbody),modalinnerBox.appendChild(modal),modalBox.appendChild(modalinnerBox);var mainDiv=document.getElementById("mainDiv");mainDiv.appendChild(modalBox),webrtcdev.log(" -----------------sppenedd modal dialog ListenIn",modalBox)}if(document.getElementById("listenInLink"))try{var currSession=window.location.href;webrtcdev.log(" Current Session ",currSession);var listeninSession=currSession+"?appname=webrtcwebcall&role=inspector&audio=0&video=0";webrtcdev.log(" Inspector Link ",listeninSession),document.getElementById("listenInLink").value=listeninSession}catch(e){webrtcdev.error(" Listen In :".e)}
"";var cursorX,cursorY,cursorinterval;function placeCursor(r,t,o){r.style.position="absolute",r.style.left=t+"px",r.style.top=o+"px"}function startShareCursor(){document.getElementById("cursor1").setAttribute("style","display:block"),document.onmousemove=function(r){cursorX=r.pageX+10,cursorY=r.pageY},cursorinterval=setInterval(shareCursor,500)}function stopShareCursor(){document.getElementById("cursor1").setAttribute("style","display:none"),rtcConn.send({type:"pointer",action:"stopCursor"}),clearInterval(cursorinterval)}function shareCursor(){var r=document.getElementById("cursor1");r.hidden=!1,placeCursor(r,cursorX,cursorY),rtcConn.send({type:"pointer",action:"startCursor",corX:cursorX,corY:cursorY})}function createCursorButton(r,t,o,e){var s=document.createElement("span");return s.id=r+"cursorButton",s.setAttribute("data-val","mute"),s.setAttribute("title","Pointer"),s.className=cursorobj.button.class_on,s.innerHTML=cursorobj.button.html_on,s.onclick=function(){var r,t=s.id;r=selfuserid?findPeerInfo(selfuserid):findPeerInfo(rtcConn.userid),-1<t.indexOf(r.controlBarName)?s.className==cursorobj.button.class_on?(startShareCursor(),s.className=cursorobj.button.class_off,s.innerHTML=cursorobj.button.html_off):s.className==cursorobj.button.class_off&&(stopShareCursor(),s.className=cursorobj.button.class_on,s.innerHTML=cursorobj.button.html_on):alert(" Use Local Pointer button ")},s}
"";function createCodeEditorButton(){var e=document.createElement("span");for(x in e.className=codeeditorobj.button.class_off,e.innerHTML=codeeditorobj.button.html_off,codeeditorobj.languages)document.getElementById("CodeStyles").innerHTML=document.getElementById("CodeStyles").innerHTML+codeeditorobj.languages[x];document.getElementById("codeArea").value;editor=CodeMirror.fromTextArea(document.getElementById("codeArea"),{mode:"text/javascript",styleActiveLine:!0,lineNumbers:!1,lineWrapping:!0}),editor.setOption("theme","mdn-like"),e.onclick=function(){e.className==codeeditorobj.button.class_off?(e.className=codeeditorobj.button.class_on,e.innerHTML=codeeditorobj.button.html_on,startWebrtcdevcodeeditorSync(),document.getElementById(codeeditorobj.codeeditorContainer).hidden=!1):e.className==codeeditorobj.button.class_on&&(e.className=codeeditorobj.button.class_off,e.innerHTML=codeeditorobj.button.html_off,stopWebrtcdevcodeeditorSync(),document.getElementById(codeeditorobj.codeeditorContainer).hidden=!0)};var t=document.createElement("li");t.appendChild(e),document.getElementById("topIconHolder_ul").appendChild(t)}function sendWebrtcdevCodeeditorSync(e){if(37==e.which||38==e.which||39==e.which||40==e.which||17==e.which||18==e.which||16==e.which)return!0;var t={option:"text",codeContent:editor.getValue()};webrtcdev.log(" sending ",t),rtcMultiConnection.send({type:"codeeditor",data:t})}function sendWebrtcdevCodeeditorStyleSync(e){$("#CodeStyles option:selected").each(function(){var e=CodeMirror.findModeByMIME($(this).attr("mime"));e&&(mode=e.mode,spec=$(this).attr("mime"),editor.setOption("mode",spec),CodeMirror.autoLoadMode(editor,mode))});var t={option:"menu",codeMode:mode,codeSpec:spec};webrtcdev.log(" sending ",t),rtcMultiConnection.send({type:"codeeditor",data:t})}function receiveWebrtcdevCodeeditorSync(e){if(webrtcdev.log("codeeditor ",e),"text"==e.option){var t=editor.getCursor();editor.setValue(e.codeContent),editor.setCursor(t)}else"menu"==e.option&&(editor.setOption("mode",evt.data.codeSpec),CodeMirror.autoLoadMode(editor,evt.data.codeMode))}function startWebrtcdevcodeeditorSync(){document.getElementById(codeeditorobj.codeeditorContainer).addEventListener("keyup",sendWebrtcdevCodeeditorSync,!1),document.getElementById("CodeStyles").addEventListener("change",sendWebrtcdevCodeeditorStyleSync,!1)}function stopWebrtcdevcodeeditorSync(){document.getElementById(codeeditorobj.codeeditorContainer).removeEventListener("keyup",sendWebrtcdevCodeeditorSync,!1)}
"";function createTextEditorButton(){var t=document.createElement("span");t.className=texteditorobj.button.class_off,t.innerHTML=texteditorobj.button.html_off,t.onclick=function(){t.className==texteditorobj.button.class_off?(t.className=texteditorobj.button.class_on,t.innerHTML=texteditorobj.button.html_on,startWebrtcdevTexteditorSync(),document.getElementById(texteditorobj.texteditorContainer).hidden=!1):t.className==texteditorobj.button.class_on&&(t.className=texteditorobj.button.class_off,t.innerHTML=texteditorobj.button.html_off,stopWebrtcdevTexteditorSync(),document.getElementById(texteditorobj.texteditorContainer).hidden=!0)};var e=document.createElement("li");e.appendChild(t),document.getElementById("topIconHolder_ul").appendChild(e)}function sendWebrtcdevTexteditorSync(t){if(37==t.which||38==t.which||39==t.which||40==t.which||17==t.which||18==t.which||16==t.which)return!0;var e={option:"text",content:document.getElementById(texteditorobj.texteditorContainer).value};webrtcdev.log(" sending ",document.getElementById(texteditorobj.texteditorContainer).value),rtcMultiConnection.send({type:"texteditor",data:e})}function receiveWebrtcdevTexteditorSync(t){webrtcdev.log("texteditor ",t),"text"==t.option&&(document.getElementById(texteditorobj.texteditorContainer).value=t.content)}function startWebrtcdevTexteditorSync(){document.getElementById(texteditorobj.texteditorContainer).addEventListener("keyup",sendWebrtcdevTexteditorSync,!1)}function stopWebrtcdevTexteditorSync(){document.getElementById(texteditorobj.texteditorContainer).removeEventListener("keyup",sendWebrtcdevTexteditorSync,!1)}
"";var iceServers=[];function createCORSRequest(e,r){var t=new XMLHttpRequest;return"withCredentials"in t?t.open(e,r,!0):"undefined"!=typeof XDomainRequest?(t=new XDomainRequest).open(e,r):t=null,t}function getICEServer(e,r,t,n,s,o){var i=createCORSRequest("POST","https://service.xirsys.com/ice");i.onload=function(){webrtcdev.log(i.responseText),null==JSON.parse(i.responseText).d?(webrtcdevIceServers="err",shownotification(" media not able to pass through "+JSON.parse(i.responseText).e)):(webrtcdevIceServers=JSON.parse(i.responseText).d.iceServers,webrtcdev.log(" otained iceServers",webrtcdevIceServers))},i.onerror=function(){webrtcdev.error("Woops, there was an error making xhr request.")},i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.send("ident="+e+"&secret="+r+"&domain="+t+"&application="+n+"&room="+s+"&secure="+o)}
"";var hours,mins,secs,today=new Date,zone="";function startsessionTimer(e){e.counter.hours&&e.counter.minutes&&e.counter.seconds?(hours=document.getElementById(e.counter.hours),mins=document.getElementById(e.counter.minutes),secs=document.getElementById(e.counter.seconds),"forward"==e.type?(startForwardTimer(),hours.innerHTML=0,mins.innerHTML=0,secs.innerHTML=0):"backward"==e.type&&(hours.innerHTML=0,mins.innerHTML=3,secs.innerHTML=0,startBackwardTimer())):webrtcdev.error(" timerobj.counter DOM elemnts not found ")}function startBackwardTimer(){webrtcdev.log("startBackwardTimer",hours,mins,secs);var e=mins;btimer(secs,parseInt(secs.innerHTML,10),e,parseInt(e.innerHTML,10))}function startForwardTimer(){webrtcdev.log("forward vtime started ");var e=mins;ftimer(secs,parseInt(secs.innerHTML,10),e,parseInt(e.innerHTML,10))}function ftimer(e,t,n,r){setInterval(function(){t++,60==(secs.innerHTML=t)&&(t=0,r++,mins.innerHTML=r)},1e3)}function btimer(e,t,n,r){var i=setInterval(function(){t--,0==(secs.innerHTML=t)&&(t=60,r--,(mins.innerHTML=r)<0&&clearInterval(i))},1e3)}function getDate(){return new Date}function prepareTime(){}function startTime(){try{var e=today.getHours(),t=today.getMinutes(),n=today.getSeconds();if(t=checkTime(t),n=checkTime(n),timerobj.span.currentTime_id&&document.getElementById(timerobj.span.currentTime_id)){document.getElementById(timerobj.span.currentTime_id).innerHTML=e+":"+t+":"+n;setTimeout(startTime,500)}else webrtcdev.error(" No place for timerobj.span.currentTime_id")}catch(e){webrtcdev.error(e)}}function timeZone(){try{if(timerobj.span.currentTimeZone_id&&document.getElementById(timerobj.span.currentTimeZone_id))zone=Intl.DateTimeFormat().resolvedOptions().timeZone,document.getElementById(timerobj.span.currentTimeZone_id).innerHTML=zone;else webrtcdev.error(" timerobj.span.currentTimeZone_id DOM doesnt exist ")}catch(e){webrtcdev.error(e)}}function shareTimePeer(){try{var e={type:"timer",time:today.toJSON(),zone:zone};rtcConn.send(e)}catch(e){webrtcdev.error(e)}}function startPeersTime(e,t){try{if(webrtcdev.log(" startPeersTime ",e,t),timerobj.span.remoteTimeZone_id&&document.getElementById(timerobj.span.remoteTimeZone_id))document.getElementById(timerobj.span.remoteTimeZone_id).innerHTML=t;else webrtcdev.error("timerobj.span.remoteTimeZone_id DOM doesnt exist ");if(timerobj.span.remoteTime_id&&document.getElementById(timerobj.span.remoteTime_id)){var n=new Date(e);webrtcdev.log(" remotedate :",n);var r=n.getHours(),i=n.getMinutes(),o=n.getSeconds();r=checkTime(r),i=checkTime(i),o=checkTime(o),document.getElementById(timerobj.span.remoteTime_id).innerHTML=r+":"+i+":"+o;setTimeout(startTime,500)}else webrtcdev.error(" timerobj.span.remoteTime_id DOM does not exist")}catch(e){webrtcdev.error(e)}}function activateBttons(t){t.container.minbutton_id&&document.getElementById(t.container.minbutton_id)&&(document.getElementById(t.container.minbutton_id).onclick=function(e){document.getElementById(t.container.id).hidden?document.getElementById(t.container.id).hidden=!1:document.getElementById(t.container.id).hidden=!0})}function checkTime(e){return e<10&&(e="0"+e),e}
"";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function getStats(e,c,s){var g=this;if(e instanceof RTCMultiConnection){if(g=e,navigator.mozGetUserMedia&&(e=c,c=s,s=arguments[3]),!(e instanceof MediaStreamTrack)&&navigator.mozGetUserMedia)throw"2nd argument is not instance of MediaStreamTrack."}else if(!(e instanceof MediaStreamTrack)&&navigator.mozGetUserMedia)throw"1st argument is not instance of MediaStreamTrack.";var p={audio:{},video:{}},l=!1;!function d(){!function(n){if(webrtcdev.log("peer ",g),!g.getStats())return;navigator.mozGetUserMedia?g.getStats(e,function(e){var t=[];e.forEach(function(e){t.push(e)}),n(t)},n):g.getStats(function(e){var o=[];e.result().forEach(function(t){var n={};t.names().forEach(function(e){n[e]=t.stat(e)}),n.id=t.id,n.type=t.type,n.timestamp=t.timestamp,o.push(n)}),n(o)})}(function(e){for(var t={audio:{},video:{},results:e,nomore:function(){l=!0}},n=0;n<e.length;++n){var o=e[n];if(o.datachannelid&&"datachannel"===o.type&&(t.datachannel={state:o.state}),"googLibjingleSession"===o.type&&(t.isOfferer=o.googInitiator),"googCertificate"==o.type&&(t.encryption=o.googFingerprintAlgorithm),"opus"==o.googCodecName&&o.bytesSent){var i=0;if(o.bytesSent){p.audio.prevBytesSent||(p.audio.prevBytesSent=o.bytesSent);var a=o.bytesSent-p.audio.prevBytesSent;p.audio.prevBytesSent=o.bytesSent,i=a/1024}t.audio||(t.audio=o),t.audio.availableBandwidth=i.toFixed(1)}if("VP8"==o.googCodecName){i=0;if(o.bytesSent){p.video.prevBytesSent||(p.video.prevBytesSent=o.bytesSent);a=o.bytesSent-p.video.prevBytesSent;p.video.prevBytesSent=o.bytesSent,i=a/1024}t.video||(t.video=o),t.video.availableBandwidth=i.toFixed(1),o.googFrameHeightReceived&&o.googFrameWidthReceived&&(t.resolutions={width:o.googFrameWidthReceived,height:o.googFrameHeightReceived})}"VideoBwe"==o.type&&(t.video.bandwidth={googActualEncBitrate:o.googActualEncBitrate,googAvailableSendBandwidth:o.googAvailableSendBandwidth,googAvailableReceiveBandwidth:o.googAvailableReceiveBandwidth,googRetransmitBitrate:o.googRetransmitBitrate,googTargetEncBitrate:o.googTargetEncBitrate,googBucketDelay:o.googBucketDelay,googTransmitBitrate:o.googTransmitBitrate}),"googCandidatePair"==o.type&&"true"==o.googActiveConnection&&(t.connectionType={local:{candidateType:o.googLocalCandidateType,ipAddress:o.googLocalAddress},remote:{candidateType:o.googRemoteCandidateType,ipAddress:o.googRemoteAddress},transport:o.googTransportType});var r=((navigator.connection||{}).type||"unknown").toString().toLowerCase();"localcandidate"===o.type&&(t.connectionType||(t.connectionType={}),t.connectionType.local={candidateType:o.candidateType,ipAddress:o.ipAddress+":"+o.portNumber,networkType:o.networkType||"unknown",transport:o.transport}),"remotecandidate"===o.type&&(t.connectionType||(t.connectionType={}),t.connectionType.local={candidateType:o.candidateType,ipAddress:o.ipAddress+":"+o.portNumber,networkType:o.networkType||r,transport:o.transport})}try{-1!==g.iceConnectionState.search(/failed|closed/gi)&&(l=!0)}catch(e){l=!0}!0===l&&(t.datachannel&&(t.datachannel.state="close"),t.ended=!0),c(t),l||null!=(void 0===s?"undefined":_typeof(s))&&s&&setTimeout(d,s||1e3)})}()}function merge(e,t){if(e||(e={}),!t)return e;for(var n in t)e[n]=t[n];return e}function activateBandwidthButtons(e){document.getElementById("minimizeBandwidthButton")&&(document.getElementById("minimizeBandwidthButton").onclick=function(e){document.getElementById("bandwidthContainer").hidden?document.getElementById("bandwidthContainer").hidden=!1:document.getElementById("bandwidthContainer").hidden=!0})}function showStatus(e){getStats(rtcConn,function(e){alert("getstats Result"),webrtcdev.log(e.connectionType.remote.ipAddress),webrtcdev.log(e.connectionType.remote.candidateType),webrtcdev.log(e.connectionType.transport)}),alert("got stats ",result.connectionType.transport),webrtcdev.log("WebcallPeers ",webcallpeers)}function rtpstats(){try{for(x=0;x<rtcConn.peers.getLength();x++){var e=rtcConn.peers.getAllParticipants()[x],t=JSON.stringify(rtcConn.peers[e],void 0,2);document.getElementById(statisticsobj.statsConainer).innerHTML+="<pre >"+t+"</pre>"}}catch(e){webrtcdev.error("rtpstats",e)}}function showRtcConn(){webrtcdev.log(" rtcConn : ",rtcConn),webrtcdev.log(" rtcConn.peers.getAllParticipants() : ",rtcConn.peers.getAllParticipants())}"undefined"!=typeof module&&(module.exports=getStats),"undefined"!=typeof window&&(window.getStats=getStats);
"";function sendCallTraces(){}function sendwebrtcdevLogs(t,n){try{var e=new JSZip;e.file("webrtcDevSessionLogs.txt",webrtcdevlogs),e.generateAsync({type:"base64"}).then(function(e){fetch(t,{method:"post",crossDomain:!0,ContentEncoding:"base64",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:{apikey:n,useremail:selfemail,sessionid:sessionid,webrtcZip:e,webrtcTxt:"traceswebrtcdev"}}).then(function(e){return e.json()}).then(function(e){return console.log(e)})})}catch(e){webrtcdevlogs.error(" Exception in sendwebrtcdevLogs ",e)}}
"";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){if("object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).JSZip=e()}}(function(){return function a(s,o,u){function h(r,e){if(!o[r]){if(!s[r]){var t="function"==typeof require&&require;if(!e&&t)return t(r,!0);if(l)return l(r,!0);var n=new Error("Cannot find module '"+r+"'");throw n.code="MODULE_NOT_FOUND",n}var i=o[r]={exports:{}};s[r][0].call(i.exports,function(e){var t=s[r][1][e];return h(t||e)},i,i.exports,a,s,o,u)}return o[r].exports}for(var l="function"==typeof require&&require,e=0;e<u.length;e++)h(u[e]);return h}({1:[function(e,t,r){var d=e("./utils"),c=e("./support"),p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.encode=function(e){for(var t,r,n,i,a,s,o,u=[],h=0,l=e.length,f=l,c="string"!==d.getTypeOf(e);h<e.length;)f=l-h,c?(t=e[h++],r=h<l?e[h++]:0,n=h<l?e[h++]:0):(t=e.charCodeAt(h++),r=h<l?e.charCodeAt(h++):0,n=h<l?e.charCodeAt(h++):0),i=t>>2,a=(3&t)<<4|r>>4,s=1<f?(15&r)<<2|n>>6:64,o=2<f?63&n:64,u.push(p.charAt(i)+p.charAt(a)+p.charAt(s)+p.charAt(o));return u.join("")},r.decode=function(e){var t,r,n,i,a,s,o=0,u=0,h="data:";if(e.substr(0,h.length)===h)throw new Error("Invalid base64 input, it looks like a data url.");var l,f=3*(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;if(e.charAt(e.length-1)===p.charAt(64)&&f--,e.charAt(e.length-2)===p.charAt(64)&&f--,f%1!=0)throw new Error("Invalid base64 input, bad content length.");for(l=c.uint8array?new Uint8Array(0|f):new Array(0|f);o<e.length;)t=p.indexOf(e.charAt(o++))<<2|(i=p.indexOf(e.charAt(o++)))>>4,r=(15&i)<<4|(a=p.indexOf(e.charAt(o++)))>>2,n=(3&a)<<6|(s=p.indexOf(e.charAt(o++))),l[u++]=t,64!==a&&(l[u++]=r),64!==s&&(l[u++]=n);return l}},{"./support":30,"./utils":32}],2:[function(e,t,r){var n=e("./external"),i=e("./stream/DataWorker"),a=e("./stream/DataLengthProbe"),s=e("./stream/Crc32Probe");a=e("./stream/DataLengthProbe");function o(e,t,r,n,i){this.compressedSize=e,this.uncompressedSize=t,this.crc32=r,this.compression=n,this.compressedContent=i}o.prototype={getContentWorker:function(){var e=new i(n.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new a("data_length")),t=this;return e.on("end",function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),e},getCompressedWorker:function(){return new i(n.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},o.createWorkerFrom=function(e,t,r){return e.pipe(new s).pipe(new a("uncompressedSize")).pipe(t.compressWorker(r)).pipe(new a("compressedSize")).withStreamInfo("compression",t)},t.exports=o},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,t,r){var n=e("./stream/GenericWorker");r.STORE={magic:"\0\0",compressWorker:function(e){return new n("STORE compression")},uncompressWorker:function(){return new n("STORE decompression")}},r.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,t,r){var n=e("./utils");var o=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();t.exports=function(e,t){return void 0!==e&&e.length?"string"!==n.getTypeOf(e)?function(e,t,r,n){var i=o,a=n+r;e^=-1;for(var s=n;s<a;s++)e=e>>>8^i[255&(e^t[s])];return-1^e}(0|t,e,e.length,0):function(e,t,r,n){var i=o,a=n+r;e^=-1;for(var s=n;s<a;s++)e=e>>>8^i[255&(e^t.charCodeAt(s))];return-1^e}(0|t,e,e.length,0):0}},{"./utils":32}],5:[function(e,t,r){r.base64=!1,r.binary=!1,r.dir=!1,r.createFolders=!0,r.date=null,r.compression=null,r.compressionOptions=null,r.comment=null,r.unixPermissions=null,r.dosPermissions=null},{}],6:[function(e,t,r){var n=null;n="undefined"!=typeof Promise?Promise:e("lie"),t.exports={Promise:n}},{lie:58}],7:[function(e,t,r){var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,i=e("pako"),a=e("./utils"),s=e("./stream/GenericWorker"),o=n?"uint8array":"array";function u(e,t){s.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}r.magic="\b\0",a.inherits(u,s),u.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(a.transformTo(o,e.data),!1)},u.prototype.flush=function(){s.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},u.prototype.cleanUp=function(){s.prototype.cleanUp.call(this),this._pako=null},u.prototype._createPako=function(){this._pako=new i[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var t=this;this._pako.onData=function(e){t.push({data:e,meta:t.meta})}},r.compressWorker=function(e){return new u("Deflate",e)},r.uncompressWorker=function(){return new u("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:59}],8:[function(e,t,r){var B=e("../utils"),i=e("../stream/GenericWorker"),R=e("../utf8"),T=e("../crc32"),D=e("../signature"),F=function(e,t){var r,n="";for(r=0;r<t;r++)n+=String.fromCharCode(255&e),e>>>=8;return n},a=function(e,t,r,n,i,a){var s,o,u=e.file,h=e.compression,l=a!==R.utf8encode,f=B.transformTo("string",a(u.name)),c=B.transformTo("string",R.utf8encode(u.name)),d=u.comment,p=B.transformTo("string",a(d)),m=B.transformTo("string",R.utf8encode(d)),_=c.length!==u.name.length,g=m.length!==d.length,b="",v="",y="",w=u.dir,k=u.date,x={crc32:0,compressedSize:0,uncompressedSize:0};t&&!r||(x.crc32=e.crc32,x.compressedSize=e.compressedSize,x.uncompressedSize=e.uncompressedSize);var S=0;t&&(S|=8),l||!_&&!g||(S|=2048);var z,C,E,A=0,I=0;w&&(A|=16),"UNIX"===i?(I=798,A|=(z=u.unixPermissions,C=w,(E=z)||(E=C?16893:33204),(65535&E)<<16)):(I=20,A|=63&(u.dosPermissions||0)),s=k.getUTCHours(),s<<=6,s|=k.getUTCMinutes(),s<<=5,s|=k.getUTCSeconds()/2,o=k.getUTCFullYear()-1980,o<<=4,o|=k.getUTCMonth()+1,o<<=5,o|=k.getUTCDate(),_&&(v=F(1,1)+F(T(f),4)+c,b+="up"+F(v.length,2)+v),g&&(y=F(1,1)+F(T(p),4)+m,b+="uc"+F(y.length,2)+y);var O="";return O+="\n\0",O+=F(S,2),O+=h.magic,O+=F(s,2),O+=F(o,2),O+=F(x.crc32,4),O+=F(x.compressedSize,4),O+=F(x.uncompressedSize,4),O+=F(f.length,2),O+=F(b.length,2),{fileRecord:D.LOCAL_FILE_HEADER+O+f+b,dirRecord:D.CENTRAL_FILE_HEADER+F(I,2)+O+F(p.length,2)+"\0\0\0\0"+F(A,4)+F(n,4)+f+b+p}};function n(e,t,r,n){i.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=r,this.encodeFileName=n,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}B.inherits(n,i),n.prototype.push=function(e){var t=e.meta.percent||0,r=this.entriesCount,n=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,i.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:r?(t+100*(r-n-1))/r:100}}))},n.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var r=a(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:r.fileRecord,meta:{percent:0}})}else this.accumulate=!0},n.prototype.closedSource=function(e){this.accumulate=!1;var t,r=this.streamFiles&&!e.file.dir,n=a(e,r,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(n.dirRecord),r)this.push({data:(t=e,D.DATA_DESCRIPTOR+F(t.crc32,4)+F(t.compressedSize,4)+F(t.uncompressedSize,4)),meta:{percent:100}});else for(this.push({data:n.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},n.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var r,n,i,a,s,o,u=this.bytesWritten-e,h=(r=this.dirRecords.length,n=u,i=e,a=this.zipComment,s=this.encodeFileName,o=B.transformTo("string",s(a)),D.CENTRAL_DIRECTORY_END+"\0\0\0\0"+F(r,2)+F(r,2)+F(n,4)+F(i,4)+F(o.length,2)+o);this.push({data:h,meta:{percent:100}})},n.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},n.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()}),e.on("error",function(e){t.error(e)}),this},n.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},n.prototype.error=function(e){var t=this._sources;if(!i.prototype.error.call(this,e))return!1;for(var r=0;r<t.length;r++)try{t[r].error(e)}catch(e){}return!0},n.prototype.lock=function(){i.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},t.exports=n},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,t,r){var h=e("../compressions"),n=e("./ZipFileWorker");r.generateWorker=function(e,s,t){var o=new n(s.streamFiles,t,s.platform,s.encodeFileName),u=0;try{e.forEach(function(e,t){u++;var r=function(e,t){var r=e||t,n=h[r];if(!n)throw new Error(r+" is not a valid compression method !");return n}(t.options.compression,s.compression),n=t.options.compressionOptions||s.compressionOptions||{},i=t.dir,a=t.date;t._compressWorker(r,n).withStreamInfo("file",{name:e,dir:i,date:a,comment:t.comment||"",unixPermissions:t.unixPermissions,dosPermissions:t.dosPermissions}).pipe(o)}),o.entriesCount=u}catch(e){o.error(e)}return o}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,t,r){function n(){if(!(this instanceof n))return new n;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files={},this.comment=null,this.root="",this.clone=function(){var e=new n;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}(n.prototype=e("./object")).loadAsync=e("./load"),n.support=e("./support"),n.defaults=e("./defaults"),n.version="3.1.5",n.loadAsync=function(e,t){return(new n).loadAsync(e,t)},n.external=e("./external"),t.exports=n},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,t,r){var n=e("./utils"),i=e("./external"),o=e("./utf8"),u=(n=e("./utils"),e("./zipEntries")),a=e("./stream/Crc32Probe"),h=e("./nodejsUtils");function l(n){return new i.Promise(function(e,t){var r=n.decompressed.getContentWorker().pipe(new a);r.on("error",function(e){t(e)}).on("end",function(){r.streamInfo.crc32!==n.decompressed.crc32?t(new Error("Corrupted zip : CRC32 mismatch")):e()}).resume()})}t.exports=function(e,a){var s=this;return a=n.extend(a||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),h.isNode&&h.isStream(e)?i.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):n.prepareContent("the loaded zip file",e,!0,a.optimizedBinaryString,a.base64).then(function(e){var t=new u(a);return t.load(e),t}).then(function(e){var t=[i.Promise.resolve(e)],r=e.files;if(a.checkCRC32)for(var n=0;n<r.length;n++)t.push(l(r[n]));return i.Promise.all(t)}).then(function(e){for(var t=e.shift(),r=t.files,n=0;n<r.length;n++){var i=r[n];s.file(i.fileNameStr,i.decompressed,{binary:!0,optimizedBinaryString:!0,date:i.date,dir:i.dir,comment:i.fileCommentStr.length?i.fileCommentStr:null,unixPermissions:i.unixPermissions,dosPermissions:i.dosPermissions,createFolders:a.createFolders})}return t.zipComment.length&&(s.comment=t.zipComment),s})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,t,r){var n=e("../utils"),i=e("../stream/GenericWorker");function a(e,t){i.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}n.inherits(a,i),a.prototype._bindStream=function(e){var t=this;(this._stream=e).pause(),e.on("data",function(e){t.push({data:e,meta:{percent:0}})}).on("error",function(e){t.isPaused?this.generatedError=e:t.error(e)}).on("end",function(){t.isPaused?t._upstreamEnded=!0:t.end()})},a.prototype.pause=function(){return!!i.prototype.pause.call(this)&&(this._stream.pause(),!0)},a.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},t.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,t,r){var i=e("readable-stream").Readable;function n(e,t,r){i.call(this,t),this._helper=e;var n=this;e.on("data",function(e,t){n.push(e)||n._helper.pause(),r&&r(t)}).on("error",function(e){n.emit("error",e)}).on("end",function(){n.push(null)})}e("../utils").inherits(n,i),n.prototype._read=function(){this._helper.resume()},t.exports=n},{"../utils":32,"readable-stream":16}],14:[function(e,t,r){t.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(e,t){return new Buffer(e,t)},allocBuffer:function(e){return Buffer.alloc?Buffer.alloc(e):new Buffer(e)},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}},{}],15:[function(e,t,r){var i=e("./utf8"),h=e("./utils"),l=e("./stream/GenericWorker"),a=e("./stream/StreamHelper"),f=e("./defaults"),c=e("./compressedObject"),d=e("./zipObject"),s=e("./generate"),p=e("./nodejsUtils"),m=e("./nodejs/NodejsStreamInputAdapter"),o=function(e,t,r){var n,i=h.getTypeOf(t),a=h.extend(r||{},f);a.date=a.date||new Date,null!==a.compression&&(a.compression=a.compression.toUpperCase()),"string"==typeof a.unixPermissions&&(a.unixPermissions=parseInt(a.unixPermissions,8)),a.unixPermissions&&16384&a.unixPermissions&&(a.dir=!0),a.dosPermissions&&16&a.dosPermissions&&(a.dir=!0),a.dir&&(e=g(e)),a.createFolders&&(n=_(e))&&b.call(this,n,!0);var s="string"===i&&!1===a.binary&&!1===a.base64;r&&void 0!==r.binary||(a.binary=!s),(t instanceof c&&0===t.uncompressedSize||a.dir||!t||0===t.length)&&(a.base64=!1,a.binary=!0,t="",a.compression="STORE",i="string");var o=null;o=t instanceof c||t instanceof l?t:p.isNode&&p.isStream(t)?new m(e,t):h.prepareContent(e,t,a.binary,a.optimizedBinaryString,a.base64);var u=new d(e,o,a);this.files[e]=u},_=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return 0<t?e.substring(0,t):""},g=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},b=function(e,t){return t=void 0!==t?t:f.createFolders,e=g(e),this.files[e]||o.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function u(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var n={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,r,n;for(t in this.files)this.files.hasOwnProperty(t)&&(n=this.files[t],(r=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(r,n))},filter:function(r){var n=[];return this.forEach(function(e,t){r(e,t)&&n.push(t)}),n},file:function(e,t,r){if(1===arguments.length){if(u(e)){var n=e;return this.filter(function(e,t){return!t.dir&&n.test(e)})}var i=this.files[this.root+e];return i&&!i.dir?i:null}return e=this.root+e,o.call(this,e,t,r),this},folder:function(r){if(!r)return this;if(u(r))return this.filter(function(e,t){return t.dir&&r.test(e)});var e=this.root+r,t=b.call(this,e),n=this.clone();return n.root=t.name,n},remove:function(r){r=this.root+r;var e=this.files[r];if(e||("/"!==r.slice(-1)&&(r+="/"),e=this.files[r]),e&&!e.dir)delete this.files[r];else for(var t=this.filter(function(e,t){return t.name.slice(0,r.length)===r}),n=0;n<t.length;n++)delete this.files[t[n].name];return this},generate:function(e){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,r={};try{if((r=h.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:i.utf8encode})).type=r.type.toLowerCase(),r.compression=r.compression.toUpperCase(),"binarystring"===r.type&&(r.type="string"),!r.type)throw new Error("No output type specified.");h.checkSupport(r.type),"darwin"!==r.platform&&"freebsd"!==r.platform&&"linux"!==r.platform&&"sunos"!==r.platform||(r.platform="UNIX"),"win32"===r.platform&&(r.platform="DOS");var n=r.comment||this.comment||"";t=s.generateWorker(this,r,n)}catch(e){(t=new l("error")).error(e)}return new a(t,r.type||"string",r.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}};t.exports=n},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,t,r){t.exports=e("stream")},{stream:void 0}],17:[function(e,t,r){var n=e("./DataReader");function i(e){n.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}e("../utils").inherits(i,n),i.prototype.byteAt=function(e){return this.data[this.zero+e]},i.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),r=e.charCodeAt(1),n=e.charCodeAt(2),i=e.charCodeAt(3),a=this.length-4;0<=a;--a)if(this.data[a]===t&&this.data[a+1]===r&&this.data[a+2]===n&&this.data[a+3]===i)return a-this.zero;return-1},i.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1),n=e.charCodeAt(2),i=e.charCodeAt(3),a=this.readData(4);return t===a[0]&&r===a[1]&&n===a[2]&&i===a[3]},i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./DataReader":18}],18:[function(e,t,r){var n=e("../utils");function i(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}i.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(e){},readInt:function(e){var t,r=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)r=(r<<8)+this.byteAt(t);return this.index+=e,r},readString:function(e){return n.transformTo("string",this.readData(e))},readData:function(e){},lastIndexOfSignature:function(e){},readAndCheckSignature:function(e){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},t.exports=i},{"../utils":32}],19:[function(e,t,r){var n=e("./Uint8ArrayReader");function i(e){n.call(this,e)}e("../utils").inherits(i,n),i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,t,r){var n=e("./DataReader");function i(e){n.call(this,e)}e("../utils").inherits(i,n),i.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},i.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},i.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./DataReader":18}],21:[function(e,t,r){var n=e("./ArrayReader");function i(e){n.call(this,e)}e("../utils").inherits(i,n),i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./ArrayReader":17}],22:[function(e,t,r){var n=e("../utils"),i=e("../support"),a=e("./ArrayReader"),s=e("./StringReader"),o=e("./NodeBufferReader"),u=e("./Uint8ArrayReader");t.exports=function(e){var t=n.getTypeOf(e);return n.checkSupport(t),"string"!==t||i.uint8array?"nodebuffer"===t?new o(e):i.uint8array?new u(n.transformTo("uint8array",e)):new a(n.transformTo("array",e)):new s(e)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,t,r){r.LOCAL_FILE_HEADER="PK",r.CENTRAL_FILE_HEADER="PK",r.CENTRAL_DIRECTORY_END="PK",r.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",r.ZIP64_CENTRAL_DIRECTORY_END="PK",r.DATA_DESCRIPTOR="PK\b"},{}],24:[function(e,t,r){var n=e("./GenericWorker"),i=e("../utils");function a(e){n.call(this,"ConvertWorker to "+e),this.destType=e}i.inherits(a,n),a.prototype.processChunk=function(e){this.push({data:i.transformTo(this.destType,e.data),meta:e.meta})},t.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(e,t,r){var n=e("./GenericWorker"),i=e("../crc32");function a(){n.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(a,n),a.prototype.processChunk=function(e){this.streamInfo.crc32=i(e.data,this.streamInfo.crc32||0),this.push(e)},t.exports=a},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,t,r){var n=e("../utils"),i=e("./GenericWorker");function a(e){i.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}n.inherits(a,i),a.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}i.prototype.processChunk.call(this,e)},t.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(e,t,r){var n=e("../utils"),i=e("./GenericWorker");function a(e){i.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then(function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=n.getTypeOf(e),t.isPaused||t._tickAndRepeat()},function(e){t.error(e)})}n.inherits(a,i),a.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this.data=null},a.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,n.delay(this._tickAndRepeat,[],this)),!0)},a.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(n.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},a.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=a},{"../utils":32,"./GenericWorker":28}],28:[function(e,t,r){function n(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}n.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var r=0;r<this._listeners[e].length;r++)this._listeners[e][r].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.end()}),e.on("error",function(e){t.error(e)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var e=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)this.extraStreamInfo.hasOwnProperty(e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},t.exports=n},{}],29:[function(e,t,r){var u=e("../utils"),i=e("./ConvertWorker"),a=e("./GenericWorker"),h=e("../base64"),n=e("../support"),s=e("../external"),o=null;if(n.nodestream)try{o=e("../nodejs/NodejsStreamOutputAdapter")}catch(e){}function l(e,o){return new s.Promise(function(t,r){var n=[],i=e._internalType,a=e._outputType,s=e._mimeType;e.on("data",function(e,t){n.push(e),o&&o(t)}).on("error",function(e){n=[],r(e)}).on("end",function(){try{var e=function(e,t,r){switch(e){case"blob":return u.newBlob(u.transformTo("arraybuffer",t),r);case"base64":return h.encode(t);default:return u.transformTo(e,t)}}(a,function(e,t){var r,n=0,i=null,a=0;for(r=0;r<t.length;r++)a+=t[r].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(i=new Uint8Array(a),r=0;r<t.length;r++)i.set(t[r],n),n+=t[r].length;return i;case"nodebuffer":return Buffer.concat(t);default:throw new Error("concat : unsupported type '"+e+"'")}}(i,n),s);t(e)}catch(e){r(e)}n=[]}).resume()})}function f(e,t,r){var n=t;switch(t){case"blob":case"arraybuffer":n="uint8array";break;case"base64":n="string"}try{this._internalType=n,this._outputType=t,this._mimeType=r,u.checkSupport(n),this._worker=e.pipe(new i(n)),e.lock()}catch(e){this._worker=new a("error"),this._worker.error(e)}}f.prototype={accumulate:function(e){return l(this,e)},on:function(e,t){var r=this;return"data"===e?this._worker.on(e,function(e){t.call(r,e.data,e.meta)}):this._worker.on(e,function(){u.delay(t,arguments,r)}),this},resume:function(){return u.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(u.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new o(this,{objectMode:"nodebuffer"!==this._outputType},e)}},t.exports=f},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,t,r){if(r.base64=!0,r.array=!0,r.string=!0,r.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,r.nodebuffer="undefined"!=typeof Buffer,r.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)r.blob=!1;else{var n=new ArrayBuffer(0);try{r.blob=0===new Blob([n],{type:"application/zip"}).size}catch(e){try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);i.append(n),r.blob=0===i.getBlob("application/zip").size}catch(e){r.blob=!1}}}try{r.nodestream=!!e("readable-stream").Readable}catch(e){r.nodestream=!1}},{"readable-stream":16}],31:[function(e,t,a){for(var o=e("./utils"),u=e("./support"),r=e("./nodejsUtils"),n=e("./stream/GenericWorker"),h=new Array(256),i=0;i<256;i++)h[i]=252<=i?6:248<=i?5:240<=i?4:224<=i?3:192<=i?2:1;h[254]=h[254]=1;function s(){n.call(this,"utf-8 decode"),this.leftOver=null}function l(){n.call(this,"utf-8 encode")}a.utf8encode=function(e){return u.nodebuffer?r.newBufferFrom(e,"utf-8"):function(e){var t,r,n,i,a,s=e.length,o=0;for(i=0;i<s;i++)55296==(64512&(r=e.charCodeAt(i)))&&i+1<s&&56320==(64512&(n=e.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(n-56320),i++),o+=r<128?1:r<2048?2:r<65536?3:4;for(t=u.uint8array?new Uint8Array(o):new Array(o),i=a=0;a<o;i++)55296==(64512&(r=e.charCodeAt(i)))&&i+1<s&&56320==(64512&(n=e.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(n-56320),i++),r<128?t[a++]=r:(r<2048?t[a++]=192|r>>>6:(r<65536?t[a++]=224|r>>>12:(t[a++]=240|r>>>18,t[a++]=128|r>>>12&63),t[a++]=128|r>>>6&63),t[a++]=128|63&r);return t}(e)},a.utf8decode=function(e){return u.nodebuffer?o.transformTo("nodebuffer",e).toString("utf-8"):function(e){var t,r,n,i,a=e.length,s=new Array(2*a);for(t=r=0;t<a;)if((n=e[t++])<128)s[r++]=n;else if(4<(i=h[n]))s[r++]=65533,t+=i-1;else{for(n&=2===i?31:3===i?15:7;1<i&&t<a;)n=n<<6|63&e[t++],i--;1<i?s[r++]=65533:n<65536?s[r++]=n:(n-=65536,s[r++]=55296|n>>10&1023,s[r++]=56320|1023&n)}return s.length!==r&&(s.subarray?s=s.subarray(0,r):s.length=r),o.applyFromCharCode(s)}(e=o.transformTo(u.uint8array?"uint8array":"array",e))},o.inherits(s,n),s.prototype.processChunk=function(e){var t=o.transformTo(u.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(u.uint8array){var r=t;(t=new Uint8Array(r.length+this.leftOver.length)).set(this.leftOver,0),t.set(r,this.leftOver.length)}else t=this.leftOver.concat(t);this.leftOver=null}var n=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;0<=r&&128==(192&e[r]);)r--;return r<0?t:0===r?t:r+h[e[r]]>t?r:t}(t),i=t;n!==t.length&&(u.uint8array?(i=t.subarray(0,n),this.leftOver=t.subarray(n,t.length)):(i=t.slice(0,n),this.leftOver=t.slice(n,t.length))),this.push({data:a.utf8decode(i),meta:e.meta})},s.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:a.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},a.Utf8DecodeWorker=s,o.inherits(l,n),l.prototype.processChunk=function(e){this.push({data:a.utf8encode(e.data),meta:e.meta})},a.Utf8EncodeWorker=l},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,t,o){var u=e("./support"),h=e("./base64"),r=e("./nodejsUtils"),n=e("core-js/library/fn/set-immediate"),l=e("./external");function i(e){return e}function f(e,t){for(var r=0;r<e.length;++r)t[r]=255&e.charCodeAt(r);return t}o.newBlob=function(t,r){o.checkSupport("blob");try{return new Blob([t],{type:r})}catch(e){try{var n=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return n.append(t),n.getBlob(r)}catch(e){throw new Error("Bug : can't construct the Blob.")}}};var a={stringifyByChunk:function(e,t,r){var n=[],i=0,a=e.length;if(a<=r)return String.fromCharCode.apply(null,e);for(;i<a;)"array"===t||"nodebuffer"===t?n.push(String.fromCharCode.apply(null,e.slice(i,Math.min(i+r,a)))):n.push(String.fromCharCode.apply(null,e.subarray(i,Math.min(i+r,a)))),i+=r;return n.join("")},stringifyByChar:function(e){for(var t="",r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},applyCanBeUsed:{uint8array:function(){try{return u.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return u.nodebuffer&&1===String.fromCharCode.apply(null,r.allocBuffer(1)).length}catch(e){return!1}}()}};function s(e){var t=65536,r=o.getTypeOf(e),n=!0;if("uint8array"===r?n=a.applyCanBeUsed.uint8array:"nodebuffer"===r&&(n=a.applyCanBeUsed.nodebuffer),n)for(;1<t;)try{return a.stringifyByChunk(e,r,t)}catch(e){t=Math.floor(t/2)}return a.stringifyByChar(e)}function c(e,t){for(var r=0;r<e.length;r++)t[r]=e[r];return t}o.applyFromCharCode=s;var d={};d.string={string:i,array:function(e){return f(e,new Array(e.length))},arraybuffer:function(e){return d.string.uint8array(e).buffer},uint8array:function(e){return f(e,new Uint8Array(e.length))},nodebuffer:function(e){return f(e,r.allocBuffer(e.length))}},d.array={string:s,array:i,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return r.newBufferFrom(e)}},d.arraybuffer={string:function(e){return s(new Uint8Array(e))},array:function(e){return c(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:i,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return r.newBufferFrom(new Uint8Array(e))}},d.uint8array={string:s,array:function(e){return c(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:i,nodebuffer:function(e){return r.newBufferFrom(e)}},d.nodebuffer={string:s,array:function(e){return c(e,new Array(e.length))},arraybuffer:function(e){return d.nodebuffer.uint8array(e).buffer},uint8array:function(e){return c(e,new Uint8Array(e.length))},nodebuffer:i},o.transformTo=function(e,t){if(t||(t=""),!e)return t;o.checkSupport(e);var r=o.getTypeOf(t);return d[r][e](t)},o.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":u.nodebuffer&&r.isBuffer(e)?"nodebuffer":u.uint8array&&e instanceof Uint8Array?"uint8array":u.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},o.checkSupport=function(e){if(!u[e.toLowerCase()])throw new Error(e+" is not supported by this platform")},o.MAX_VALUE_16BITS=65535,o.MAX_VALUE_32BITS=-1,o.pretty=function(e){var t,r,n="";for(r=0;r<(e||"").length;r++)n+="\\x"+((t=e.charCodeAt(r))<16?"0":"")+t.toString(16).toUpperCase();return n},o.delay=function(e,t,r){n(function(){e.apply(r||null,t||[])})},o.inherits=function(e,t){var r=function(){};r.prototype=t.prototype,e.prototype=new r},o.extend=function(){var e,t,r={};for(e=0;e<arguments.length;e++)for(t in arguments[e])arguments[e].hasOwnProperty(t)&&void 0===r[t]&&(r[t]=arguments[e][t]);return r},o.prepareContent=function(n,e,i,a,s){return l.Promise.resolve(e).then(function(n){return u.blob&&(n instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(n)))&&"undefined"!=typeof FileReader?new l.Promise(function(t,r){var e=new FileReader;e.onload=function(e){t(e.target.result)},e.onerror=function(e){r(e.target.error)},e.readAsArrayBuffer(n)}):n}).then(function(e){var t,r=o.getTypeOf(e);return r?("arraybuffer"===r?e=o.transformTo("uint8array",e):"string"===r&&(s?e=h.decode(e):i&&!0!==a&&(e=f(t=e,u.uint8array?new Uint8Array(t.length):new Array(t.length)))),e):l.Promise.reject(new Error("Can't read the data of '"+n+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,"core-js/library/fn/set-immediate":36}],33:[function(e,t,r){var n=e("./reader/readerFor"),i=e("./utils"),a=e("./signature"),s=e("./zipEntry"),o=(e("./utf8"),e("./support"));function u(e){this.files=[],this.loadOptions=e}u.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+i.pretty(t)+", expected "+i.pretty(e)+")")}},isSignature:function(e,t){var r=this.reader.index;this.reader.setIndex(e);var n=this.reader.readString(4)===t;return this.reader.setIndex(r),n},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=o.uint8array?"uint8array":"array",r=i.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(r)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,r,n=this.zip64EndOfCentralSize-44;0<n;)e=this.reader.readInt(2),t=this.reader.readInt(4),r=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:r}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)(e=new s({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(e<0)throw!this.isSignature(0,a.LOCAL_FILE_HEADER)?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory");this.reader.setIndex(e);var t=e;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===i.MAX_VALUE_16BITS||this.diskWithCentralDirStart===i.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===i.MAX_VALUE_16BITS||this.centralDirRecords===i.MAX_VALUE_16BITS||this.centralDirSize===i.MAX_VALUE_32BITS||this.centralDirOffset===i.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var r=this.centralDirOffset+this.centralDirSize;this.zip64&&(r+=20,r+=12+this.zip64EndOfCentralSize);var n=t-r;if(0<n)this.isSignature(t,a.CENTRAL_FILE_HEADER)||(this.reader.zero=n);else if(n<0)throw new Error("Corrupted zip: missing "+Math.abs(n)+" bytes.")},prepareReader:function(e){this.reader=n(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=u},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utf8":31,"./utils":32,"./zipEntry":34}],34:[function(e,t,r){var n=e("./reader/readerFor"),a=e("./utils"),i=e("./compressedObject"),s=e("./crc32"),o=e("./utf8"),u=e("./compressions"),h=e("./support");function l(e,t){this.options=e,this.loadOptions=t}l.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(e){var t,r;if(e.skip(22),this.fileNameLength=e.readInt(2),r=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(r),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in u)if(u.hasOwnProperty(t)&&u[t].magic===e)return u[t];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new i(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0===e&&(this.dosPermissions=63&this.externalFileAttributes),3===e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(e){if(this.extraFields[1]){var t=n(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=t.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=t.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=t.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=t.readInt(4))}},readExtraFields:function(e){var t,r,n,i=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index<i;)t=e.readInt(2),r=e.readInt(2),n=e.readData(r),this.extraFields[t]={id:t,length:r,value:n}},handleUTF8:function(){var e=h.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=o.utf8decode(this.fileName),this.fileCommentStr=o.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var r=a.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(r)}var n=this.findExtraFieldUnicodeComment();if(null!==n)this.fileCommentStr=n;else{var i=a.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(i)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=n(e.value);return 1!==t.readInt(1)?null:s(this.fileName)!==t.readInt(4)?null:o.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=n(e.value);return 1!==t.readInt(1)?null:s(this.fileComment)!==t.readInt(4)?null:o.utf8decode(t.readData(e.length-5))}return null}},t.exports=l},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,t,r){var a=e("./stream/StreamHelper"),n=e("./stream/DataWorker"),s=e("./utf8"),i=e("./compressedObject"),o=e("./stream/GenericWorker"),u=function(e,t,r){this.name=e,this.dir=r.dir,this.date=r.date,this.comment=r.comment,this.unixPermissions=r.unixPermissions,this.dosPermissions=r.dosPermissions,this._data=t,this._dataBinary=r.binary,this.options={compression:r.compression,compressionOptions:r.compressionOptions}};u.prototype={internalStream:function(e){var t=null,r="string";try{if(!e)throw new Error("No output type specified.");var n="string"===(r=e.toLowerCase())||"text"===r;"binarystring"!==r&&"text"!==r||(r="string"),t=this._decompressWorker();var i=!this._dataBinary;i&&!n&&(t=t.pipe(new s.Utf8EncodeWorker)),!i&&n&&(t=t.pipe(new s.Utf8DecodeWorker))}catch(e){(t=new o("error")).error(e)}return new a(t,r,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof i&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var r=this._decompressWorker();return this._dataBinary||(r=r.pipe(new s.Utf8EncodeWorker)),i.createWorkerFrom(r,e,t)},_decompressWorker:function(){return this._data instanceof i?this._data.getContentWorker():this._data instanceof o?this._data:new n(this._data)}};for(var h=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],l=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},f=0;f<h.length;f++)u.prototype[h[f]]=l;t.exports=u},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,t,r){e("../modules/web.immediate"),t.exports=e("../modules/_core").setImmediate},{"../modules/_core":40,"../modules/web.immediate":56}],37:[function(e,t,r){t.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},{}],38:[function(e,t,r){var n=e("./_is-object");t.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},{"./_is-object":51}],39:[function(e,t,r){var n={}.toString;t.exports=function(e){return n.call(e).slice(8,-1)}},{}],40:[function(e,t,r){var n=t.exports={version:"2.3.0"};"number"==typeof __e&&(__e=n)},{}],41:[function(e,t,r){var a=e("./_a-function");t.exports=function(n,i,e){if(a(n),void 0===i)return n;switch(e){case 1:return function(e){return n.call(i,e)};case 2:return function(e,t){return n.call(i,e,t)};case 3:return function(e,t,r){return n.call(i,e,t,r)}}return function(){return n.apply(i,arguments)}}},{"./_a-function":37}],42:[function(e,t,r){t.exports=!e("./_fails")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},{"./_fails":45}],43:[function(e,t,r){var n=e("./_is-object"),i=e("./_global").document,a=n(i)&&n(i.createElement);t.exports=function(e){return a?i.createElement(e):{}}},{"./_global":46,"./_is-object":51}],44:[function(e,t,r){var _=e("./_global"),g=e("./_core"),b=e("./_ctx"),v=e("./_hide"),y="prototype",n=function e(t,r,n){var i,a,s,o=t&e.F,u=t&e.G,h=t&e.S,l=t&e.P,f=t&e.B,c=t&e.W,d=u?g:g[r]||(g[r]={}),p=d[y],m=u?_:h?_[r]:(_[r]||{})[y];for(i in u&&(n=r),n)(a=!o&&m&&void 0!==m[i])&&i in d||(s=a?m[i]:n[i],d[i]=u&&"function"!=typeof m[i]?n[i]:f&&a?b(s,_):c&&m[i]==s?function(n){var e=function(e,t,r){if(this instanceof n){switch(arguments.length){case 0:return new n;case 1:return new n(e);case 2:return new n(e,t)}return new n(e,t,r)}return n.apply(this,arguments)};return e[y]=n[y],e}(s):l&&"function"==typeof s?b(Function.call,s):s,l&&((d.virtual||(d.virtual={}))[i]=s,t&e.R&&p&&!p[i]&&v(p,i,s)))};n.F=1,n.G=2,n.S=4,n.P=8,n.B=16,n.W=32,n.U=64,n.R=128,t.exports=n},{"./_core":40,"./_ctx":41,"./_global":46,"./_hide":47}],45:[function(e,t,r){t.exports=function(e){try{return!!e()}catch(e){return!0}}},{}],46:[function(e,t,r){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},{}],47:[function(e,t,r){var n=e("./_object-dp"),i=e("./_property-desc");t.exports=e("./_descriptors")?function(e,t,r){return n.f(e,t,i(1,r))}:function(e,t,r){return e[t]=r,e}},{"./_descriptors":42,"./_object-dp":52,"./_property-desc":53}],48:[function(e,t,r){t.exports=e("./_global").document&&document.documentElement},{"./_global":46}],49:[function(e,t,r){t.exports=!e("./_descriptors")&&!e("./_fails")(function(){return 7!=Object.defineProperty(e("./_dom-create")("div"),"a",{get:function(){return 7}}).a})},{"./_descriptors":42,"./_dom-create":43,"./_fails":45}],50:[function(e,t,r){t.exports=function(e,t,r){var n=void 0===r;switch(t.length){case 0:return n?e():e.call(r);case 1:return n?e(t[0]):e.call(r,t[0]);case 2:return n?e(t[0],t[1]):e.call(r,t[0],t[1]);case 3:return n?e(t[0],t[1],t[2]):e.call(r,t[0],t[1],t[2]);case 4:return n?e(t[0],t[1],t[2],t[3]):e.call(r,t[0],t[1],t[2],t[3])}return e.apply(r,t)}},{}],51:[function(e,t,r){t.exports=function(e){return"object"===(void 0===e?"undefined":_typeof(e))?null!==e:"function"==typeof e}},{}],52:[function(e,t,r){var n=e("./_an-object"),i=e("./_ie8-dom-define"),a=e("./_to-primitive"),s=Object.defineProperty;r.f=e("./_descriptors")?Object.defineProperty:function(e,t,r){if(n(e),t=a(t,!0),n(r),i)try{return s(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},{"./_an-object":38,"./_descriptors":42,"./_ie8-dom-define":49,"./_to-primitive":55}],53:[function(e,t,r){t.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},{}],54:[function(e,t,r){var n,i,a,s=e("./_ctx"),o=e("./_invoke"),u=e("./_html"),h=e("./_dom-create"),l=e("./_global"),f=l.process,c=l.setImmediate,d=l.clearImmediate,p=l.MessageChannel,m=0,_={},g="onreadystatechange",b=function(){var e=+this;if(_.hasOwnProperty(e)){var t=_[e];delete _[e],t()}},v=function(e){b.call(e.data)};c&&d||(c=function(e){for(var t=[],r=1;arguments.length>r;)t.push(arguments[r++]);return _[++m]=function(){o("function"==typeof e?e:Function(e),t)},n(m),m},d=function(e){delete _[e]},"process"==e("./_cof")(f)?n=function(e){f.nextTick(s(b,e,1))}:p?(a=(i=new p).port2,i.port1.onmessage=v,n=s(a.postMessage,a,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(n=function(e){l.postMessage(e+"","*")},l.addEventListener("message",v,!1)):n=g in h("script")?function(e){u.appendChild(h("script"))[g]=function(){u.removeChild(this),b.call(e)}}:function(e){setTimeout(s(b,e,1),0)}),t.exports={set:c,clear:d}},{"./_cof":39,"./_ctx":41,"./_dom-create":43,"./_global":46,"./_html":48,"./_invoke":50}],55:[function(e,t,r){var i=e("./_is-object");t.exports=function(e,t){if(!i(e))return e;var r,n;if(t&&"function"==typeof(r=e.toString)&&!i(n=r.call(e)))return n;if("function"==typeof(r=e.valueOf)&&!i(n=r.call(e)))return n;if(!t&&"function"==typeof(r=e.toString)&&!i(n=r.call(e)))return n;throw TypeError("Can't convert object to primitive value")}},{"./_is-object":51}],56:[function(e,t,r){var n=e("./_export"),i=e("./_task");n(n.G+n.B,{setImmediate:i.set,clearImmediate:i.clear})},{"./_export":44,"./_task":54}],57:[function(e,l,t){(function(t){var r,n,e=t.MutationObserver||t.WebKitMutationObserver;if(e){var i=0,a=new e(h),s=t.document.createTextNode("");a.observe(s,{characterData:!0}),r=function(){s.data=i=++i%2}}else if(t.setImmediate||void 0===t.MessageChannel)r="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){h(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(h,0)};else{var o=new t.MessageChannel;o.port1.onmessage=h,r=function(){o.port2.postMessage(0)}}var u=[];function h(){var e,t;n=!0;for(var r=u.length;r;){for(t=u,u=[],e=-1;++e<r;)t[e]();r=u.length}n=!1}l.exports=function(e){1!==u.push(e)||n||r()}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],58:[function(e,t,r){var i=e("immediate");function h(){}var l={},a=["REJECTED"],s=["FULFILLED"],n=["PENDING"];function o(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=n,this.queue=[],this.outcome=void 0,e!==h&&d(this,e)}function u(e,t,r){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function f(t,r,n){i(function(){var e;try{e=r(n)}catch(e){return l.reject(t,e)}e===t?l.reject(t,new TypeError("Cannot resolve promise with itself")):l.resolve(t,e)})}function c(e){var t=e&&e.then;if(e&&("object"===(void 0===e?"undefined":_typeof(e))||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function d(t,e){var r=!1;function n(e){r||(r=!0,l.reject(t,e))}function i(e){r||(r=!0,l.resolve(t,e))}var a=p(function(){e(i,n)});"error"===a.status&&n(a.value)}function p(e,t){var r={};try{r.value=e(t),r.status="success"}catch(e){r.status="error",r.value=e}return r}(t.exports=o).prototype.catch=function(e){return this.then(null,e)},o.prototype.then=function(e,t){if("function"!=typeof e&&this.state===s||"function"!=typeof t&&this.state===a)return this;var r=new this.constructor(h);this.state!==n?f(r,this.state===s?e:t,this.outcome):this.queue.push(new u(r,e,t));return r},u.prototype.callFulfilled=function(e){l.resolve(this.promise,e)},u.prototype.otherCallFulfilled=function(e){f(this.promise,this.onFulfilled,e)},u.prototype.callRejected=function(e){l.reject(this.promise,e)},u.prototype.otherCallRejected=function(e){f(this.promise,this.onRejected,e)},l.resolve=function(e,t){var r=p(c,t);if("error"===r.status)return l.reject(e,r.value);var n=r.value;if(n)d(e,n);else{e.state=s,e.outcome=t;for(var i=-1,a=e.queue.length;++i<a;)e.queue[i].callFulfilled(t)}return e},l.reject=function(e,t){e.state=a,e.outcome=t;for(var r=-1,n=e.queue.length;++r<n;)e.queue[r].callRejected(t);return e},o.resolve=function(e){if(e instanceof this)return e;return l.resolve(new this(h),e)},o.reject=function(e){var t=new this(h);return l.reject(t,e)},o.all=function(e){var r=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,i=!1;if(!n)return this.resolve([]);var a=new Array(n),s=0,t=-1,o=new this(h);for(;++t<n;)u(e[t],t);return o;function u(e,t){r.resolve(e).then(function(e){a[t]=e,++s!==n||i||(i=!0,l.resolve(o,a))},function(e){i||(i=!0,l.reject(o,e))})}},o.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,n=!1;if(!r)return this.resolve([]);var i=-1,a=new this(h);for(;++i<r;)s=e[i],t.resolve(s).then(function(e){n||(n=!0,l.resolve(a,e))},function(e){n||(n=!0,l.reject(a,e))});var s;return a}},{immediate:57}],59:[function(e,t,r){var n={};(0,e("./lib/utils/common").assign)(n,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=n},{"./lib/deflate":60,"./lib/inflate":61,"./lib/utils/common":62,"./lib/zlib/constants":65}],60:[function(e,t,r){var s=e("./zlib/deflate"),o=e("./utils/common"),u=e("./utils/strings"),i=e("./zlib/messages"),a=e("./zlib/zstream"),h=Object.prototype.toString,l=0,f=-1,c=0,d=8;function p(e){if(!(this instanceof p))return new p(e);this.options=o.assign({level:f,method:d,chunkSize:16384,windowBits:15,memLevel:8,strategy:c,to:""},e||{});var t=this.options;t.raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0;var r=s.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==l)throw new Error(i[r]);if(t.header&&s.deflateSetHeader(this.strm,t.header),t.dictionary){var n;if(n="string"==typeof t.dictionary?u.string2buf(t.dictionary):"[object ArrayBuffer]"===h.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(r=s.deflateSetDictionary(this.strm,n))!==l)throw new Error(i[r]);this._dict_set=!0}}function n(e,t){var r=new p(t);if(r.push(e,!0),r.err)throw r.msg||i[r.err];return r.result}p.prototype.push=function(e,t){var r,n,i=this.strm,a=this.options.chunkSize;if(this.ended)return!1;n=t===~~t?t:!0===t?4:0,"string"==typeof e?i.input=u.string2buf(e):"[object ArrayBuffer]"===h.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;do{if(0===i.avail_out&&(i.output=new o.Buf8(a),i.next_out=0,i.avail_out=a),1!==(r=s.deflate(i,n))&&r!==l)return this.onEnd(r),!(this.ended=!0);0!==i.avail_out&&(0!==i.avail_in||4!==n&&2!==n)||("string"===this.options.to?this.onData(u.buf2binstring(o.shrinkBuf(i.output,i.next_out))):this.onData(o.shrinkBuf(i.output,i.next_out)))}while((0<i.avail_in||0===i.avail_out)&&1!==r);return 4===n?(r=s.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===l):2!==n||(this.onEnd(l),!(i.avail_out=0))},p.prototype.onData=function(e){this.chunks.push(e)},p.prototype.onEnd=function(e){e===l&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},r.Deflate=p,r.deflate=n,r.deflateRaw=function(e,t){return(t=t||{}).raw=!0,n(e,t)},r.gzip=function(e,t){return(t=t||{}).gzip=!0,n(e,t)}},{"./utils/common":62,"./utils/strings":63,"./zlib/deflate":67,"./zlib/messages":72,"./zlib/zstream":74}],61:[function(e,t,r){var c=e("./zlib/inflate"),d=e("./utils/common"),p=e("./utils/strings"),m=e("./zlib/constants"),n=e("./zlib/messages"),i=e("./zlib/zstream"),a=e("./zlib/gzheader"),_=Object.prototype.toString;function s(e){if(!(this instanceof s))return new s(e);this.options=d.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new i,this.strm.avail_out=0;var r=c.inflateInit2(this.strm,t.windowBits);if(r!==m.Z_OK)throw new Error(n[r]);this.header=new a,c.inflateGetHeader(this.strm,this.header)}function o(e,t){var r=new s(t);if(r.push(e,!0),r.err)throw r.msg||n[r.err];return r.result}s.prototype.push=function(e,t){var r,n,i,a,s,o,u=this.strm,h=this.options.chunkSize,l=this.options.dictionary,f=!1;if(this.ended)return!1;n=t===~~t?t:!0===t?m.Z_FINISH:m.Z_NO_FLUSH,"string"==typeof e?u.input=p.binstring2buf(e):"[object ArrayBuffer]"===_.call(e)?u.input=new Uint8Array(e):u.input=e,u.next_in=0,u.avail_in=u.input.length;do{if(0===u.avail_out&&(u.output=new d.Buf8(h),u.next_out=0,u.avail_out=h),(r=c.inflate(u,m.Z_NO_FLUSH))===m.Z_NEED_DICT&&l&&(o="string"==typeof l?p.string2buf(l):"[object ArrayBuffer]"===_.call(l)?new Uint8Array(l):l,r=c.inflateSetDictionary(this.strm,o)),r===m.Z_BUF_ERROR&&!0===f&&(r=m.Z_OK,f=!1),r!==m.Z_STREAM_END&&r!==m.Z_OK)return this.onEnd(r),!(this.ended=!0);u.next_out&&(0!==u.avail_out&&r!==m.Z_STREAM_END&&(0!==u.avail_in||n!==m.Z_FINISH&&n!==m.Z_SYNC_FLUSH)||("string"===this.options.to?(i=p.utf8border(u.output,u.next_out),a=u.next_out-i,s=p.buf2string(u.output,i),u.next_out=a,u.avail_out=h-a,a&&d.arraySet(u.output,u.output,i,a,0),this.onData(s)):this.onData(d.shrinkBuf(u.output,u.next_out)))),0===u.avail_in&&0===u.avail_out&&(f=!0)}while((0<u.avail_in||0===u.avail_out)&&r!==m.Z_STREAM_END);return r===m.Z_STREAM_END&&(n=m.Z_FINISH),n===m.Z_FINISH?(r=c.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===m.Z_OK):n!==m.Z_SYNC_FLUSH||(this.onEnd(m.Z_OK),!(u.avail_out=0))},s.prototype.onData=function(e){this.chunks.push(e)},s.prototype.onEnd=function(e){e===m.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=d.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},r.Inflate=s,r.inflate=o,r.inflateRaw=function(e,t){return(t=t||{}).raw=!0,o(e,t)},r.ungzip=o},{"./utils/common":62,"./utils/strings":63,"./zlib/constants":65,"./zlib/gzheader":68,"./zlib/inflate":70,"./zlib/messages":72,"./zlib/zstream":74}],62:[function(e,t,r){var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;r.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var r=t.shift();if(r){if("object"!==(void 0===r?"undefined":_typeof(r)))throw new TypeError(r+"must be non-object");for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])}}return e},r.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var i={arraySet:function(e,t,r,n,i){if(t.subarray&&e.subarray)e.set(t.subarray(r,r+n),i);else for(var a=0;a<n;a++)e[i+a]=t[r+a]},flattenChunks:function(e){var t,r,n,i,a,s;for(t=n=0,r=e.length;t<r;t++)n+=e[t].length;for(s=new Uint8Array(n),t=i=0,r=e.length;t<r;t++)a=e[t],s.set(a,i),i+=a.length;return s}},a={arraySet:function(e,t,r,n,i){for(var a=0;a<n;a++)e[i+a]=t[r+a]},flattenChunks:function(e){return[].concat.apply([],e)}};r.setTyped=function(e){e?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,i)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,a))},r.setTyped(n)},{}],63:[function(e,t,r){var u=e("./common"),i=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch(e){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){a=!1}for(var h=new u.Buf8(256),n=0;n<256;n++)h[n]=252<=n?6:248<=n?5:240<=n?4:224<=n?3:192<=n?2:1;function l(e,t){if(t<65537&&(e.subarray&&a||!e.subarray&&i))return String.fromCharCode.apply(null,u.shrinkBuf(e,t));for(var r="",n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r}h[254]=h[254]=1,r.string2buf=function(e){var t,r,n,i,a,s=e.length,o=0;for(i=0;i<s;i++)55296==(64512&(r=e.charCodeAt(i)))&&i+1<s&&56320==(64512&(n=e.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(n-56320),i++),o+=r<128?1:r<2048?2:r<65536?3:4;for(t=new u.Buf8(o),i=a=0;a<o;i++)55296==(64512&(r=e.charCodeAt(i)))&&i+1<s&&56320==(64512&(n=e.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(n-56320),i++),r<128?t[a++]=r:(r<2048?t[a++]=192|r>>>6:(r<65536?t[a++]=224|r>>>12:(t[a++]=240|r>>>18,t[a++]=128|r>>>12&63),t[a++]=128|r>>>6&63),t[a++]=128|63&r);return t},r.buf2binstring=function(e){return l(e,e.length)},r.binstring2buf=function(e){for(var t=new u.Buf8(e.length),r=0,n=t.length;r<n;r++)t[r]=e.charCodeAt(r);return t},r.buf2string=function(e,t){var r,n,i,a,s=t||e.length,o=new Array(2*s);for(r=n=0;r<s;)if((i=e[r++])<128)o[n++]=i;else if(4<(a=h[i]))o[n++]=65533,r+=a-1;else{for(i&=2===a?31:3===a?15:7;1<a&&r<s;)i=i<<6|63&e[r++],a--;1<a?o[n++]=65533:i<65536?o[n++]=i:(i-=65536,o[n++]=55296|i>>10&1023,o[n++]=56320|1023&i)}return l(o,n)},r.utf8border=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;0<=r&&128==(192&e[r]);)r--;return r<0?t:0===r?t:r+h[e[r]]>t?r:t}},{"./common":62}],64:[function(e,t,r){t.exports=function(e,t,r,n){for(var i=65535&e|0,a=e>>>16&65535|0,s=0;0!==r;){for(r-=s=2e3<r?2e3:r;a=a+(i=i+t[n++]|0)|0,--s;);i%=65521,a%=65521}return i|a<<16|0}},{}],65:[function(e,t,r){t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],66:[function(e,t,r){var o=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();t.exports=function(e,t,r,n){var i=o,a=n+r;e^=-1;for(var s=n;s<a;s++)e=e>>>8^i[255&(e^t[s])];return-1^e}},{}],67:[function(e,t,r){var u,c=e("../utils/common"),h=e("./trees"),d=e("./adler32"),p=e("./crc32"),n=e("./messages"),l=0,f=4,m=0,_=-2,g=-1,b=4,i=2,v=8,y=9,a=286,s=30,o=19,w=2*a+1,k=15,x=3,S=258,z=S+x+1,C=42,E=113,A=1,I=2,O=3,B=4;function R(e,t){return e.msg=n[t],t}function T(e){return(e<<1)-(4<e?9:0)}function D(e){for(var t=e.length;0<=--t;)e[t]=0}function F(e){var t=e.state,r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(c.arraySet(e.output,t.pending_buf,t.pending_out,r,e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))}function N(e,t){h._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,F(e.strm)}function P(e,t){e.pending_buf[e.pending++]=t}function U(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function j(e,t){var r,n,i=e.max_chain_length,a=e.strstart,s=e.prev_length,o=e.nice_match,u=e.strstart>e.w_size-z?e.strstart-(e.w_size-z):0,h=e.window,l=e.w_mask,f=e.prev,c=e.strstart+S,d=h[a+s-1],p=h[a+s];e.prev_length>=e.good_match&&(i>>=2),o>e.lookahead&&(o=e.lookahead);do{if(h[(r=t)+s]===p&&h[r+s-1]===d&&h[r]===h[a]&&h[++r]===h[a+1]){a+=2,r++;do{}while(h[++a]===h[++r]&&h[++a]===h[++r]&&h[++a]===h[++r]&&h[++a]===h[++r]&&h[++a]===h[++r]&&h[++a]===h[++r]&&h[++a]===h[++r]&&h[++a]===h[++r]&&a<c);if(n=S-(c-a),a=c-S,s<n){if(e.match_start=t,o<=(s=n))break;d=h[a+s-1],p=h[a+s]}}}while((t=f[t&l])>u&&0!=--i);return s<=e.lookahead?s:e.lookahead}function L(e){var t,r,n,i,a,s,o,u,h,l,f=e.w_size;do{if(i=e.window_size-e.lookahead-e.strstart,e.strstart>=f+(f-z)){for(c.arraySet(e.window,e.window,f,f,0),e.match_start-=f,e.strstart-=f,e.block_start-=f,t=r=e.hash_size;n=e.head[--t],e.head[t]=f<=n?n-f:0,--r;);for(t=r=f;n=e.prev[--t],e.prev[t]=f<=n?n-f:0,--r;);i+=f}if(0===e.strm.avail_in)break;if(s=e.strm,o=e.window,u=e.strstart+e.lookahead,h=i,l=void 0,l=s.avail_in,h<l&&(l=h),r=0===l?0:(s.avail_in-=l,c.arraySet(o,s.input,s.next_in,l,u),1===s.state.wrap?s.adler=d(s.adler,o,l,u):2===s.state.wrap&&(s.adler=p(s.adler,o,l,u)),s.next_in+=l,s.total_in+=l,l),e.lookahead+=r,e.lookahead+e.insert>=x)for(a=e.strstart-e.insert,e.ins_h=e.window[a],e.ins_h=(e.ins_h<<e.hash_shift^e.window[a+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[a+x-1])&e.hash_mask,e.prev[a&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=a,a++,e.insert--,!(e.lookahead+e.insert<x)););}while(e.lookahead<z&&0!==e.strm.avail_in)}function Z(e,t){for(var r,n;;){if(e.lookahead<z){if(L(e),e.lookahead<z&&t===l)return A;if(0===e.lookahead)break}if(r=0,e.lookahead>=x&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+x-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-z&&(e.match_length=j(e,r)),e.match_length>=x)if(n=h._tr_tally(e,e.strstart-e.match_start,e.match_length-x),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=x){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+x-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,0!=--e.match_length;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else n=h._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(N(e,!1),0===e.strm.avail_out))return A}return e.insert=e.strstart<x-1?e.strstart:x-1,t===f?(N(e,!0),0===e.strm.avail_out?O:B):e.last_lit&&(N(e,!1),0===e.strm.avail_out)?A:I}function W(e,t){for(var r,n,i;;){if(e.lookahead<z){if(L(e),e.lookahead<z&&t===l)return A;if(0===e.lookahead)break}if(r=0,e.lookahead>=x&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+x-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=x-1,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-z&&(e.match_length=j(e,r),e.match_length<=5&&(1===e.strategy||e.match_length===x&&4096<e.strstart-e.match_start)&&(e.match_length=x-1)),e.prev_length>=x&&e.match_length<=e.prev_length){for(i=e.strstart+e.lookahead-x,n=h._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-x),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+x-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!=--e.prev_length;);if(e.match_available=0,e.match_length=x-1,e.strstart++,n&&(N(e,!1),0===e.strm.avail_out))return A}else if(e.match_available){if((n=h._tr_tally(e,0,e.window[e.strstart-1]))&&N(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return A}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=h._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<x-1?e.strstart:x-1,t===f?(N(e,!0),0===e.strm.avail_out?O:B):e.last_lit&&(N(e,!1),0===e.strm.avail_out)?A:I}function M(e,t,r,n,i){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=i}function H(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=v,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new c.Buf16(2*w),this.dyn_dtree=new c.Buf16(2*(2*s+1)),this.bl_tree=new c.Buf16(2*(2*o+1)),D(this.dyn_ltree),D(this.dyn_dtree),D(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new c.Buf16(k+1),this.heap=new c.Buf16(2*a+1),D(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new c.Buf16(2*a+1),D(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function G(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=i,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?C:E,e.adler=2===t.wrap?0:1,t.last_flush=l,h._tr_init(t),m):R(e,_)}function K(e){var t,r=G(e);return r===m&&((t=e.state).window_size=2*t.w_size,D(t.head),t.max_lazy_match=u[t.level].max_lazy,t.good_match=u[t.level].good_length,t.nice_match=u[t.level].nice_length,t.max_chain_length=u[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=x-1,t.match_available=0,t.ins_h=0),r}function Y(e,t,r,n,i,a){if(!e)return _;var s=1;if(t===g&&(t=6),n<0?(s=0,n=-n):15<n&&(s=2,n-=16),i<1||y<i||r!==v||n<8||15<n||t<0||9<t||a<0||b<a)return R(e,_);8===n&&(n=9);var o=new H;return(e.state=o).strm=e,o.wrap=s,o.gzhead=null,o.w_bits=n,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=i+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+x-1)/x),o.window=new c.Buf8(2*o.w_size),o.head=new c.Buf16(o.hash_size),o.prev=new c.Buf16(o.w_size),o.lit_bufsize=1<<i+6,o.pending_buf_size=4*o.lit_bufsize,o.pending_buf=new c.Buf8(o.pending_buf_size),o.d_buf=1*o.lit_bufsize,o.l_buf=3*o.lit_bufsize,o.level=t,o.strategy=a,o.method=r,K(e)}u=[new M(0,0,0,0,function(e,t){var r=65535;for(r>e.pending_buf_size-5&&(r=e.pending_buf_size-5);;){if(e.lookahead<=1){if(L(e),0===e.lookahead&&t===l)return A;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var n=e.block_start+r;if((0===e.strstart||e.strstart>=n)&&(e.lookahead=e.strstart-n,e.strstart=n,N(e,!1),0===e.strm.avail_out))return A;if(e.strstart-e.block_start>=e.w_size-z&&(N(e,!1),0===e.strm.avail_out))return A}return e.insert=0,t===f?(N(e,!0),0===e.strm.avail_out?O:B):(e.strstart>e.block_start&&(N(e,!1),e.strm.avail_out),A)}),new M(4,4,8,4,Z),new M(4,5,16,8,Z),new M(4,6,32,32,Z),new M(4,4,16,16,W),new M(8,16,32,32,W),new M(8,16,128,128,W),new M(8,32,128,256,W),new M(32,128,258,1024,W),new M(32,258,258,4096,W)],r.deflateInit=function(e,t){return Y(e,t,v,15,8,0)},r.deflateInit2=Y,r.deflateReset=K,r.deflateResetKeep=G,r.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?_:(e.state.gzhead=t,m):_},r.deflate=function(e,t){var r,n,i,a;if(!e||!e.state||5<t||t<0)return e?R(e,_):_;if(n=e.state,!e.output||!e.input&&0!==e.avail_in||666===n.status&&t!==f)return R(e,0===e.avail_out?-5:_);if(n.strm=e,r=n.last_flush,n.last_flush=t,n.status===C)if(2===n.wrap)e.adler=0,P(n,31),P(n,139),P(n,8),n.gzhead?(P(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),P(n,255&n.gzhead.time),P(n,n.gzhead.time>>8&255),P(n,n.gzhead.time>>16&255),P(n,n.gzhead.time>>24&255),P(n,9===n.level?2:2<=n.strategy||n.level<2?4:0),P(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(P(n,255&n.gzhead.extra.length),P(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=p(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69):(P(n,0),P(n,0),P(n,0),P(n,0),P(n,0),P(n,9===n.level?2:2<=n.strategy||n.level<2?4:0),P(n,3),n.status=E);else{var s=v+(n.w_bits-8<<4)<<8;s|=(2<=n.strategy||n.level<2?0:n.level<6?1:6===n.level?2:3)<<6,0!==n.strstart&&(s|=32),s+=31-s%31,n.status=E,U(n,s),0!==n.strstart&&(U(n,e.adler>>>16),U(n,65535&e.adler)),e.adler=1}if(69===n.status)if(n.gzhead.extra){for(i=n.pending;n.gzindex<(65535&n.gzhead.extra.length)&&(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>i&&(e.adler=p(e.adler,n.pending_buf,n.pending-i,i)),F(e),i=n.pending,n.pending!==n.pending_buf_size));)P(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++;n.gzhead.hcrc&&n.pending>i&&(e.adler=p(e.adler,n.pending_buf,n.pending-i,i)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=73)}else n.status=73;if(73===n.status)if(n.gzhead.name){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(e.adler=p(e.adler,n.pending_buf,n.pending-i,i)),F(e),i=n.pending,n.pending===n.pending_buf_size)){a=1;break}P(n,a=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0)}while(0!==a);n.gzhead.hcrc&&n.pending>i&&(e.adler=p(e.adler,n.pending_buf,n.pending-i,i)),0===a&&(n.gzindex=0,n.status=91)}else n.status=91;if(91===n.status)if(n.gzhead.comment){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(e.adler=p(e.adler,n.pending_buf,n.pending-i,i)),F(e),i=n.pending,n.pending===n.pending_buf_size)){a=1;break}P(n,a=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0)}while(0!==a);n.gzhead.hcrc&&n.pending>i&&(e.adler=p(e.adler,n.pending_buf,n.pending-i,i)),0===a&&(n.status=103)}else n.status=103;if(103===n.status&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&F(e),n.pending+2<=n.pending_buf_size&&(P(n,255&e.adler),P(n,e.adler>>8&255),e.adler=0,n.status=E)):n.status=E),0!==n.pending){if(F(e),0===e.avail_out)return n.last_flush=-1,m}else if(0===e.avail_in&&T(t)<=T(r)&&t!==f)return R(e,-5);if(666===n.status&&0!==e.avail_in)return R(e,-5);if(0!==e.avail_in||0!==n.lookahead||t!==l&&666!==n.status){var o=2===n.strategy?function(e,t){for(var r;;){if(0===e.lookahead&&(L(e),0===e.lookahead)){if(t===l)return A;break}if(e.match_length=0,r=h._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(N(e,!1),0===e.strm.avail_out))return A}return e.insert=0,t===f?(N(e,!0),0===e.strm.avail_out?O:B):e.last_lit&&(N(e,!1),0===e.strm.avail_out)?A:I}(n,t):3===n.strategy?function(e,t){for(var r,n,i,a,s=e.window;;){if(e.lookahead<=S){if(L(e),e.lookahead<=S&&t===l)return A;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=x&&0<e.strstart&&(n=s[i=e.strstart-1])===s[++i]&&n===s[++i]&&n===s[++i]){a=e.strstart+S;do{}while(n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&i<a);e.match_length=S-(a-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=x?(r=h._tr_tally(e,1,e.match_length-x),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=h._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(N(e,!1),0===e.strm.avail_out))return A}return e.insert=0,t===f?(N(e,!0),0===e.strm.avail_out?O:B):e.last_lit&&(N(e,!1),0===e.strm.avail_out)?A:I}(n,t):u[n.level].func(n,t);if(o!==O&&o!==B||(n.status=666),o===A||o===O)return 0===e.avail_out&&(n.last_flush=-1),m;if(o===I&&(1===t?h._tr_align(n):5!==t&&(h._tr_stored_block(n,0,0,!1),3===t&&(D(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),F(e),0===e.avail_out))return n.last_flush=-1,m}return t!==f?m:n.wrap<=0?1:(2===n.wrap?(P(n,255&e.adler),P(n,e.adler>>8&255),P(n,e.adler>>16&255),P(n,e.adler>>24&255),P(n,255&e.total_in),P(n,e.total_in>>8&255),P(n,e.total_in>>16&255),P(n,e.total_in>>24&255)):(U(n,e.adler>>>16),U(n,65535&e.adler)),F(e),0<n.wrap&&(n.wrap=-n.wrap),0!==n.pending?m:1)},r.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status)!==C&&69!==t&&73!==t&&91!==t&&103!==t&&t!==E&&666!==t?R(e,_):(e.state=null,t===E?R(e,-3):m):_},r.deflateSetDictionary=function(e,t){var r,n,i,a,s,o,u,h,l=t.length;if(!e||!e.state)return _;if(2===(a=(r=e.state).wrap)||1===a&&r.status!==C||r.lookahead)return _;for(1===a&&(e.adler=d(e.adler,t,l,0)),r.wrap=0,l>=r.w_size&&(0===a&&(D(r.head),r.strstart=0,r.block_start=0,r.insert=0),h=new c.Buf8(r.w_size),c.arraySet(h,t,l-r.w_size,r.w_size,0),t=h,l=r.w_size),s=e.avail_in,o=e.next_in,u=e.input,e.avail_in=l,e.next_in=0,e.input=t,L(r);r.lookahead>=x;){for(n=r.strstart,i=r.lookahead-(x-1);r.ins_h=(r.ins_h<<r.hash_shift^r.window[n+x-1])&r.hash_mask,r.prev[n&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=n,n++,--i;);r.strstart=n,r.lookahead=x-1,L(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=x-1,r.match_available=0,e.next_in=o,e.input=u,e.avail_in=s,r.wrap=a,m},r.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":62,"./adler32":64,"./crc32":66,"./messages":72,"./trees":73}],68:[function(e,t,r){t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],69:[function(e,t,r){t.exports=function(e,t){var r,n,i,a,s,o,u,h,l,f,c,d,p,m,_,g,b,v,y,w,k,x,S,z,C;r=e.state,n=e.next_in,z=e.input,i=n+(e.avail_in-5),a=e.next_out,C=e.output,s=a-(t-e.avail_out),o=a+(e.avail_out-257),u=r.dmax,h=r.wsize,l=r.whave,f=r.wnext,c=r.window,d=r.hold,p=r.bits,m=r.lencode,_=r.distcode,g=(1<<r.lenbits)-1,b=(1<<r.distbits)-1;e:do{p<15&&(d+=z[n++]<<p,p+=8,d+=z[n++]<<p,p+=8),v=m[d&g];t:for(;;){if(d>>>=y=v>>>24,p-=y,0===(y=v>>>16&255))C[a++]=65535&v;else{if(!(16&y)){if(0==(64&y)){v=m[(65535&v)+(d&(1<<y)-1)];continue t}if(32&y){r.mode=12;break e}e.msg="invalid literal/length code",r.mode=30;break e}w=65535&v,(y&=15)&&(p<y&&(d+=z[n++]<<p,p+=8),w+=d&(1<<y)-1,d>>>=y,p-=y),p<15&&(d+=z[n++]<<p,p+=8,d+=z[n++]<<p,p+=8),v=_[d&b];r:for(;;){if(d>>>=y=v>>>24,p-=y,!(16&(y=v>>>16&255))){if(0==(64&y)){v=_[(65535&v)+(d&(1<<y)-1)];continue r}e.msg="invalid distance code",r.mode=30;break e}if(k=65535&v,p<(y&=15)&&(d+=z[n++]<<p,(p+=8)<y&&(d+=z[n++]<<p,p+=8)),u<(k+=d&(1<<y)-1)){e.msg="invalid distance too far back",r.mode=30;break e}if(d>>>=y,p-=y,(y=a-s)<k){if(l<(y=k-y)&&r.sane){e.msg="invalid distance too far back",r.mode=30;break e}if(S=c,(x=0)===f){if(x+=h-y,y<w){for(w-=y;C[a++]=c[x++],--y;);x=a-k,S=C}}else if(f<y){if(x+=h+f-y,(y-=f)<w){for(w-=y;C[a++]=c[x++],--y;);if(x=0,f<w){for(w-=y=f;C[a++]=c[x++],--y;);x=a-k,S=C}}}else if(x+=f-y,y<w){for(w-=y;C[a++]=c[x++],--y;);x=a-k,S=C}for(;2<w;)C[a++]=S[x++],C[a++]=S[x++],C[a++]=S[x++],w-=3;w&&(C[a++]=S[x++],1<w&&(C[a++]=S[x++]))}else{for(x=a-k;C[a++]=C[x++],C[a++]=C[x++],C[a++]=C[x++],2<(w-=3););w&&(C[a++]=C[x++],1<w&&(C[a++]=C[x++]))}break}}break}}while(n<i&&a<o);n-=w=p>>3,d&=(1<<(p-=w<<3))-1,e.next_in=n,e.next_out=a,e.avail_in=n<i?i-n+5:5-(n-i),e.avail_out=a<o?o-a+257:257-(a-o),r.hold=d,r.bits=p}},{}],70:[function(e,t,r){var I=e("../utils/common"),O=e("./adler32"),B=e("./crc32"),R=e("./inffast"),T=e("./inftrees"),D=1,F=2,N=0,P=-2,U=1,n=852,i=592;function j(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function a(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new I.Buf16(320),this.work=new I.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function s(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=U,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new I.Buf32(n),t.distcode=t.distdyn=new I.Buf32(i),t.sane=1,t.back=-1,N):P}function o(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,s(e)):P}function u(e,t){var r,n;return e&&e.state?(n=e.state,t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t)?P:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,o(e))):P}function h(e,t){var r,n;return e?(n=new a,(e.state=n).window=null,(r=u(e,t))!==N&&(e.state=null),r):P}var l,f,c=!0;function L(e){if(c){var t;for(l=new I.Buf32(512),f=new I.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(T(D,e.lens,0,288,l,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;T(F,e.lens,0,32,f,0,e.work,{bits:5}),c=!1}e.lencode=l,e.lenbits=9,e.distcode=f,e.distbits=5}function Z(e,t,r,n){var i,a=e.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new I.Buf8(a.wsize)),n>=a.wsize?(I.arraySet(a.window,t,r-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):(n<(i=a.wsize-a.wnext)&&(i=n),I.arraySet(a.window,t,r-n,i,a.wnext),(n-=i)?(I.arraySet(a.window,t,r-n,n,0),a.wnext=n,a.whave=a.wsize):(a.wnext+=i,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=i))),0}r.inflateReset=o,r.inflateReset2=u,r.inflateResetKeep=s,r.inflateInit=function(e){return h(e,15)},r.inflateInit2=h,r.inflate=function(e,t){var r,n,i,a,s,o,u,h,l,f,c,d,p,m,_,g,b,v,y,w,k,x,S,z,C=0,E=new I.Buf8(4),A=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return P;12===(r=e.state).mode&&(r.mode=13),s=e.next_out,i=e.output,u=e.avail_out,a=e.next_in,n=e.input,o=e.avail_in,h=r.hold,l=r.bits,f=o,c=u,x=N;e:for(;;)switch(r.mode){case U:if(0===r.wrap){r.mode=13;break}for(;l<16;){if(0===o)break e;o--,h+=n[a++]<<l,l+=8}if(2&r.wrap&&35615===h){E[r.check=0]=255&h,E[1]=h>>>8&255,r.check=B(r.check,E,2,0),l=h=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&h)<<8)+(h>>8))%31){e.msg="incorrect header check",r.mode=30;break}if(8!=(15&h)){e.msg="unknown compression method",r.mode=30;break}if(l-=4,k=8+(15&(h>>>=4)),0===r.wbits)r.wbits=k;else if(k>r.wbits){e.msg="invalid window size",r.mode=30;break}r.dmax=1<<k,e.adler=r.check=1,r.mode=512&h?10:12,l=h=0;break;case 2:for(;l<16;){if(0===o)break e;o--,h+=n[a++]<<l,l+=8}if(r.flags=h,8!=(255&r.flags)){e.msg="unknown compression method",r.mode=30;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=30;break}r.head&&(r.head.text=h>>8&1),512&r.flags&&(E[0]=255&h,E[1]=h>>>8&255,r.check=B(r.check,E,2,0)),l=h=0,r.mode=3;case 3:for(;l<32;){if(0===o)break e;o--,h+=n[a++]<<l,l+=8}r.head&&(r.head.time=h),512&r.flags&&(E[0]=255&h,E[1]=h>>>8&255,E[2]=h>>>16&255,E[3]=h>>>24&255,r.check=B(r.check,E,4,0)),l=h=0,r.mode=4;case 4:for(;l<16;){if(0===o)break e;o--,h+=n[a++]<<l,l+=8}r.head&&(r.head.xflags=255&h,r.head.os=h>>8),512&r.flags&&(E[0]=255&h,E[1]=h>>>8&255,r.check=B(r.check,E,2,0)),l=h=0,r.mode=5;case 5:if(1024&r.flags){for(;l<16;){if(0===o)break e;o--,h+=n[a++]<<l,l+=8}r.length=h,r.head&&(r.head.extra_len=h),512&r.flags&&(E[0]=255&h,E[1]=h>>>8&255,r.check=B(r.check,E,2,0)),l=h=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&(o<(d=r.length)&&(d=o),d&&(r.head&&(k=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),I.arraySet(r.head.extra,n,a,d,k)),512&r.flags&&(r.check=B(r.check,n,d,a)),o-=d,a+=d,r.length-=d),r.length))break e;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(0===o)break e;for(d=0;k=n[a+d++],r.head&&k&&r.length<65536&&(r.head.name+=String.fromCharCode(k)),k&&d<o;);if(512&r.flags&&(r.check=B(r.check,n,d,a)),o-=d,a+=d,k)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(0===o)break e;for(d=0;k=n[a+d++],r.head&&k&&r.length<65536&&(r.head.comment+=String.fromCharCode(k)),k&&d<o;);if(512&r.flags&&(r.check=B(r.check,n,d,a)),o-=d,a+=d,k)break e}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;l<16;){if(0===o)break e;o--,h+=n[a++]<<l,l+=8}if(h!==(65535&r.check)){e.msg="header crc mismatch",r.mode=30;break}l=h=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=12;break;case 10:for(;l<32;){if(0===o)break e;o--,h+=n[a++]<<l,l+=8}e.adler=r.check=j(h),l=h=0,r.mode=11;case 11:if(0===r.havedict)return e.next_out=s,e.avail_out=u,e.next_in=a,e.avail_in=o,r.hold=h,r.bits=l,2;e.adler=r.check=1,r.mode=12;case 12:if(5===t||6===t)break e;case 13:if(r.last){h>>>=7&l,l-=7&l,r.mode=27;break}for(;l<3;){if(0===o)break e;o--,h+=n[a++]<<l,l+=8}switch(r.last=1&h,l-=1,3&(h>>>=1)){case 0:r.mode=14;break;case 1:if(L(r),r.mode=20,6===t){h>>>=2,l-=2;break e}break;case 2:r.mode=17;break;case 3:e.msg="invalid block type",r.mode=30}h>>>=2,l-=2;break;case 14:for(h>>>=7&l,l-=7&l;l<32;){if(0===o)break e;o--,h+=n[a++]<<l,l+=8}if((65535&h)!=(h>>>16^65535)){e.msg="invalid stored block lengths",r.mode=30;break}if(r.length=65535&h,l=h=0,r.mode=15,6===t)break e;case 15:r.mode=16;case 16:if(d=r.length){if(o<d&&(d=o),u<d&&(d=u),0===d)break e;I.arraySet(i,n,a,d,s),o-=d,a+=d,u-=d,s+=d,r.length-=d;break}r.mode=12;break;case 17:for(;l<14;){if(0===o)break e;o--,h+=n[a++]<<l,l+=8}if(r.nlen=257+(31&h),h>>>=5,l-=5,r.ndist=1+(31&h),h>>>=5,l-=5,r.ncode=4+(15&h),h>>>=4,l-=4,286<r.nlen||30<r.ndist){e.msg="too many length or distance symbols",r.mode=30;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;l<3;){if(0===o)break e;o--,h+=n[a++]<<l,l+=8}r.lens[A[r.have++]]=7&h,h>>>=3,l-=3}for(;r.have<19;)r.lens[A[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,S={bits:r.lenbits},x=T(0,r.lens,0,19,r.lencode,0,r.work,S),r.lenbits=S.bits,x){e.msg="invalid code lengths set",r.mode=30;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;g=(C=r.lencode[h&(1<<r.lenbits)-1])>>>16&255,b=65535&C,!((_=C>>>24)<=l);){if(0===o)break e;o--,h+=n[a++]<<l,l+=8}if(b<16)h>>>=_,l-=_,r.lens[r.have++]=b;else{if(16===b){for(z=_+2;l<z;){if(0===o)break e;o--,h+=n[a++]<<l,l+=8}if(h>>>=_,l-=_,0===r.have){e.msg="invalid bit length repeat",r.mode=30;break}k=r.lens[r.have-1],d=3+(3&h),h>>>=2,l-=2}else if(17===b){for(z=_+3;l<z;){if(0===o)break e;o--,h+=n[a++]<<l,l+=8}l-=_,k=0,d=3+(7&(h>>>=_)),h>>>=3,l-=3}else{for(z=_+7;l<z;){if(0===o)break e;o--,h+=n[a++]<<l,l+=8}l-=_,k=0,d=11+(127&(h>>>=_)),h>>>=7,l-=7}if(r.have+d>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=30;break}for(;d--;)r.lens[r.have++]=k}}if(30===r.mode)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=30;break}if(r.lenbits=9,S={bits:r.lenbits},x=T(D,r.lens,0,r.nlen,r.lencode,0,r.work,S),r.lenbits=S.bits,x){e.msg="invalid literal/lengths set",r.mode=30;break}if(r.distbits=6,r.distcode=r.distdyn,S={bits:r.distbits},x=T(F,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,S),r.distbits=S.bits,x){e.msg="invalid distances set",r.mode=30;break}if(r.mode=20,6===t)break e;case 20:r.mode=21;case 21:if(6<=o&&258<=u){e.next_out=s,e.avail_out=u,e.next_in=a,e.avail_in=o,r.hold=h,r.bits=l,R(e,c),s=e.next_out,i=e.output,u=e.avail_out,a=e.next_in,n=e.input,o=e.avail_in,h=r.hold,l=r.bits,12===r.mode&&(r.back=-1);break}for(r.back=0;g=(C=r.lencode[h&(1<<r.lenbits)-1])>>>16&255,b=65535&C,!((_=C>>>24)<=l);){if(0===o)break e;o--,h+=n[a++]<<l,l+=8}if(g&&0==(240&g)){for(v=_,y=g,w=b;g=(C=r.lencode[w+((h&(1<<v+y)-1)>>v)])>>>16&255,b=65535&C,!(v+(_=C>>>24)<=l);){if(0===o)break e;o--,h+=n[a++]<<l,l+=8}h>>>=v,l-=v,r.back+=v}if(h>>>=_,l-=_,r.back+=_,r.length=b,0===g){r.mode=26;break}if(32&g){r.back=-1,r.mode=12;break}if(64&g){e.msg="invalid literal/length code",r.mode=30;break}r.extra=15&g,r.mode=22;case 22:if(r.extra){for(z=r.extra;l<z;){if(0===o)break e;o--,h+=n[a++]<<l,l+=8}r.length+=h&(1<<r.extra)-1,h>>>=r.extra,l-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;g=(C=r.distcode[h&(1<<r.distbits)-1])>>>16&255,b=65535&C,!((_=C>>>24)<=l);){if(0===o)break e;o--,h+=n[a++]<<l,l+=8}if(0==(240&g)){for(v=_,y=g,w=b;g=(C=r.distcode[w+((h&(1<<v+y)-1)>>v)])>>>16&255,b=65535&C,!(v+(_=C>>>24)<=l);){if(0===o)break e;o--,h+=n[a++]<<l,l+=8}h>>>=v,l-=v,r.back+=v}if(h>>>=_,l-=_,r.back+=_,64&g){e.msg="invalid distance code",r.mode=30;break}r.offset=b,r.extra=15&g,r.mode=24;case 24:if(r.extra){for(z=r.extra;l<z;){if(0===o)break e;o--,h+=n[a++]<<l,l+=8}r.offset+=h&(1<<r.extra)-1,h>>>=r.extra,l-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=30;break}r.mode=25;case 25:if(0===u)break e;if(d=c-u,r.offset>d){if((d=r.offset-d)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=30;break}d>r.wnext?(d-=r.wnext,p=r.wsize-d):p=r.wnext-d,d>r.length&&(d=r.length),m=r.window}else m=i,p=s-r.offset,d=r.length;for(u<d&&(d=u),u-=d,r.length-=d;i[s++]=m[p++],--d;);0===r.length&&(r.mode=21);break;case 26:if(0===u)break e;i[s++]=r.length,u--,r.mode=21;break;case 27:if(r.wrap){for(;l<32;){if(0===o)break e;o--,h|=n[a++]<<l,l+=8}if(c-=u,e.total_out+=c,r.total+=c,c&&(e.adler=r.check=r.flags?B(r.check,i,c,s-c):O(r.check,i,c,s-c)),c=u,(r.flags?h:j(h))!==r.check){e.msg="incorrect data check",r.mode=30;break}l=h=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;l<32;){if(0===o)break e;o--,h+=n[a++]<<l,l+=8}if(h!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=30;break}l=h=0}r.mode=29;case 29:x=1;break e;case 30:x=-3;break e;case 31:return-4;case 32:default:return P}return e.next_out=s,e.avail_out=u,e.next_in=a,e.avail_in=o,r.hold=h,r.bits=l,(r.wsize||c!==e.avail_out&&r.mode<30&&(r.mode<27||4!==t))&&Z(e,e.output,e.next_out,c-e.avail_out)?(r.mode=31,-4):(f-=e.avail_in,c-=e.avail_out,e.total_in+=f,e.total_out+=c,r.total+=c,r.wrap&&c&&(e.adler=r.check=r.flags?B(r.check,i,c,e.next_out-c):O(r.check,i,c,e.next_out-c)),e.data_type=r.bits+(r.last?64:0)+(12===r.mode?128:0)+(20===r.mode||15===r.mode?256:0),(0===f&&0===c||4===t)&&x===N&&(x=-5),x)},r.inflateEnd=function(e){if(!e||!e.state)return P;var t=e.state;return t.window&&(t.window=null),e.state=null,N},r.inflateGetHeader=function(e,t){var r;return e&&e.state?0==(2&(r=e.state).wrap)?P:((r.head=t).done=!1,N):P},r.inflateSetDictionary=function(e,t){var r,n=t.length;return e&&e.state?0!==(r=e.state).wrap&&11!==r.mode?P:11===r.mode&&O(1,t,n,0)!==r.check?-3:Z(e,t,n,n)?(r.mode=31,-4):(r.havedict=1,N):P},r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":62,"./adler32":64,"./crc32":66,"./inffast":69,"./inftrees":71}],71:[function(e,t,r){var D=e("../utils/common"),F=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],N=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],P=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],U=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,r,n,i,a,s,o){var u,h,l,f,c,d,p,m,_,g=o.bits,b=0,v=0,y=0,w=0,k=0,x=0,S=0,z=0,C=0,E=0,A=null,I=0,O=new D.Buf16(16),B=new D.Buf16(16),R=null,T=0;for(b=0;b<=15;b++)O[b]=0;for(v=0;v<n;v++)O[t[r+v]]++;for(k=g,w=15;1<=w&&0===O[w];w--);if(w<k&&(k=w),0===w)return i[a++]=20971520,i[a++]=20971520,o.bits=1,0;for(y=1;y<w&&0===O[y];y++);for(k<y&&(k=y),b=z=1;b<=15;b++)if(z<<=1,(z-=O[b])<0)return-1;if(0<z&&(0===e||1!==w))return-1;for(B[1]=0,b=1;b<15;b++)B[b+1]=B[b]+O[b];for(v=0;v<n;v++)0!==t[r+v]&&(s[B[t[r+v]]++]=v);if(0===e?(A=R=s,d=19):1===e?(A=F,I-=257,R=N,T-=257,d=256):(A=P,R=U,d=-1),b=y,c=a,S=v=E=0,l=-1,f=(C=1<<(x=k))-1,1===e&&852<C||2===e&&592<C)return 1;for(;;){for(p=b-S,s[v]<d?(m=0,_=s[v]):s[v]>d?(m=R[T+s[v]],_=A[I+s[v]]):(m=96,_=0),u=1<<b-S,y=h=1<<x;i[c+(E>>S)+(h-=u)]=p<<24|m<<16|_|0,0!==h;);for(u=1<<b-1;E&u;)u>>=1;if(0!==u?(E&=u-1,E+=u):E=0,v++,0==--O[b]){if(b===w)break;b=t[r+s[v]]}if(k<b&&(E&f)!==l){for(0===S&&(S=k),c+=y,z=1<<(x=b-S);x+S<w&&!((z-=O[x+S])<=0);)x++,z<<=1;if(C+=1<<x,1===e&&852<C||2===e&&592<C)return 1;i[l=E&f]=k<<24|x<<16|c-a|0}}return 0!==E&&(i[c+E]=b-S<<24|64<<16|0),o.bits=k,0}},{"../utils/common":62}],72:[function(e,t,r){t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],73:[function(e,t,r){var u=e("../utils/common"),o=0,h=1;function n(e){for(var t=e.length;0<=--t;)e[t]=0}var l=0,s=29,f=256,c=f+1+s,d=30,p=19,_=2*c+1,g=15,i=16,m=7,b=256,v=16,y=17,w=18,k=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],x=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],S=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],C=new Array(2*(c+2));n(C);var E=new Array(2*d);n(E);var A=new Array(512);n(A);var I=new Array(256);n(I);var O=new Array(s);n(O);var B,R,T,D=new Array(d);function F(e,t,r,n,i){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=e&&e.length}function a(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function N(e){return e<256?A[e]:A[256+(e>>>7)]}function P(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function U(e,t,r){e.bi_valid>i-r?(e.bi_buf|=t<<e.bi_valid&65535,P(e,e.bi_buf),e.bi_buf=t>>i-e.bi_valid,e.bi_valid+=r-i):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)}function j(e,t,r){U(e,r[2*t],r[2*t+1])}function L(e,t){for(var r=0;r|=1&e,e>>>=1,r<<=1,0<--t;);return r>>>1}function Z(e,t,r){var n,i,a=new Array(g+1),s=0;for(n=1;n<=g;n++)a[n]=s=s+r[n-1]<<1;for(i=0;i<=t;i++){var o=e[2*i+1];0!==o&&(e[2*i]=L(a[o]++,o))}}function W(e){var t;for(t=0;t<c;t++)e.dyn_ltree[2*t]=0;for(t=0;t<d;t++)e.dyn_dtree[2*t]=0;for(t=0;t<p;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*b]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function M(e){8<e.bi_valid?P(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function H(e,t,r,n){var i=2*t,a=2*r;return e[i]<e[a]||e[i]===e[a]&&n[t]<=n[r]}function G(e,t,r){for(var n=e.heap[r],i=r<<1;i<=e.heap_len&&(i<e.heap_len&&H(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!H(t,n,e.heap[i],e.depth));)e.heap[r]=e.heap[i],r=i,i<<=1;e.heap[r]=n}function K(e,t,r){var n,i,a,s,o=0;if(0!==e.last_lit)for(;n=e.pending_buf[e.d_buf+2*o]<<8|e.pending_buf[e.d_buf+2*o+1],i=e.pending_buf[e.l_buf+o],o++,0===n?j(e,i,t):(j(e,(a=I[i])+f+1,t),0!==(s=k[a])&&U(e,i-=O[a],s),j(e,a=N(--n),r),0!==(s=x[a])&&U(e,n-=D[a],s)),o<e.last_lit;);j(e,b,t)}function Y(e,t){var r,n,i,a=t.dyn_tree,s=t.stat_desc.static_tree,o=t.stat_desc.has_stree,u=t.stat_desc.elems,h=-1;for(e.heap_len=0,e.heap_max=_,r=0;r<u;r++)0!==a[2*r]?(e.heap[++e.heap_len]=h=r,e.depth[r]=0):a[2*r+1]=0;for(;e.heap_len<2;)a[2*(i=e.heap[++e.heap_len]=h<2?++h:0)]=1,e.depth[i]=0,e.opt_len--,o&&(e.static_len-=s[2*i+1]);for(t.max_code=h,r=e.heap_len>>1;1<=r;r--)G(e,a,r);for(i=u;r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],G(e,a,1),n=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=n,a[2*i]=a[2*r]+a[2*n],e.depth[i]=(e.depth[r]>=e.depth[n]?e.depth[r]:e.depth[n])+1,a[2*r+1]=a[2*n+1]=i,e.heap[1]=i++,G(e,a,1),2<=e.heap_len;);e.heap[--e.heap_max]=e.heap[1],function(e,t){var r,n,i,a,s,o,u=t.dyn_tree,h=t.max_code,l=t.stat_desc.static_tree,f=t.stat_desc.has_stree,c=t.stat_desc.extra_bits,d=t.stat_desc.extra_base,p=t.stat_desc.max_length,m=0;for(a=0;a<=g;a++)e.bl_count[a]=0;for(u[2*e.heap[e.heap_max]+1]=0,r=e.heap_max+1;r<_;r++)p<(a=u[2*u[2*(n=e.heap[r])+1]+1]+1)&&(a=p,m++),u[2*n+1]=a,h<n||(e.bl_count[a]++,s=0,d<=n&&(s=c[n-d]),o=u[2*n],e.opt_len+=o*(a+s),f&&(e.static_len+=o*(l[2*n+1]+s)));if(0!==m){do{for(a=p-1;0===e.bl_count[a];)a--;e.bl_count[a]--,e.bl_count[a+1]+=2,e.bl_count[p]--,m-=2}while(0<m);for(a=p;0!==a;a--)for(n=e.bl_count[a];0!==n;)h<(i=e.heap[--r])||(u[2*i+1]!==a&&(e.opt_len+=(a-u[2*i+1])*u[2*i],u[2*i+1]=a),n--)}}(e,t),Z(a,h,e.bl_count)}function X(e,t,r){var n,i,a=-1,s=t[1],o=0,u=7,h=4;for(0===s&&(u=138,h=3),t[2*(r+1)+1]=65535,n=0;n<=r;n++)i=s,s=t[2*(n+1)+1],++o<u&&i===s||(o<h?e.bl_tree[2*i]+=o:0!==i?(i!==a&&e.bl_tree[2*i]++,e.bl_tree[2*v]++):o<=10?e.bl_tree[2*y]++:e.bl_tree[2*w]++,a=i,(o=0)===s?(u=138,h=3):i===s?(u=6,h=3):(u=7,h=4))}function V(e,t,r){var n,i,a=-1,s=t[1],o=0,u=7,h=4;for(0===s&&(u=138,h=3),n=0;n<=r;n++)if(i=s,s=t[2*(n+1)+1],!(++o<u&&i===s)){if(o<h)for(;j(e,i,e.bl_tree),0!=--o;);else 0!==i?(i!==a&&(j(e,i,e.bl_tree),o--),j(e,v,e.bl_tree),U(e,o-3,2)):o<=10?(j(e,y,e.bl_tree),U(e,o-3,3)):(j(e,w,e.bl_tree),U(e,o-11,7));a=i,(o=0)===s?(u=138,h=3):i===s?(u=6,h=3):(u=7,h=4)}}n(D);var q=!1;function J(e,t,r,n){var i,a,s,o;U(e,(l<<1)+(n?1:0),3),a=t,s=r,o=!0,M(i=e),o&&(P(i,s),P(i,~s)),u.arraySet(i.pending_buf,i.window,a,s,i.pending),i.pending+=s}r._tr_init=function(e){q||(function(){var e,t,r,n,i,a=new Array(g+1);for(n=r=0;n<s-1;n++)for(O[n]=r,e=0;e<1<<k[n];e++)I[r++]=n;for(I[r-1]=n,n=i=0;n<16;n++)for(D[n]=i,e=0;e<1<<x[n];e++)A[i++]=n;for(i>>=7;n<d;n++)for(D[n]=i<<7,e=0;e<1<<x[n]-7;e++)A[256+i++]=n;for(t=0;t<=g;t++)a[t]=0;for(e=0;e<=143;)C[2*e+1]=8,e++,a[8]++;for(;e<=255;)C[2*e+1]=9,e++,a[9]++;for(;e<=279;)C[2*e+1]=7,e++,a[7]++;for(;e<=287;)C[2*e+1]=8,e++,a[8]++;for(Z(C,c+1,a),e=0;e<d;e++)E[2*e+1]=5,E[2*e]=L(e,5);B=new F(C,k,f+1,c,g),R=new F(E,x,0,d,g),T=new F(new Array(0),S,0,p,m)}(),q=!0),e.l_desc=new a(e.dyn_ltree,B),e.d_desc=new a(e.dyn_dtree,R),e.bl_desc=new a(e.bl_tree,T),e.bi_buf=0,e.bi_valid=0,W(e)},r._tr_stored_block=J,r._tr_flush_block=function(e,t,r,n){var i,a,s=0;0<e.level?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return o;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return h;for(t=32;t<f;t++)if(0!==e.dyn_ltree[2*t])return h;return o}(e)),Y(e,e.l_desc),Y(e,e.d_desc),s=function(e){var t;for(X(e,e.dyn_ltree,e.l_desc.max_code),X(e,e.dyn_dtree,e.d_desc.max_code),Y(e,e.bl_desc),t=p-1;3<=t&&0===e.bl_tree[2*z[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),i=e.opt_len+3+7>>>3,(a=e.static_len+3+7>>>3)<=i&&(i=a)):i=a=r+5,r+4<=i&&-1!==t?J(e,t,r,n):4===e.strategy||a===i?(U(e,2+(n?1:0),3),K(e,C,E)):(U(e,4+(n?1:0),3),function(e,t,r,n){var i;for(U(e,t-257,5),U(e,r-1,5),U(e,n-4,4),i=0;i<n;i++)U(e,e.bl_tree[2*z[i]+1],3);V(e,e.dyn_ltree,t-1),V(e,e.dyn_dtree,r-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),K(e,e.dyn_ltree,e.dyn_dtree)),W(e),n&&M(e)},r._tr_tally=function(e,t,r){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&r,e.last_lit++,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(I[r]+f+1)]++,e.dyn_dtree[2*N(t)]++),e.last_lit===e.lit_bufsize-1},r._tr_align=function(e){var t;U(e,2,3),j(e,b,C),16===(t=e).bi_valid?(P(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):8<=t.bi_valid&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}},{"../utils/common":62}],74:[function(e,t,r){t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}]},{},[10])(10)});
"";var channelpresence=!1,localVideoStreaming=null,turn="none",localobj={},remoteobj={},WebRTCdev=function(e,t,n,o,r,i){return sessionid=r.sessionid,socketAddr=r.socketAddr,localobj=e,remoteobj=t,webrtcdev.log("WebRTCdev --\x3e Session ",r),turn=r.hasOwnProperty("turn")?r.turn:null,webrtcdev.log("WebRTCdev --\x3e TURN ",turn),null!=turn&&"none"!=turn?getICEServer(turn.username,turn.secretkey,turn.domain,turn.application,turn.room,turn.secure):webrtcdev.log("WebRTCdev --\x3e TURN not applied "),i&&(webrtcdev.log(" WebRTCdev --\x3e widgets  ",i),i.debug&&(debug=i.debug||!1),i.chat&&(chatobj=i.chat||null),i.fileShare&&(fileshareobj=i.fileShare||null),i.screenrecord&&(screenrecordobj=i.screenrecord||null),i.screenshare&&(screenshareobj=i.screenshare||null),i.snapshot&&(snapshotobj=i.snapshot||null),i.videoRecord&&(videoRecordobj=i.videoRecord||null),i.reconnect&&(reconnectobj=i.reconnect||null),i.drawCanvas&&(drawCanvasobj=i.drawCanvas||null),i.texteditor&&(texteditorobj=i.texteditor||null),i.codeeditor&&(codeeditorobj=i.codeeditor||null),i.mute&&(muteobj=i.mute||null),i.timer&&(timerobj=i.timer||null),i.listenin&&(listeninobj=i.listenin||null),i.cursor&&(cursorobj=i.cursor||null),i.minmax&&(minmaxobj=i.minmax||null),i.help&&(helpobj=i.help||null),i.statistics&&(statisticsobj=i.statistics||null)),{sessionid:sessionid,socketAddr:socketAddr,turn:turn,widgets:i,startwebrtcdev:funcStartWebrtcdev,rtcConn:rtcConn}};function funcStartWebrtcdev(){return webrtcdev.log(" startwebrtcdev "),new Promise(function(e,t){detectRTC=DetectRTC,webrtcdev.log(" [ startJS webrtcdom ] : DetectRTC ",detectRTC),detectRTC.hasWebcam||(shownotification(" Your browser doesnt have webcam","warning"),outgoing.video=!1),detectRTC.isWebsiteHasWebcamPermissions||(shownotification(" Your browser doesnt have permission for accessing webcam","warning"),outgoing.video=!1),detectRTC.hasMicrophone||(shownotification(" Your browser doesnt have microphone","warning"),outgoing.audio=!1),detectRTC.isWebsiteHasMicrophonePermissions||(shownotification(" Your browser doesnt have permission for accessing microphone","warning"),outgoing.audio=!1),detectRTC.hasSpeakers||shownotification(" Your browser doesnt have speakers","warning"),e("done")}).then(navigator.mediaDevices.getUserMedia({audio:!0,video:!0})).then(function(e){return webrtcdev.log(" [ startJS webrtcdom ] : incoming ",incoming),webrtcdev.log(" [ startJS webrtcdom ] : outgoing ",outgoing),new Promise(function(e,t){incoming&&(incomingAudio=incoming.audio,incomingVideo=incoming.video,incomingData=incoming.data),outgoing&&(outgoingAudio=outgoing.audio,outgoingVideo=outgoing.video,outgoingData=outgoing.data),e("done")})}).then(function(e){return webrtcdev.log(" [ startJS webrtcdom ] : localobj ",localobj),webrtcdev.log(" [ startJS webrtcdom ] : remoteobj ",remoteobj),new Promise(function(e,t){localVideo=localobj.video;var n=remoteobj.videoarr;if(outgoingVideo&&(selfVideo=n[0]),!remoteobj.dynamicVideos)for(var o=1;o<n.length;o++)remoteVideos.push(n[o]);e("done")})}).then(function(e){return new Promise(function(e,t){if(localobj.hasOwnProperty("userdetails")){var n=localobj.userdetails;webrtcdev.info("localobj userdetails ",n),selfusername=n.username||"LOCAL",selfcolor=n.usercolor||"orange",selfemail=n.useremail||"unknown",role=n.role||"participant"}else webrtcdev.warning("localobj has no userdetails ");if(remoteobj.hasOwnProperty("userdetails")){var o=remoteobj.userdetails;webrtcdev.info("remoteobj userdetails ",o),remoteusername=o.username||"REMOTE",remotecolor=o.usercolor||"orange",remoteemail=o.useremail||"unknown"}else webrtcdev.warning("remoteobj has no userdetails ");e("done")})}).then(setRtcConn(sessionid)).then(setWidgets(rtcConn)).then(startSocketSession(rtcConn,socketAddr,sessionid)).catch(function(e){webrtcdev.error(" Promise rejected ",e)})}function startSocketSession(o,e,t){webrtcdev.log("StartSession"+t);try{var n="/";"/"!=e&&(n=e),socket=io.connect(n,{transports:["websocket"]})}catch(e){webrtcdev.error(" problem in socket connnection",e),alert(" problem in socket connnection")}if(!t)return webrtcdev.error(" Session id undefined "),void alert("rtcCon channel / session id undefined ");shownotification(" Checking status of  : "+t),socket.emit("presence",{channel:t}),socket.on("connect",function(){socket.on("disconnected",function(){shownotification("Disconnected from signaller ")})}),socket.on("presence",function(e){webrtcdev.log("presence for sessionid ",e),(channelpresence=e)?joinWebRTC(t,selfuserid):openWebRTC(t,selfuserid)}),socket.on("open-channel-resp",function(e){(webrtcdev.log(" opened-channel",e,e.status,e.channel==t),e.status&&e.channel==t)?new Promise(function(e,t){webrtcdev.log(" [open-channel-resp ] "," Session video:",outgoingVideo," audio: ",outgoingAudio," data: ",outgoingData," OfferToReceiveAudio: ",incomingAudio," OfferToReceiveVideo: ",incomingVideo),o.connectionType="open",o.session={video:outgoingVideo,audio:outgoingAudio,data:outgoingData},o.sdpConstraints.mandatory={OfferToReceiveAudio:incomingAudio,OfferToReceiveVideo:incomingVideo},e()}).then(o.open(e.channel,function(){null==selfuserid&&(selfuserid=o.userid,tempuserid!=selfuserid&&socket.emit("update-channel",{type:"change-userid",channel:o.channel,sender:selfuserid,extra:{old:tempuserid,new:selfuserid}}))})).then(function(e){updatePeerInfo(selfuserid,selfusername,selfcolor,selfemail,"role","local"),webrtcdev.info(" Trying to open a channel on WebRTC SDP ")}).then(getCamMedia()).catch(function(e){webrtcdev.error("Handle rejected promise ("+e+")")}):alert(" signaller doesnt allow channel open");shownotification(e.msgtype+" : "+e.message)}),socket.on("join-channel-resp",function(n){(webrtcdev.log("joined-channel",n),n.status&&n.channel==t)?new Promise(function(e,t){webrtcdev.log(" [ join-channel-resp ] "," Session video:",outgoingVideo," audio: ",outgoingAudio," data: ",outgoingData," OfferToReceiveAudio: ",incomingAudio," OfferToReceiveVideo: ",incomingVideo),o.connectionType="join",o.session={video:outgoingVideo,audio:outgoingAudio,data:outgoingData},o.sdpConstraints.mandatory={OfferToReceiveAudio:incomingAudio,OfferToReceiveVideo:incomingVideo},o.remoteUsers=n.users,e()}).then(o.connectionDescription=o.join(n.channel)).then(updatePeerInfo(o.userid,selfusername,selfcolor,selfemail,role,"local"),webrtcdev.info(" Trying to join a channel on WebRTC SDP ")).then(function(e){for(x in o.remoteUsers)updatePeerInfo(o.remoteUsers[x],remoteusername,remotecolor,remoteemail,"participant","remote"),"inspector"==role&&shownotificationWarning("This session is being inspected ")}).then(getCamMedia()).catch(function(e){webrtcdev.error("Handle rejected promise ("+e+")")}):alert(" signaller doesnt allow channel Join");shownotification(n.msgtype+" : "+n.message)}),socket.on("channel-event",function(e){(webrtcdev.log("channel-event",e),"new-join"==e.type)&&(e.status?findPeerInfo(e.data.sender)||("LOCAL"==e.data.extra.name&&(e.data.extra.name="REMOTE",e.data.extra.color=remotecolor),updatePeerInfo(e.data.sender,e.data.extra.name,e.data.extra.color,e.data.extra.email,e.data.extra.role,"remote"),shownotification(e.data.extra.role+"  "+e.type)):shownotification(e.msgtype+" : "+e.message))})}var setRtcConn=function(n){return new Promise(function(e,t){webrtcdev.log("initiating RTcConn"),rtcConn=new RTCMultiConnection,rtcConn.onNewParticipant=function(e,t){webrtcdev.log("onNewParticipant",e,t),shownotification(remoteusername+" requests new participantion "),webcallpeers.length<=remoteobj.maxAllowed?updatePeerInfo(e,remoteusername,remotecolor,"","role","remote"):shownotification("Another user is trying to join this channel but max count [ "+remoteobj.maxAllowed+" ] is reached","warning"),rtcConn.acceptParticipationRequest(e,t)},rtcConn.onopen=function(e){webrtcdev.log("rtcconn onopen "+rtcConn.connectionType);try{"open"==rtcConn.connectionType?connectWebRTC("open",n,selfuserid,[]):"join"==rtcConn.connectionType?connectWebRTC("join",n,selfuserid,rtcConn.remoteUsers):shownotification("connnection type is neither open nor join","warning"),timerobj&&timerobj.active&&(startsessionTimer(timerobj),shareTimePeer()),shownotification(e.extra.name+" joined session ","info"),showdesktopnotification(),onSessionConnect(),statisticsobj&&statisticsobj.active&&rtpstats()}catch(e){shownotification("problem in on session open "+e.message,"warning"),webrtcdev.error("problem in on session open",e)}},rtcConn.onMediaError=function(e,t){webrtcdev.error("[startJS onMediaError] ",e,t),shownotification(e.name+" Joining without camera Stream ","warning"),localVideoStreaming=!1;var n=webcallpeers[0];n.type="Local",n.stream=null,n.streamid="nothing01",updateWebCallView(n),onLocalConnect()},rtcConn.onstream=function(e){webrtcdev.log("[startJs on stream ] on stream Started event ",e),"local"==e.type&&(localVideoStreaming=!0);var t=findPeerInfo(e.userid);t?(t.type=e.type,t.stream=e.stream,t.streamid=e.stream.streamid,updateWebCallView(t)):(console.error(" PeerInfo not present in webcallpeers ",e.userid,rtcConn),alert(" Cannot create session for Peer")),onLocalConnect()},rtcConn.onstreamended=function(e){webrtcdev.log(" On streamEnded event ",e);var t=document.getElementById(e.streamid);t&&t.parentNode.removeChild(t)},rtcConn.chunkSize=5e4,rtcConn.onmessage=function(e){if(webrtcdev.log(" on message ",e),e.data.typing)updateWhotyping(e.extra.name+" is typing ...");else if(e.data.stoppedTyping)updateWhotyping("");else switch(e.data.type){case"screenshare":if("stoppedscreenshare"==e.data.message)shownotification("Screenshare has stopped : "+e.data.screenStreamid),(t=document.getElementById(screenshareobj.button.shareButton.id)).className=screenshareobj.button.shareButton.class_off,t.innerHTML=screenshareobj.button.shareButton.html_off,t.disabled=!1,scrConn.onstreamended(),scrConn.removeStream(e.data.screenStreamid),scrConn.close();else if("screenshareStartedViewing"==e.data.message)screenshareNotification("","screenshareStartedViewing");else{var t;shownotification("screen is getting shared "+e.data.screenid),(t=document.getElementById(screenshareobj.button.shareButton.id)).className=screenshareobj.button.shareButton.class_busy,t.innerHTML=screenshareobj.button.shareButton.html_busy,t.disabled=!0,screenRoomid=e.data.screenid;var n="temp_"+(new Date).getUTCMilliseconds();webrtcdevPrepareScreenShare(function(e){connectScrWebRTC("join",e,n,[])})}break;case"chat":updateWhotyping(e.extra.name+" has send message"),addNewMessage({header:e.extra.name,message:e.data.message,userinfo:e.data.userinfo,color:e.extra.color});break;case"imagesnapshot":var o=findPeerInfo(e.userid);displayList(null,o,e.data.message,e.data.name,"imagesnapshot"),displayFile(null,o,e.data.message,e.data.name,"imagesnapshot");break;case"videoRecording":o=findPeerInfo(e.userid);displayList(null,o,e.data.message,e.data.name,"videoRecording"),displayFile(null,o,e.data.message,e.data.name,"videoRecording");break;case"videoScreenRecording":o=findPeerInfo(e.userid);displayList(null,o,e.data.message,e.data.name,"videoScreenRecording"),displayFile(null,o,e.data.message,e.data.name,"videoScreenRecording");break;case"file":addNewMessage({header:e.extra.name,message:e.data.message,userinfo:getUserinfo(rtcConn.blobURLs[e.userid],"chat-message.png"),color:e.extra.color});break;case"canvas":e.data.draw?CanvasDesigner.syncData(e.data.draw):e.data.board?(webrtcdev.log(" Canvas : ",e.data),"remote"==e.data.board.from&&("open"==e.data.board.event&&1!=isDrawOpened?syncDrawBoard(e.data.board):"close"==e.data.board.event&&1==isDrawOpened&&syncDrawBoard(e.data.board))):webrtcdev.warn(" Board data mismatch",e.data);break;case"texteditor":receiveWebrtcdevTexteditorSync(e.data.data);break;case"codeeditor":receiveWebrtcdevCodeeditorSync(e.data.data);break;case"pointer":var r=document.getElementById("cursor2");r?"startCursor"==e.data.action?(r.setAttribute("style","display:block"),placeCursor(r,e.data.corX,e.data.corY)):"stopCursor"==e.data.action&&r.setAttribute("style","display:none"):alert(" Cursor for remote is not present ");break;case"timer":startPeersTime(e.data.time,e.data.zone);break;case"buttonclick":var i=document.getElementById(e.data.buttonName);i.getAttribute("lastClickedBy")!=rtcConn.userid&&(i.setAttribute("lastClickedBy",e.userid),i.click());break;case"syncOldFiles":sendOldFiles();break;default:webrtcdev.warn(" unrecognizable message from peer  ",e)}},rtcConn.sendMessage=function(e){webrtcdev.log(" sendMessage ",e),e.userid=rtcConn.userid,e.extra=rtcConn.extra,rtcConn.sendCustomMessage(e)},rtcConn.onleave=function(e){var t=findPeerInfo(e.userid);webrtcdev.log(" RTCConn onleave user",e," his peerinfo ",t," rom webcallpeers ",webcallpeers),"undefined"!=e.extra.name&&shownotification(e.extra.name+"  left the conversation.")},rtcConn.onclose=function(e){webrtcdev.log(" RTCConn on close conversation ",e)},rtcConn.onEntireSessionClosed=function(e){rtcConn.attachStreams.forEach(function(e){e.stop()}),alert(" Entire Session Disconneted ")},rtcConn.onFileStart=function(e){webrtcdev.log("[start] on File start "+e.name),webrtcdev.log("file description ",e);var t=findPeerInfo(e.userid);t&&"inspector"==t.role||addProgressHelper(e.uuid,t,e.name,e.maxChunks,"fileBoxClass")},rtcConn.onFileProgress=function(e){webrtcdev.log("[start] on File progress ",e);try{var t=progressHelper[e.uuid];t&&(t.progress.value=e.currentPosition||e.maxChunks||t.progress.max,updateLabel(t.progress,t.label))}catch(e){webrtcdev.error(" Prolem in progressHelper ",e)}},rtcConn.onFileEnd=function(e){var t=e.name;for(x in webrtcdev.log("[start] On file End "+t),webcallpeers)for(y in webcallpeers[x].filearray)if(webrtcdev.log(" Duplicate find , Files shared  so far ",webcallpeers[x].filearray[y].name),webcallpeers[x].filearray[y].name==t)return void webrtcdev.error("duplicate file shared ");var n=findPeerInfo(e.userid);null!=n&&n.filearray.push(e),displayFile(e.uuid,n,e.url,t,e.type),displayList(e.uuid,n,e.url,t,e.type)},rtcConn.takeSnapshot=function(e,t){takeSnapshot({userid:e,connection:connection,callback:t})},rtcConn.connectionType=null,rtcConn.remoteUsers=[],rtcConn.extra={uuid:tempuserid,name:selfusername||"",color:selfcolor||"",email:selfemail||""},rtcConn.channel=this.sessionid,rtcConn.socketURL="/",rtcConn.socketMessageEvent="RTCMultiConnection-Message",rtcConn.socketCustomEvent="RTCMultiConnection-Custom-Message",rtcConn.enableFileSharing=!0,rtcConn.filesContainer=document.body||document.documentElement,rtcConn.dontCaptureUserMedia=!0,tempuserid=rtcConn.userid,webrtcdev.log(" RTCConn : ",rtcConn),rtcConn?e(rtcConn):t("failed")})};function getCamMedia(){return new Promise(function(e,t){"inspector"!=role&&outgoingVideo?(webrtcdev.log("getCamMedia - Capture Media "),rtcConn.dontCaptureUserMedia=!1,rtcConn.getUserMedia()):(webrtcdev.error(" getCamMedia - dont Capture outgoing video ",outgoingVideo),onNoCameraCard()),e("success")}).catch(function(e){webrtcdev.error("getCamMedia rejected promise ("+e+")")})}var setWidgets=function(n){return new Promise(function(e,t){if(chatobj.active?(chatobj.inputBox&&chatobj.inputBox.text_id&&document.getElementById(chatobj.inputBox.text_id)?(webrtcdev.log("Assign chat Box "),assignChatBox(chatobj)):(webrtcdev.log("Create chat Box "),createChatBox(chatobj)),webrtcdev.log("chat widget loaded ")):webrtcdev.log(" chat widget not loaded "),screenrecordobj&&screenrecordobj.active?(detectExtension(screenshareobj.extensionID,function(e){extensioninstalled=e,webrtcdev.log("is screenshareobj extension installed  ? ",e),"not-installed"==e?(shownotification(" Sessions recoridng cannot start as there is not extension installed ","warning"),createExtensionInstallWindow()):"installed-enabled"==e?screenrecordobj.button.id&&document.getElementById(screenrecordobj.button.id)?(webrtcdev.log("Assign Record Button "),assignScreenRecordButton(screenrecordobj)):(webrtcdev.log("Create Record Button "),createScreenRecordButton(screenrecordobj)):"installed-disabled"==extensioninstalled?(shownotification("chrome extension is installed but disabled.","warning"),screenrecordobj.button.id&&document.getElementById(screenrecordobj.button.id)?(assignScreenRecordButton(screenrecordobj),webrtcdev.log("Assign Record Button ")):(webrtcdev.log("Create Record Button "),createScreenRecordButton(screenrecordobj))):"not-chrome"==extensioninstalled||webrtcdev.error(" screen record extension's state is undefined ")}),webrtcdev.log(" screen record widget loaded ")):screenrecordobj&&!screenrecordobj.active&&(screenrecordobj.button.id&&document.getElementById(screenrecordobj.button.id)&&(document.getElementById(screenrecordobj.button.id).className="inactiveButton"),webrtcdev.log(" screen record widget not loaded ")),screenshareobj.active?(detectExtension(screenshareobj.extensionID,function(e){if(webrtcdev.log("is screenshareobj extension installed  ? ",e),"installed-enabled"==e){createOrAssignScreenshareButton(screenshareobj);hideScreenInstallButton()}else if("installed-disabled"==e){shownotification("chrome extension is installed but disabled.");createOrAssignScreenshareButton(screenshareobj);hideScreenInstallButton()}else"not-installed"==e?($("#screensharedialog").modal("show"),hideScreenShareButton(),screenshareobj.button.installButton.id&&document.getElementById(screenshareobj.button.installButton.id)?assignScreenInstallButton(screenshareobj.extensionID):createScreenInstallButton(screenshareobj.extensionID)):"not-chrome"==e?alert(" Screen share extension only works in Chrome for now "):webrtcdev.error(" screen share extension's state is undefined ")}),webrtcdev.log(" screen share widget loaded ")):webrtcdev.log(" screen share widget not loaded "),reconnectobj&&reconnectobj.active?(reconnectobj.button.id&&document.getElementById(reconnectobj.button.id)?(webrtcdev.log("Rconnect Button Assigned"),assignButtonRedial(reconnectobj.button.id)):(webrtcdev.log("Rconnect Button created"),createButtonRedial(reconnectobj)),webrtcdev.log(" reconnect widget loacded ")):reconnectobj&&!reconnectobj.active&&(reconnectobj.button.id&&document.getElementById(reconnectobj.button.id)&&(document.getElementById(reconnectobj.button.id).className="inactiveButton"),webrtcdev.log(" reconnect widget not loaded ")),cursorobj.active&&(document.getElementById("cursor1").setAttribute("style","display:none"),document.getElementById("cursor2").setAttribute("style","display:none")),listeninobj&&listeninobj.active?(listeninobj.button.id&&document.getElementById(listeninobj.button.id),webrtcdev.log(" listen in widget loaded ")):listeninobj&&!listeninobj.active&&(listeninobj.button.id&&document.getElementById(listeninobj.button.id)&&(document.getElementById(listeninobj.button.id).className="inactiveButton"),webrtcdev.log(" listenein widget not loaded ")),timerobj&&timerobj.active?(timeZone(),activateBttons(timerobj),document.getElementById(timerobj.container.id).hidden=!0):timerobj&&!timerobj.active&&timerobj.button.id&&document.getElementById(timerobj.button.id)&&(document.getElementById(timerobj.button.id).className="inactiveButton"),drawCanvasobj&&drawCanvasobj.active?(drawCanvasobj.container&&drawCanvasobj.container.id&&document.getElementById(drawCanvasobj.container.id)&&(document.getElementById(drawCanvasobj.container.id).hidden=!0),drawCanvasobj.button.id&&document.getElementById(drawCanvasobj.button.id)?assigndrawButton(drawCanvasobj):createdrawButton(drawCanvasobj),CanvasDesigner=function(){var t,n={line:!0,pencil:!0,dragSingle:!0,dragMultiple:!0,eraser:!0,rectangle:!0,arc:!0,bezier:!0,quadratic:!0,text:!0},o="pencil";var r=function(e){webrtcdev.log("syncDataListener",e)};function e(){event.data&&event.data.canvasDesignerSyncData&&r(event.data.canvasDesignerSyncData)}var i=window.addEventListener?"addEventListener":"attachEvent";return(0,window[i])("attachEvent"==i?"onmessage":"message",function(e){webrtcdev.log("CanvasDesigner parent received message : ",e.data),e.data.modalpopup?saveButtonCanvas.click():e.data||e.data.canvasDesignerSyncData?r(e.data.canvasDesignerSyncData):e.data&&e.data.canvasDesignerSyncData||webrtcdev.log("parent received unexpected message")},!1),{appendTo:function(e){(t=document.createElement("iframe")).id="drawboard",t.src="widget.html?tools="+JSON.stringify(n)+"&selectedIcon="+o,t.style.width="100%",t.style.height="100%",t.style.border=0,e.appendChild(t)},destroy:function(){t&&t.parentNode.removeChild(t),window.removeEventListener("message",e)},addSyncListener:function(e){r=e},syncData:function(e){t&&t.contentWindow.postMessage({canvasDesignerSyncData:e},"*")},setTools:function(e){n=e},setSelected:function(e){void 0!==n[e]&&(o=e)}}}(),webrtcdev.log(" draw widget loaded ")):drawCanvasobj&&!drawCanvasobj.active&&(drawCanvasobj.button.id&&document.getElementById(drawCanvasobj.button.id)&&(document.getElementById(drawCanvasobj.button.id).className="inactiveButton"),webrtcdev.log(" draw widget not loaded ")),texteditorobj.active&&createTextEditorButton(),codeeditorobj.active&&createCodeEditorButton(),fileshareobj.active?(webrtcdev.log(" fileshareobj - rtcConn ",n),n.enableFileSharing=!0,n.filesContainer=document.getElementById(fileshareobj.fileShareContainer),fileshareobj.button.id&&document.getElementById(fileshareobj.button.id)?assignFileShareButton(fileshareobj):createFileShareButton(fileshareobj),webrtcdev.log(" File sharing widget loaded ")):webrtcdev.log(" File sharing widget not loaded "),statisticsobj&&statisticsobj.active)try{document.getElementById(statisticsobj.statsConainer).innerHTML=""}catch(e){webrtcdev.error(" statisticsobj statsConainer not found",e)}if(helpobj&&helpobj.active)try{document.getElementById(helpobj.helpContainer).innerHTML=""}catch(e){webrtcdev.error(" helpobj helpContainer not found",e)}e("success")})};function updateWebCallView(e){webrtcdev.log("updateWebCallView - start with peerInfo",e," || role is ",role," ||  indexOf ",e.vid.indexOf("videoundefined"));try{switch(role){case"inspector":for(var t,n=0,o=0;o<remoteVideos.length;o++)webrtcdev.log("Remote Video index array ",o," || ",remoteVideos[o],document.getElementsByName(remoteVideos[o]),document.getElementsByName(remoteVideos[o]).src),remoteVideos[o].src&&n++;var r=document.createElement("video");remoteVideos[n]=r,document.getElementById(remoteobj.videoContainer).appendChild(r),t=remoteVideos[n],webrtcdev.log(" [start.js - updateWebCallView] inspector role , attaching stream",t,e.stream),attachMediaStream(t,e.stream),t.hidden&&(removid.hidden=!1),t.id=e.videoContainer,t.className=remoteobj.videoClass,attachControlButtons(t,e),remoteobj.userDisplay&&e.name&&attachUserDetails(t,e),remoteobj.userMetaDisplay&&e.userid&&attachMetaUserDetails(t,e),document.getElementsByName(localVideo)[0].setAttribute("style","display:none"),document.getElementsByName(selfVideo)[0].setAttribute("style","display:none");break;case"user":case"participant":if(-1<e.vid.indexOf("videolocal"))if(webrtcdev.info(" updateWebCallView - PeerInfo Vid is Local"),localVideo&&document.getElementsByName(localVideo)[0]){var i=document.getElementsByName(localVideo)[0];i.muted=!0,i.className=localobj.videoClass,attachMediaStream(i,e.stream),localobj.userDisplay&&e.name&&attachUserDetails(i,e),localobj.userMetaDisplay&&e.userid&&attachMetaUserDetails(i,e),webrtcdev.info(" User is alone in the session  , hiding remote video container","showing users single video conrainer and attaching attachMediaStream and attachUserDetails ")}else alert(" Please Add a video container in config for single"),webrtcdev.error(" No local video conatainer in localobj -> ",localobj);else if(-1<e.vid.indexOf("videoremote")){if(webrtcdev.info(" updateWebCallView - PeerInfo Vid is Remote"),outgoingVideo&&localVideo&&selfVideo){var a=document.getElementsByName(localVideo)[0],s=document.getElementsByName(selfVideo)[0];0==s.played.length?(0<a.played.lebth?reattachMediaStream(s,a):attachMediaStream(s,webcallpeers[0].stream),s.id=webcallpeers[0].videoContainer,s.className=remoteobj.videoClass,s.muted=!0,attachControlButtons(s,webcallpeers[0]),localobj.userDisplay&&webcallpeers[0].name&&attachUserDetails(s,webcallpeers[0]),localobj.userMetaDisplay&&webcallpeers[0].userid&&attachMetaUserDetails(s,webcallpeers[0])):webrtcdev.log(" not uppdating self video as it is already playing "),webrtcdev.info(" User is joined by a remote peer , hiding local video container","showing users conf video container and attaching attachMediaStream and attachUserDetails ")}else outgoingVideo?(alert(" Please Add a video container in config for video call "),webrtcdev.error(" Local video container not defined ")):webrtcdev.error(" Outgoing Local video is ",outgoingVideo);if(remoteVideos){for(n=0,o=0;o<remoteVideos.length;o++)webrtcdev.log("Remote Video index array ",o," || ",remoteVideos[o],document.getElementsByName(remoteVideos[o]),document.getElementsByName(remoteVideos[o]).src),document.getElementsByName(remoteVideos[o])[0]&&document.getElementsByName(remoteVideos[o])[0].src?n++:remoteVideos[o].video&&remoteVideos[o].video&&n++;try{if("unlimited"==remoteobj.maxAllowed){webrtcdev.log("remote video is unlimited , creating video for remoteVideos array ");r=document.createElement("video");remoteVideos[n]={userid:e.userid,video:r},document.getElementById(remoteobj.dynamicVideos.videoContainer).appendChild(r)}else webrtcdev.log("remote video is limited to size maxAllowed , current index ",n),webrtcdev.log("searching for video with index ",n," in remote video : ",document.getElementsByName(remoteVideos[n])[0]),document.getElementsByName(remoteVideos[n])[0]?remoteVideos[n]={userid:e.userid,video:document.getElementsByName(remoteVideos[n])[0]}:webrtcdev.error(" document.getElementsByName(remoteVideos[vi])[0] doest exist for vi ",n);attachMediaStream(remoteVideos[n].video,e.stream),remoteVideos[n].video.hidden&&(remoteVideos[n].video.hidden=!1),remoteVideos[n].video.id=e.videoContainer,remoteVideos[n].video.className=remoteobj.videoClass,attachControlButtons(remoteVideos[n].video,e),remoteobj.userDisplay&&e.name&&attachUserDetails(remoteVideos[n].video,e),remoteobj.userMetaDisplay&&e.userid&&attachMetaUserDetails(remoteVideos[n].video,e)}catch(e){webrtcdev.error(e)}}else alert("remote Video containers not defined")}else webrtcdev.error(" PeerInfo vid didnt match either case ");break;default:webrtcdev.log(" Switch default case")}}catch(e){webrtcdev.error("[ start.js - update call view ]",e)}webrtcdev.log(" updateWebCallView - finish")}var repeatInitilization=null;function startCall(e){webrtcdev.log(" startCall obj",e),webrtcdev.log(" TURN ",turn),e.startwebrtcdev()}function updatePeerInfo(e,t,n,o,r,i){for(x in webrtcdev.log("updating peerInfo: ",e,t,n,o,r,i),webcallpeers)if(webcallpeers[x].userid==e)return void webrtcdev.log("UserID is already existing , webcallpeers");peerInfo={videoContainer:"video"+e,videoHeight:null,videoClassName:null,userid:e,name:t,color:n,email:o,role:r,controlBarName:"control-video"+e,filearray:[],vid:"video"+i+"_"+e},fileshareobj.active&&("single"==fileshareobj.props.fileShare?peerInfo.fileShare={outerbox:"widget-filesharing-box",container:"widget-filesharing-container",minButton:"widget-filesharing-minbutton",maxButton:"widget-filesharing-maxbutton",closeButton:"widget-filesharing-closebutton"}:peerInfo.fileShare={outerbox:"widget-filesharing-box"+e,container:"widget-filesharing-container"+e,minButton:"widget-filesharing-minbutton"+e,maxButton:"widget-filesharing-maxbutton"+e,closeButton:"widget-filesharing-closebutton"+e},"single"==fileshareobj.props.fileList?peerInfo.fileList={outerbox:"widget-filelisting-box",container:"widget-filelisting-container"}:peerInfo.fileList={outerbox:"widget-filelisting-box"+e,container:"widget-filelisting-container"+e}),webrtcdev.log("updated peerInfo: ",peerInfo),webcallpeers.push(peerInfo)}function removePeerInfo(e){webrtcdev.log(" [removePeerInfo] Before  ",webcallpeers),webrtcdev.log(" [removePeerInfo] Removing peerInfo: ",e),webcallpeers.splice(e,1),webrtcdev.log(" [removePeerInfo] After removing peerInfo",webcallpeers)}function destroyWebCallView(e,t){webrtcdev.log(" [destroyWebCallView] peerInfo",e),e.videoContainer&&document.getElementById(e.videoContainer)&&(document.getElementById(e.videoContainer).src=""),t(!0)}findPeerInfo=function(e){for(x in webcallpeers)if(webcallpeers[x].userid==e)return webcallpeers[x];return null},openWebRTC=function(e,t){webrtcdev.info(" [openWebRTC] channel: ",e),socket.emit("open-channel",{channel:e,sender:tempuserid,maxAllowed:remoteobj.maxAllowed}),shownotification(" Making a new session ")},connectWebRTC=function(e,t,n,o){if(webrtcdev.info(" [start ConnectWebRTC ] type : ",e," , Channel :",t," , Userid : ",n," , remote users : ",o),fileshareobj.active){var r=findPeerInfo(n);if("single"==fileshareobj.props.fileShare)createFileSharingDiv(r),document.getElementById(peerInfo.fileShare.outerbox).style.width="100%";else if("divided"==fileshareobj.props.fileShare){for(x in"inspector"!=role?(webrtcdev.log(" [start connectWebRTC] creating local file sharing"),createFileSharingDiv(r)):webrtcdev.log(" [start] Since it is an inspectors own session , not creating local File viewer and list"),webcallpeers)webcallpeers[x].userid!=n&&"inspector"!=webcallpeers[x].role&&(webrtcdev.log(" [start connectWebRTC] creating remote file sharing "),createFileSharingDiv(webcallpeers[x]));requestOldFiles()}else webrtcdev.error("fileshareobj.props.fileShare undefined ");"single"==fileshareobj.props.fileList?document.getElementById(peerInfo.fileList.outerbox).style.width="100%":"single"!=fileshareobj.props.fileShare?webrtcdev.log("No Seprate div created for this peer since fileshare container is single"):webrtcdev.error("fileshareobj.props.fileShare undefined ")}},joinWebRTC=function(e,t){shownotification("Joining an existing session "+e),webrtcdev.info(" [joinWebRTC] channel: ",e),null==selfuserid&&(selfuserid=tempuserid),socket.emit("join-channel",{channel:e,sender:selfuserid,extra:{userid:selfuserid,name:selfusername,color:selfcolor,email:selfemail,role:role}})},leaveWebRTC=function(){shownotification("Leaving the session ")},window.onunload=function(){webrtcdev.log(localStorage.getItem("channel")),alert(" Refreshing the Page will loose the session data")},window.addEventListener("message",function(e){webrtcdev.log("------ message from Extension ",e),e.data.type?"screenshare"==e.data.type?onScreenshareExtensionCallback(e):"screenrecord"==e.data.type&&onScreenrecordExtensionCallback(e):"webrtcdev-extension-getsourceId-audio-plus-tab"==e.data?onScreenrecordExtensionCallback(e):onScreenshareExtensionCallback(e)});
"";var socket,webrtcdevDataObj,usersDataObj,channelsFeed=document.getElementById("channelsFeed"),WebRTCdevadmin=function(e){(socket=io.connect(e)).on("response_to_admin_enquire",function(e){switch(e.response){case"channels":if(webrtcdevDataObj=e.channels,"list"==e.format)for(i in clearList("channellistArea"),Object.keys(webrtcdevDataObj))drawList("channellistArea",webrtcdevDataObj[i]);else"table"==e.format?drawTable("webrtcdevTableBody",webrtcdevDataObj):webrtcdev.error("format not specified ");break;case"users":if(usersDataObj=e.users,"list"==e.format)for(i in clearList("userslistArea"),usersDataObj)drawList("userslistArea",usersDataObj[i]);break;case"all":channelsFeed.innerHTML=JSON.stringify(e.channels,null,4);break;default:webrtcdev.log("unrecognizable response from signaller ",e)}})};function onLoadAdmin(){socket.emit("admin_enquire",{ask:"channels",format:"list"})}function clearList(e){$("#"+e).empty()}function drawList(e,n){$("#"+e).append("<li class='list-group-item'>"+n+"</li>")}function drawTable(e,n){for(i in Object.keys(n)){var t=Object.keys(n)[i];drawTableRow(e,i,n[t].channel,n[t].timestamp,n[t].users,n[t].status,n[t].endtimestamp,0)}}function drawTableRow(e,n,t,a,s,i,c,r){var l=$("<tr class='success' />");l.append($("<td>"+n+"</td>")),l.append($("<td>"+t+"</td>")),l.append($("<td>"+a+"</td>")),l.append($("<td>"+JSON.stringify(s,null,4)+"</td>")),l.append($("<td>"+i+"</td>")),l.append($("<td>"+c+"</td>")),l.append($("<td>"+r+"</td>")),$("#"+e).append(l)}function drawUsersTable(e){var n=document.createElement("table");$("#usersRow").append(n);for(var t=0;t<e.length;t++)drawUsersRow(n,data[t])}function drawUsersRow(e){var n=$("<tr />");$("#table").append(n),n.append($("<td>"+e+"</td>"))}$("#channels_list").click(function(){socket.emit("admin_enquire",{ask:"channels",format:"list"})}),$("#channelFindBtn").click(function(){socket.emit("admin_enquire",{ask:"channels",find:$("#channelFindInput").val(),format:"list"})}),$("#users_list").click(function(){socket.emit("admin_enquire",{ask:"users",format:"list"})}),$("#channels_table").click(function(){socket.emit("admin_enquire",{ask:"channels",format:"table"})}),$("#channels_json").click(function(){socket.emit("admin_enquire",{ask:"all",format:"json"})}),$("#channel_clients").click(function(){socket.emit("admin_enquire",{ask:"channel_clients",channel:"https172162010780841524489749781952"})});